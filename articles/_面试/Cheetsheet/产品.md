
# 我做了什么

## 监控系统

1. 采集
2. 转发
3. 聚合
4. 存储
5. 告警
6. 显示
    1. tianliang
    2. grafana

## 告警/故障系统

1. 模块划分
    1. 告警入口, nginx+nodejs提供的http服务
        1. 单点
        2. 推送到redis
    2. brpop redis, 处理业务逻辑, 
        1. 加上相关数据
        2. 生成告警
            1. 消息推送
            2. 自动聚合
        3. 当前性能瓶颈在此, 消费速度太慢了
            1. 因为需要与其他系统进行异步IO
            2. 优化办法?
    3. 数据库
        1. mongo存储告警/故障等高频率写低频率读动态字段信息
        2. mysql存储配置
            1. mongo内某些字段的元数据, 因为有动态表单
    4. API
        1. graphql试点
        2. graphql和mongoose orm的自动生成API
            1. JSON格式(Any)
            2. ObjectID格式
            3. ISODate格式
    5. web前端
    6. 企业微信前端
2. 优化点


## 物理机部署系统
1. web
    1. websocket
2. api
    1. frontend
    2. backend
3. edge-runner
    1. lock 
        1. exists
        2. setex
4. delayed-task
    1. ordered-set (zest)
5. websocket-server

## 可配置报表
1. 是什么? 类似datav, 但是面向的客户属于内部运营数据需求方
    1. SPT团队工单统计
2. 为什么?
    1. DataV
        1. 闭源, 收费, 友商
    2. Tableau
        1. 闭源, 收费
    3. Grafana
        1. 开源, 免费
        2. 只针对时序数据库
        3. 周报功能不好做, 解决办法是起headless浏览器进行ssr, 可扩展性极差
3. 模块划分
    1. 最下层
        1. 数据清洗
            1. 业务数据的逻辑
            2. 最脏的
            3. 暂时仍然由开发负责
        2. Raw数据库
        3. RawAPI
    2. 权限模块
    3. 门户
        1. 页面列表
        2. 页面定义, json
    4. 前端
        1. 页面实现
            1. 3个类
                1. 数据源/数据生产者
                2. store
                3. 消费者
            2. 数据源
                1. Proxy API数据源
                2. Frontend API数据源
                3. Mysql API数据源
                4. Mongo API数据源
            3. 组件
                1. 时间筛选器
                2. 表单
                    1. 也可以充当数据源
                3. 表格
                4. 富文本
                5. 图表
                    1. 也可以充当数据源
        2. 页面组件
        3. 组件实现
            1. echarts
            2. 可插拔设计
4. 反思
    1. 投入研发资源不足
    2. 权限模块设计有误, 导致技术债
        1. 开发过度
    3. 优先级不高, 没有得到重视
        
# 如何分析产品

- 可行性调研
- 需求分析
    - 目标用户是谁
    - 面向什么使用场景
    - 用户需要输入什么数据
    - 用户需要做什么操作
    - 产品产出的是什么
- 研发
    - 敏捷开发 (适用于需求不明确的项目、创新性的项目或者需要抢占市场的项目)
        - 产品经理收集需求, 确定优先级
        - 业务专家分析需求
        - 贴到需求看板上, 项目经理确定deadline
        - 研发
        - 测试
            - 研发自测
            - 系统测试 / ci
        - 定期发布里程碑
    - 瀑布开发 (适用于需求比较明确、to B端项目)
        - 需求分析，要件定义，基本设计，详细设计，编码，单体测试，结合测试，系统测试
    - 瀑布+敏捷
- 测试
- 维护