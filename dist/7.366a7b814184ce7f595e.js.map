{"version":3,"sources":["webpack:///./src/routes/article/article-list.tsx","webpack:///./src/routes/article/index.tsx","webpack:///./src/services/use-promise.ts"],"names":["renderArticles","articles","articleList","path","Object","keys","sort","t1","t2","stat1","stat2","order1","modifyTime","order2","match","Number","MAX_SAFE_INTEGER","split","map","title","maybeChildren","startsWith","key","href","concat","join","replace","Article","name","get","markdown","p","deps","value","setValue","reload","then","loading","setLoading","canceled","v","catch","err","usePromise","async","fetch","x","text","src"],"mappings":"8HAAA,kFAiBO,SAASA,EAAeC,EAAqBC,YAAaC,EAAiB,IAC9E,OACI,0BACKC,OAAOC,KAAKJ,GACRK,KAAK,CAACC,EAAIC,KACP,IAAIC,EAAQR,EAASM,GACjBG,EAAQT,EAASO,GACjBG,EAAWF,EAAMG,YAAc,EAC/BC,EAAWH,EAAME,YAAc,EAOnC,OANGL,EAAGO,MAAM,WACRH,EAASI,OAAOC,iBAAmBD,OAAOR,EAAGU,MAAM,KAAK,KAEzDT,EAAGM,MAAM,WACRD,EAASE,OAAOC,iBAAmBD,OAAOP,EAAGS,MAAM,KAAK,KAErDJ,EAASF,IAEnBO,IAAIC,IACD,MAAMC,EAAgBnB,EAASkB,GAC/B,OAAGA,EAAME,WAAW,KACT,KAGP,sBAAIC,IAAKH,GACF,eAAgBC,EAMf,gCACI,gBAAC,IAAM,CAACG,KAAM,oBAAsBpB,EAAKqB,OAAOL,GAAOM,KAAK,MAAON,EAAMO,QAAQ,MAAO,MAN5F,gCACI,6BAAQP,GACR,0B,IAAMnB,EAAeoB,EAA2BjB,EAAKqB,OAAOL,Y,wNCrCjF,SAASQ,IACpB,MACMC,EADS,cACKC,IAAI,YACjBC,GCPJ,SAAuBC,EAAiBC,GAC3C,MAAOC,EAAMC,GAAY,mBAAS,MAC5BC,EAAS,UAAc,IAAI,KAC7BJ,IAAIK,KAAKF,IACX,KACKG,EAAQC,GAAc,oBAAS,GAmBtC,OAlBA,YAAgB,KACZ,IAAIC,GAAW,EAaf,OAZAD,GAAW,GACXP,IAAIK,KAAKI,IACDD,IACAD,GAAW,GACXJ,EAASM,MAEdC,MAAMC,IAIL,MAHIH,GACAD,GAAW,GAETI,IAEH,KACHH,GAAW,IAEjBP,GACK,CAACC,EAAME,EAAOD,EAASG,GDjBXM,CAAWC,SACtBhB,EAGGiB,MAAM,aAAajB,GAAMQ,KAAKU,GAAGA,EAAEC,QAAQN,MAAM,IAAI,IAFjD,GAGb,CAACb,IACH,OAAIE,EAGG,gBAAC,IAAc,CAACkB,IAAKlB,IAFjB,cAhBf","file":"7.366a7b814184ce7f595e.js","sourcesContent":["import * as React from \"react\"\nimport { Anchor } from \"../../services/router\"\nimport * as moment from \"moment\"\n\ntype ArticleStat = {\n    modifyTime: number\n    createTime: number\n}\n\ntype Articles = {\n    [name: string]: ArticleStat | Articles\n}\n\ndeclare global {\n    const articleList: Articles //article list generated by plugin\n}\n\nexport function renderArticles(articles: Articles = articleList, path: string[] = []) {\n    return (\n        <ul>\n            {Object.keys(articles)\n                .sort((t1, t2) => {\n                    let stat1 = articles[t1]\n                    let stat2 = articles[t2]\n                    let order1 = ((stat1.modifyTime || 0) as number)\n                    let order2 = ((stat2.modifyTime || 0) as number)\n                    if(t1.match(/\\d+\\./)){\n                        order1 = Number.MAX_SAFE_INTEGER - Number(t1.split(\".\")[0])\n                    }\n                    if(t2.match(/\\d+\\./)){\n                        order2 = Number.MAX_SAFE_INTEGER - Number(t2.split(\".\")[0])\n                    }\n                    return order2 - order1\n                })\n                .map(title => {\n                    const maybeChildren = articles[title]\n                    if(title.startsWith(\"_\")){\n                        return null\n                    }\n                    return (\n                        <li key={title}>\n                            {!(\"modifyTime\" in maybeChildren) ? (\n                                <>\n                                    <label>{title}</label>\n                                    <ul> {renderArticles(maybeChildren as Articles, path.concat(title))}</ul>\n                                </>\n                            ) : (\n                                <>\n                                    <Anchor href={\"/article?article=\" + path.concat(title).join(\"/\")}>{title.replace(\".md\", \"\")}</Anchor>\n                                    {\n                                        // <span style={{float:\"left\", fontSize:\".5em\", opacity: .5, marginRight: \"2em\", lineHeight: \"2.8em\" }}>{moment.unix((maybeChildren as ArticleStat).createTime / 1000).format(\"YY/MM/DD\")}</span>\n                                    }\n                                </>\n                            )}\n                        </li>\n                    )\n                })}\n        </ul>\n    )\n}\n","import * as marked from \"marked\"\nimport { usePromise } from \"../../services/use-promise\";\nimport * as React from \"react\"\nimport { useSearchParams, Anchor } from \"../../services/router\";\nimport RenderMarkdown from \"./render-markdown\"\nimport { renderArticles } from \"./article-list\";\n\nexport default function Article(){\n    const params = useSearchParams()\n    const name = params.get(\"article\")\n    const [markdown] = usePromise(async ()=>{\n        if(!name){\n            return \"\"\n        }\n        return fetch(\"/articles/\"+name).then(x=>x.text()).catch(()=>\"\")\n    },[name])\n    if(!markdown){\n        return renderArticles()\n    }\n    return <RenderMarkdown src={markdown} />\n}","import { useState, useEffect } from 'react';\nimport * as React from 'react';\n\nexport function usePromise<T>(p:()=>Promise<T>,deps:any[]){\n    const [value,setValue] = useState(null as T | null)\n    const reload = React.useMemo(()=>()=>{\n        p().then(setValue)\n    },[])\n    const [loading,setLoading] = useState(false)\n    React.useEffect(()=>{\n        let canceled = false\n        setLoading(true)\n        p().then(v=>{\n            if(!canceled){\n                setLoading(false)\n                setValue(v)\n            }\n        }).catch(err=>{\n            if(!canceled){\n                setLoading(false)\n            }\n            throw err\n        })\n        return ()=>{\n            canceled = true\n        }\n    },deps)\n    return [value,reload,setValue,loading] as [null|T,()=>void,(t:T)=>void,boolean]\n}"],"sourceRoot":""}