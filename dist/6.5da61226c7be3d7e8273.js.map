{"version":3,"sources":["webpack:///./node_modules/direction/index.js","webpack:///./node_modules/esrever/esrever.js","webpack:///./node_modules/immer/dist/immer.module.js","webpack:///./node_modules/is-hotkey/lib/index.js","webpack:///./node_modules/lodash/_Symbol.js","webpack:///./node_modules/lodash/_baseGetTag.js","webpack:///./node_modules/lodash/_freeGlobal.js","webpack:///./node_modules/lodash/_getRawTag.js","webpack:///./node_modules/lodash/_objectToString.js","webpack:///./node_modules/lodash/_root.js","webpack:///./node_modules/lodash/debounce.js","webpack:///./node_modules/lodash/isObject.js","webpack:///./node_modules/lodash/isObjectLike.js","webpack:///./node_modules/lodash/isSymbol.js","webpack:///./node_modules/lodash/now.js","webpack:///./node_modules/lodash/throttle.js","webpack:///./node_modules/lodash/toNumber.js","webpack:///./node_modules/object-assign/index.js","webpack:///./node_modules/process/browser.js","webpack:///./node_modules/use-subscription/cjs/use-subscription.production.min.js","webpack:///./node_modules/use-subscription/index.js","webpack:///(webpack)/buildin/global.js","webpack:///(webpack)/buildin/module.js","webpack:///./node_modules/webrtc-datachannel/dist/index.js","webpack:///./node_modules/slate/node_modules/is-plain-object/index.es.js","webpack:///./node_modules/slate/dist/index.es.js","webpack:///./node_modules/slate-history/node_modules/is-plain-object/index.es.js","webpack:///./node_modules/slate-history/dist/index.es.js","webpack:///./node_modules/compute-scroll-into-view/dist/index.module.js","webpack:///./node_modules/scroll-into-view-if-needed/es/index.js","webpack:///./node_modules/slate-react/dist/index.es.js","webpack:///./node_modules/use-suspendable/dist/use-suspendable.js","webpack:///./src/routes/demos/slate-collabo/src/collabo.ts","webpack:///./src/routes/demos/slate-collabo/src/protocol.ts","webpack:///./src/routes/demos/slate-collabo/src/state.ts","webpack:///./src/routes/demos/slate-collabo/src/editor/cursor.tsx","webpack:///./src/routes/demos/slate-collabo/src/editor/leaf.tsx","webpack:///./src/routes/demos/slate-collabo/src/editor/toolbar.tsx","webpack:///./src/routes/demos/slate-collabo/src/peer.ts","webpack:///./src/routes/demos/slate-collabo/src/editor.tsx","webpack:///./src/routes/demos/slate-collabo/src/connection.ts","webpack:///./src/routes/demos/slate-collabo/src/index.tsx"],"names":["module","exports","value","String","rtl","test","ltr","LTR","RegExp","root","freeExports","freeGlobal","global","window","regexSymbolWithCombiningMarks","regexSurrogatePair","reverse","string","result","index","replace","$0","$1","$2","length","charAt","esrever","_a","Archtype","ProxyType","hasSymbol","Symbol","hasMap","Map","hasSet","Set","NOTHING","DRAFTABLE","DRAFT_STATE","iteratorSymbol","iterator","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__extends","__","this","constructor","prototype","isDraft","isDraftable","proto","getPrototypeOf","isPlainObject","isArray","isMap","isSet","ownKeys","Reflect","getOwnPropertySymbols","obj","getOwnPropertyNames","concat","each","iter","getArchtype","forEach","key","entry","thing","die","type","ES5Object","ProxyObject","ES5Array","ProxyArray","has","prop","call","get","is","x","y","target","latest","state","copy","base","shallowCopy","invokeGetters","slice","clone","create","desc","getOwnPropertyDescriptor","Error","enumerable","defineProperty","writable","configurable","freeze","deep","isFrozen","add","clear","delete","dontMutateFrozenCollections","set","_","ImmerScope","parent","immer","drafts","canAutoFreeze","usePatches","patchListener","patches","inversePatches","revoke","leave","current","enter","scope","draft","revoked","processResult","baseDraft","isReplaced","undefined","willFinalize","modified","finalize","maybeFreeze","push","op","path","finalizeTree","finalized","onDelete","useProxies","assigned","exists","copy_1","onCopy","autoFreeze","basePath","assignedValue","origValue","generatePatchesFromAssigned","_b","delta","start","end","i","replaceCount","generateArrayPatches","unshift","generateSetPatches","generatePatches","rootPath","finalizeProperty","rootState","parentValue","childValue","isDraftProp","isSetMember","propOrOldValue","grandChild","onAssign","objectTraps","peek","createProxy","baseValue","prepareCopy","markChanged","deleteProperty","owner","arrayTraps","willFinalizeES5","finalizing","markChangesSweep","markChangesRecursively","object","markChangedES5","hasArrayChanges","min","Math","createES5Proxy","clonePotentialDraft","descriptors","assertUnrevoked","peek$1","prepareCopy$1","get$1","set$1","proxyProperty","isEnumerable","isManual","fn","arguments","apply","isNaN","parseInt","JSON","stringify","hasObjectChanges","keys","state_1","descriptor","DraftMap","_super","size","prepareCopy$2","cb","thisArg","_this","_value","_map","values","next","r","done","entries","DraftSet","prepareCopy$3","applyPatches","patch","join","deepClonePatchValue","splice","map","from","cloned","__spreadArrays","s","il","k","a","j","jl","configDefaults","Proxy","revocable","process","name","Immer","config","setUseProxies","produce","bind","produceWithPatches","recipe","defaultBase_1","self_1","arguments$1","args","_i","scope_1","proxy","hasError","Promise","then","error","arg1","arg2","arg3","ip","createDraft","finishDraft","setAutoFreeze","proxyMap","proxySet","traps","IS_MAC","navigator","platform","MODIFIERS","alt","control","meta","shift","ALIASES","break","cmd","command","ctl","ctrl","del","down","esc","ins","left","mod","opt","option","return","right","space","spacebar","up","win","windows","CODES","backspace","tab","pause","capslock","escape","pageup","pagedown","home","arrowleft","arrowup","arrowright","arrowdown","insert","numlock","scrolllock","'","f","isHotkey","hotkey","options","event","array","parseHotkey","check","e","some","compareHotkey","byKey","ret","split","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","optional","endsWith","toKeyName","modifier","which","toKeyCode","err","expected","actual","toLowerCase","toUpperCase","charCodeAt","default","isCodeHotkey","isKeyHotkey","getRawTag","objectToString","nullTag","undefinedTag","symToStringTag","toStringTag","objectProto","nativeObjectToString","toString","isOwn","tag","unmasked","freeSelf","self","Function","isObject","now","toNumber","FUNC_ERROR_TEXT","nativeMax","max","nativeMin","func","wait","lastArgs","lastThis","maxWait","timerId","lastCallTime","lastInvokeTime","leading","maxing","trailing","TypeError","invokeFunc","time","shouldInvoke","timeSinceLastCall","timerExpired","trailingEdge","setTimeout","timeWaiting","remainingWait","debounced","isInvoking","leadingEdge","clearTimeout","cancel","flush","baseGetTag","isObjectLike","symbolTag","Date","debounce","isSymbol","NAN","reTrim","reIsBadHex","reIsBinary","reIsOctal","freeParseInt","other","valueOf","isBinary","propIsEnumerable","propertyIsEnumerable","toObject","val","assign","test1","test2","fromCharCode","n","test3","letter","shouldUseNative","source","symbols","to","cachedSetTimeout","cachedClearTimeout","defaultSetTimout","defaultClearTimeout","runTimeout","fun","currentQueue","queue","draining","queueIndex","cleanUpNextTick","drainQueue","timeout","len","run","marker","runClearTimeout","Item","noop","nextTick","title","browser","env","argv","version","versions","on","addListener","once","off","removeListener","removeAllListeners","emit","prependListener","prependOnceListener","listeners","binding","cwd","chdir","dir","umask","g","useSubscription","c","getCurrentValue","subscribe","useState","useDebugValue","useEffect","h","webpackPolyfill","deprecate","paths","children","l","__awaiter","_arguments","P","generator","resolve","reject","fulfilled","step","rejected","__generator","body","t","label","sent","trys","ops","verb","v","pop","WebRtcDataChannel","connection","wrtc","candidates","alisteners","eventsListeners","dataChannel","messageNonce","subscriber","data","getCandidates","createOffer","offer","rpc","setLocalDescription","sdp","createChannel","channel","createDataChannel","onopen","onclose","onerror","onmessage","msg","parse","nonce","message","console","setOffer","answer","setRemoteDescription","createAnswer","setRemote","currentRemoteDescription","addCandidates","promises","candidate","addIceCandidate","RTCIceCandidate","all","channelOpened","send","initiateConnect","encodeURI","setAnswer","response","encodedAnswer","decodedCandidates","decodeURI","initByRequest","request","encodedOffer","RTC","RTCPeerConnection","onicecandidate","ondatachannel","onconnectionstatechange","isObjectObject","o","ctor","prot","_defineProperty","_objectWithoutProperties","excluded","sourceKeys","indexOf","_objectWithoutPropertiesLoose","sourceSymbolKeys","DIRTY_PATHS","WeakMap","FLUSHING","NORMALIZING","PATH_REFS","POINT_REFS","RANGE_REFS","SPACE","PUNCTUATION","CHAMELEON","getCharacterDistance","text","offset","prev","charCode","isSurrogate","isModifier","isBMPEmoji","isVariationSelector","isWordCharacter","char","remaining","rest","code","enumerableOnly","filter","sym","_objectSpread","getOwnPropertyDescriptors","defineProperties","Editor","editor","voids","mode","at","selection","match","levels","Text","isText","Path","equals","addMark","range","anchor","point","edge","focus","distance","positions","unit","deleteBackward","deleteForward","deleteFragment","edges","node","fragment","hasBlocks","element","isBlock","hasInlines","isInline","hasTexts","every","insertBreak","insertFragment","insertNode","insertText","Element","isElement","isEditor","isVoid","normalizeNode","onChange","removeMark","marks","Range","isRange","isNodeList","Operation","isOperationList","operations","Point","isEdge","isStart","isEnd","first","isNormalizing","leaf","isExpanded","nodes","_node","previous","block","above","prevNode","prevPath","blockPath","isAncestor","last","span","isPath","includes","universal","Span","isSpan","hit","nodeEntries","pass","_ref","matches","isLower","compare","force","getDirtyPaths","allPaths","_ref2","withoutNormalizing","m","parentPath","depth","firstPath","lastPath","common","isPoint","affinity","ref","pathRefs","refs","pointRefs","reverse$1","available","isNewBlock","advance","started","getWordDistance","isFirst","rangeRefs","isCollapsed","endBlock","before","skip","isBefore","normalize","isElementList","props","ancestors","ancestor","child","childPath","another","_leaf","isNode","visited","isAfter","newPath","nextIndex","ownKeys$1","_objectSpread$1","isNodeOperation","isOperation","position","properties","newProperties","isSelectionOperation","isTextOperation","isSibling","transform","_properties","_newProperties","av","as","bs","bv","isChild","isCommon","isDescendant","isParent","list","operation","endsBefore","_op","_op2","_op3","_position","_op4","onp","PathRef","unref","ownKeys$2","_objectSpread$2","PointRef","ownKeys$3","isBackward","rs","re","ts","te","isAfterStart","isBeforeEnd","s1","e1","s2","e2","_objectSpread$3","isForward","affinityAnchor","affinityFocus","RangeRef","ownKeys$4","_objectSpread$4","loose","_key","isTextList","decorations","leaves","dec","middle","after","_off","ownKeys$5","_objectSpread$5","ownKeys$6","_objectSpread$6","NodeTransforms","hanging","select","unhangRange","pointRef","Transforms","_matchPath","pathRef","isAtEnd","splitNodes","void","_path","matchPath","parentNodeEntry","toPath","moveNodes","removeNodes","_toPath","splitPath","_toPath2","commonPath","isPreviousSibling","emptyAncestor","emptyRef","isEmpty","toRef","targets","_ref3","depths","_ref4","rangeRef","splitMode","height","always","deleteRange","beforeRef","highest","voidMatch","voidNode","voidPath","afterPath","insertNodes","afterRef","highestPath","lowestPath","_path2","_point","_point2","setNodes","_ref5","_loop","intersection","liftNodes","roots","commonNodeEntry","commonNode","wrapperPath","wrapper","ownKeys$7","_objectSpread$7","ownKeys$8","_objectSpread$8","points","_node2","_parent","_index","_key2","_path3","_node3","_parent2","_index2","truePath","newParent","newIndex","_point3","_key3","_path4","_index3","_point4","_key4","_prev","texts","_path5","_offset","_text","_node4","_before","_after","_point5","_key5","_path6","_node5","_key6","_path7","newNode","_node6","_parent4","_index4","_before2","_after2","_before3","_after3","_point6","_key7","opts","setSelection","oldProps","newProps","furthestVoid","startBlock","isAcrossBlocks","isSingleText","startVoid","endVoid","startRef","endRef","mergeNodes","inlineElementMatch","_inlinePath","blockMatch","isBlockStart","isBlockEnd","mergeStart","mergeEnd","matcher","starts","middles","ends","starting","inlineMatch","inlinePath","isInlineStart","isInlineEnd","middleRef","_end","ownKeys$9","_objectSpread$9","oldAncestors","newAncestors","_ancestor","_p","History","isHistory","redos","undos","SAVING","MERGING","HistoryEditor","isHistoryEditor","history","isMerging","isSaving","redo","undo","shouldMerge","shouldSave","shouldOverwrite","shouldClear","nodeType","clientHeight","scrollHeight","clientWidth","scrollWidth","getComputedStyle","overflowY","overflowX","ownerDocument","defaultView","frameElement","scrollMode","u","inline","boundary","skipOverflowHiddenElements","document","scrollingElement","documentElement","parentElement","visualViewport","width","innerWidth","innerHeight","w","scrollX","pageXOffset","scrollY","pageYOffset","W","getBoundingClientRect","H","top","E","M","bottom","V","I","C","T","B","D","O","R","X","Y","L","S","borderLeftWidth","q","borderTopWidth","z","borderRightWidth","A","borderBottomWidth","F","G","J","offsetWidth","K","offsetHeight","N","scrollLeft","scrollTop","el","isOptionsObject","targetIsDetached","contains","behavior","computeOptions","getOptions","actions","canSmoothScroll","style","scroll","defaultBehavior","Key","id","NODE_TO_INDEX","NODE_TO_PARENT","EDITOR_TO_ELEMENT","ELEMENT_TO_NODE","KEY_TO_ELEMENT","NODE_TO_ELEMENT","NODE_TO_KEY","IS_READ_ONLY","IS_FOCUSED","EDITOR_TO_ON_CHANGE","PLACEHOLDER_SYMBOL","isDOMComment","isDOMNode","isDOMElement","Node","isDOMText","getEditableChild","direction","childNodes","triedForward","triedBackward","getAttribute","getPlainText","domNode","nodeValue","childNode","display","getPropertyValue","tagName","ReactEditor","isFocused","isReadOnly","toDOMNode","activeElement","blur","preventScroll","domSelection","getSelection","rangeCount","removeAllRanges","deselect","targetEl","editable","editorEl","closest","isContentEditable","insertData","setFragmentData","findKey","domPoint","querySelectorAll","textContent","attr","domAnchor","toDOMPoint","domFocus","domRange","createRange","startNode","startOffset","endNode","endOffset","isStartAtZeroWidth","isEndAtZeroWidth","setStart","setEnd","domEl","hasAttribute","nativeEvent","clientX","clientY","toSlateNode","findPath","rect","isPrev","caretRangeFromPoint","caretPositionFromPoint","offsetNode","toSlateRange","nearestNode","nearestOffset","isLast","normalizeDOMPoint","parentNode","textNode","leafNode","contents","cloneContents","removeChild","querySelector","slateNode","anchorNode","anchorOffset","focusNode","focusOffset","Selection","startContainer","endContainer","collapsed","toSlatePoint","FocusedContext","EditorContext","useEditor","SlateContext","useSlate","context","Slate","setKey","onContextChange","createElement","Provider","ReadOnlyContext","SelectedContext","ZeroWidthString","TextString","isTrailing","isLineBreak","MemoizedLeaf","memo","renderLeaf","DefaultLeaf","Fragment","contentEditable","pointerEvents","maxWidth","whiteSpace","opacity","userSelect","fontStyle","fontWeight","textDecoration","placeholder","attributes","useIsomorphicLayoutEffect","MemoizedText","MemoizedElement","decorate","renderElement","DefaultElement","readOnly","useReadOnly","Children","Tag","color","outline","isRangeListEqual","isLeafBlock","sel","ds","IS_APPLE","userAgent","MSStream","IS_FIREFOX","IS_SAFARI","IS_EDGE_LEGACY","IS_CHROME_LEGACY","HOTKEYS","bold","compose","moveBackward","moveForward","moveWordBackward","moveWordForward","extendBackward","extendForward","italic","splitBlock","APPLE_HOTKEYS","moveLineBackward","moveLineForward","deleteLineBackward","deleteLineForward","deleteWordBackward","deleteWordForward","extendLineBackward","extendLineForward","transposeCharacter","WINDOWS_HOTKEYS","generic","apple","isGeneric","isApple","isWindows","Hotkeys","isBold","isCompose","isMoveBackward","isMoveForward","isDeleteBackward","isDeleteForward","isDeleteLineBackward","isDeleteLineForward","isDeleteWordBackward","isDeleteWordForward","isExtendBackward","isExtendForward","isExtendLineBackward","isExtendLineForward","isItalic","isMoveLineBackward","isMoveLineForward","isMoveWordBackward","isMoveWordForward","isRedo","isSplitBlock","isTransposeCharacter","isUndo","HAS_BEFORE_INPUT_SUPPORT","Editable","autoFocus","defaultDecorate","onDOMBeforeInput","propsOnDOMBeforeInput","Component","isComposing","isUpdatingSelection","latestElement","hasDomSelection","editorElement","hasDomSelectionInEditor","newDomRange","toDOMRange","setBaseAndExtent","leafEl","hasEditableTarget","isDOMEventHandled","inputType","dataTransfer","preventDefault","startsWith","targetRange","getTargetRanges","DataTransfer","addEventListener","removeEventListener","onDOMSelectionChange","anchorNodeSelectable","isTargetInsideVoid","focusNodeSelectable","role","spellCheck","autoCorrect","autoCapitalize","suppressContentEditableWarning","wordWrap","onBeforeInput","isEventHandled","onBlur","relatedTarget","hasDOMNode","onClick","hasTarget","_start","onCompositionEnd","onCompositionStart","clipboardData","onCut","onDragOver","onDragStart","onDrop","files","findEventRange","onFocus","onKeyDown","move","collapse","onPaste","getData","types","isPlainTextOnlyPaste","handler","isDefaultPrevented","isPropagationStopped","defaultPrevented","mapValue","EMPTY_VALUE","JUST_RESOLVED","useSuspendable","e_1","obs","shouldThrow","_loop_1","ob","item","syncValue_1","unsubscribe","thenable","isSync","obs_1","obs_1_1","e_1_1","callback","subs","isSyncTriggered_1","MessageType","PeerState","ErrorCode","ClientEventType","ServerEventType","_cursors","BehaviorSubject","cursors","pipe","observeOn","asap","peer","leftOp","topOp","rightOp","bottomOp","applyRemoteOp","newVersion","transformSelection","rightPath","bottomPath","rightNewPath","bottomNewPath","by","cursorStyleBase","fontSize","background","caretStyleBase","Caret","userInfo","cursorStyles","caretStyles","backgroundColor","className","username","borderLeft","borderTop","borderBottom","animation","underlined","isCaret","toggleFormat","format","isActive","isFormatActive","Toolbar","removeAttribute","getRangeAt","FormatButton","icon","Button","active","Icon","onMouseDown","receiveSignal","sendSignal","shouldRequest","Subscription","rtcChannel","iceServers","urls","credential","ready","log","receiveFrom","fromEventPattern","signalType","signal","close","signalServerUrl","savedUserStr","localStorage","getItem","thisIsMe","ws","WebSocket","ev","hello","rooms","currentRoom","Subject","addPeer","removePeer","clearPeers","thisIsMeValue","user","setItem","listRooms","joinedRoom","room","roomIndex","findIndex","users","quit","errorCode","events","createClientConnection","App","fallback","HomePage","myUserInfo","gridTemplateColumns","UserAvatar","Main","batch","withoutSaving","inverseOps","inverse","lastBatch","lastOp","overwrite","save","merge","withHistory","attach","trim","cloneRange","setEndAfter","zw","isNewline","appendChild","getFragment","encoded","btoa","encodeURIComponent","setAttribute","setData","div","innerHTML","decoded","decodeURIComponent","atob","parsed","lines","line","unstable_batchedUpdates","withReact","decoratedEditor","peers","currentState","unknown","docState","uncommitedOps","pendingSent","secondary","peerId","sendTo","ReqMerge","primary","AckMerge","unmergedOps","initializeAsSecondary","collabo","Hello","mergePatch","ackMerge","toBeDeleted","removeCursor","dispose","withCollabo","dirtyPaths","oldDirtyPaths","newDirtyPaths","shouldHaveInlines","_child","unsetNodes","initializeAsMaster","Room","roomInfo","RoomList","borderRadius","border","padding","roomName","prompt","justifyContent","alignItems","minHeight","minWidth","cursor","setValue","isPrimary","sub","setCursors","ranges","remoteUserInfo","cursorRange","isFocusNode","isAnchorNode","marginRight","newValue","lineHeight","textAlign","SlatejsCollabo","open","setOpen"],"mappings":"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","file":"6.5da61226c7be3d7e8273.js","sourcesContent":["'use strict'\n\nmodule.exports = direction\n\nvar RTL = '\\u0591-\\u07FF\\uFB1D-\\uFDFD\\uFE70-\\uFEFC'\nvar LTR =\n  'A-Za-z\\u00C0-\\u00D6\\u00D8-\\u00F6' +\n  '\\u00F8-\\u02B8\\u0300-\\u0590\\u0800-\\u1FFF\\u200E\\u2C00-\\uFB1C' +\n  '\\uFE00-\\uFE6F\\uFEFD-\\uFFFF'\n\nvar rtl = new RegExp('^[^' + LTR + ']*[' + RTL + ']')\nvar ltr = new RegExp('^[^' + RTL + ']*[' + LTR + ']')\n\nfunction direction(value) {\n  value = String(value || '')\n\n  if (rtl.test(value)) {\n    return 'rtl'\n  }\n\n  if (ltr.test(value)) {\n    return 'ltr'\n  }\n\n  return 'neutral'\n}\n","/*! https://mths.be/esrever v0.2.0 by @mathias */\n;(function(root) {\n\n\t// Detect free variables `exports`\n\tvar freeExports = typeof exports == 'object' && exports;\n\n\t// Detect free variable `module`\n\tvar freeModule = typeof module == 'object' && module &&\n\t\tmodule.exports == freeExports && module;\n\n\t// Detect free variable `global`, from Node.js or Browserified code,\n\t// and use it as `root`\n\tvar freeGlobal = typeof global == 'object' && global;\n\tif (freeGlobal.global === freeGlobal || freeGlobal.window === freeGlobal) {\n\t\troot = freeGlobal;\n\t}\n\n\t/*--------------------------------------------------------------------------*/\n\n\tvar regexSymbolWithCombiningMarks = /([\\0-\\u02FF\\u0370-\\u1AAF\\u1B00-\\u1DBF\\u1E00-\\u20CF\\u2100-\\uD7FF\\uE000-\\uFE1F\\uFE30-\\uFFFF]|[\\uD800-\\uDBFF][\\uDC00-\\uDFFF]|[\\uD800-\\uDBFF](?![\\uDC00-\\uDFFF])|(?:[^\\uD800-\\uDBFF]|^)[\\uDC00-\\uDFFF])([\\u0300-\\u036F\\u1AB0-\\u1AFF\\u1DC0-\\u1DFF\\u20D0-\\u20FF\\uFE20-\\uFE2F]+)/g;\n\tvar regexSurrogatePair = /([\\uD800-\\uDBFF])([\\uDC00-\\uDFFF])/g;\n\n\tvar reverse = function(string) {\n\t\t// Step 1: deal with combining marks and astral symbols (surrogate pairs)\n\t\tstring = string\n\t\t\t// Swap symbols with their combining marks so the combining marks go first\n\t\t\t.replace(regexSymbolWithCombiningMarks, function($0, $1, $2) {\n\t\t\t\t// Reverse the combining marks so they will end up in the same order\n\t\t\t\t// later on (after another round of reversing)\n\t\t\t\treturn reverse($2) + $1;\n\t\t\t})\n\t\t\t// Swap high and low surrogates so the low surrogates go first\n\t\t\t.replace(regexSurrogatePair, '$2$1');\n\t\t// Step 2: reverse the code units in the string\n\t\tvar result = '';\n\t\tvar index = string.length;\n\t\twhile (index--) {\n\t\t\tresult += string.charAt(index);\n\t\t}\n\t\treturn result;\n\t};\n\n\t/*--------------------------------------------------------------------------*/\n\n\tvar esrever = {\n\t\t'version': '0.2.0',\n\t\t'reverse': reverse\n\t};\n\n\t// Some AMD build optimizers, like r.js, check for specific condition patterns\n\t// like the following:\n\tif (\n\t\ttypeof define == 'function' &&\n\t\ttypeof define.amd == 'object' &&\n\t\tdefine.amd\n\t) {\n\t\tdefine(function() {\n\t\t\treturn esrever;\n\t\t});\n\t}\telse if (freeExports && !freeExports.nodeType) {\n\t\tif (freeModule) { // in Node.js, io.js, or RingoJS v0.8.0+\n\t\t\tfreeModule.exports = esrever;\n\t\t} else { // in Narwhal or RingoJS v0.7.0-\n\t\t\tfor (var key in esrever) {\n\t\t\t\tesrever.hasOwnProperty(key) && (freeExports[key] = esrever[key]);\n\t\t\t}\n\t\t}\n\t} else { // in Rhino or a web browser\n\t\troot.esrever = esrever;\n\t}\n\n}(this));\n","// Should be no imports here!\nvar _a; // SOme things that should be evaluated before all else...\n\n\nvar hasSymbol = typeof Symbol !== \"undefined\";\nvar hasMap = typeof Map !== \"undefined\";\nvar hasSet = typeof Set !== \"undefined\";\n/**\r\n * The sentinel value returned by producers to replace the draft with undefined.\r\n */\n\nvar NOTHING = hasSymbol ? Symbol(\"immer-nothing\") : (_a = {}, _a[\"immer-nothing\"] = true, _a);\n/**\r\n * To let Immer treat your class instances as plain immutable objects\r\n * (albeit with a custom prototype), you must define either an instance property\r\n * or a static property on each of your custom classes.\r\n *\r\n * Otherwise, your class instance will never be drafted, which means it won't be\r\n * safe to mutate in a produce callback.\r\n */\n\nvar DRAFTABLE = hasSymbol ? Symbol(\"immer-draftable\") : \"__$immer_draftable\";\nvar DRAFT_STATE = hasSymbol ? Symbol(\"immer-state\") : \"__$immer_state\";\nvar iteratorSymbol = hasSymbol ? Symbol.iterator : \"@@iterator\";\n\n/* istanbul ignore next */\nvar extendStatics = function (d, b) {\n  extendStatics = Object.setPrototypeOf || {\n    __proto__: []\n  } instanceof Array && function (d, b) {\n    d.__proto__ = b;\n  } || function (d, b) {\n    for (var p in b) { if (b.hasOwnProperty(p)) { d[p] = b[p]; } }\n  };\n\n  return extendStatics(d, b);\n}; // Ugly hack to resolve #502 and inherit built in Map / Set\n\n\nfunction __extends(d, b) {\n  extendStatics(d, b);\n\n  function __() {\n    this.constructor = d;\n  }\n\n  d.prototype = ( // @ts-ignore\n  __.prototype = b.prototype, new __());\n}\n\nvar Archtype;\n\n(function (Archtype) {\n  Archtype[Archtype[\"Object\"] = 0] = \"Object\";\n  Archtype[Archtype[\"Array\"] = 1] = \"Array\";\n  Archtype[Archtype[\"Map\"] = 2] = \"Map\";\n  Archtype[Archtype[\"Set\"] = 3] = \"Set\";\n})(Archtype || (Archtype = {}));\n\nvar ProxyType;\n\n(function (ProxyType) {\n  ProxyType[ProxyType[\"ProxyObject\"] = 0] = \"ProxyObject\";\n  ProxyType[ProxyType[\"ProxyArray\"] = 1] = \"ProxyArray\";\n  ProxyType[ProxyType[\"ES5Object\"] = 2] = \"ES5Object\";\n  ProxyType[ProxyType[\"ES5Array\"] = 3] = \"ES5Array\";\n  ProxyType[ProxyType[\"Map\"] = 4] = \"Map\";\n  ProxyType[ProxyType[\"Set\"] = 5] = \"Set\";\n})(ProxyType || (ProxyType = {}));\n\n/** Returns true if the given value is an Immer draft */\n\nfunction isDraft(value) {\n  return !!value && !!value[DRAFT_STATE];\n}\n/** Returns true if the given value can be drafted by Immer */\n\nfunction isDraftable(value) {\n  if (!value) { return false; }\n  return isPlainObject(value) || Array.isArray(value) || !!value[DRAFTABLE] || !!value.constructor[DRAFTABLE] || isMap(value) || isSet(value);\n}\nfunction isPlainObject(value) {\n  if (!value || typeof value !== \"object\") { return false; }\n  var proto = Object.getPrototypeOf(value);\n  return !proto || proto === Object.prototype;\n}\nfunction original(value) {\n  if (value && value[DRAFT_STATE]) {\n    return value[DRAFT_STATE].base;\n  } // otherwise return undefined\n\n}\nvar ownKeys = typeof Reflect !== \"undefined\" && Reflect.ownKeys ? Reflect.ownKeys : typeof Object.getOwnPropertySymbols !== \"undefined\" ? function (obj) {\n  return Object.getOwnPropertyNames(obj).concat(Object.getOwnPropertySymbols(obj));\n} :\n/* istanbul ignore next */\nObject.getOwnPropertyNames;\nfunction each(obj, iter) {\n  if (getArchtype(obj) === Archtype.Object) {\n    ownKeys(obj).forEach(function (key) {\n      return iter(key, obj[key], obj);\n    });\n  } else {\n    obj.forEach(function (entry, index) {\n      return iter(index, entry, obj);\n    });\n  }\n}\nfunction isEnumerable(base, prop) {\n  var desc = Object.getOwnPropertyDescriptor(base, prop);\n  return desc && desc.enumerable ? true : false;\n}\nfunction getArchtype(thing) {\n  /* istanbul ignore next */\n  if (!thing) { die(); }\n\n  if (thing[DRAFT_STATE]) {\n    switch (thing[DRAFT_STATE].type) {\n      case ProxyType.ES5Object:\n      case ProxyType.ProxyObject:\n        return Archtype.Object;\n\n      case ProxyType.ES5Array:\n      case ProxyType.ProxyArray:\n        return Archtype.Array;\n\n      case ProxyType.Map:\n        return Archtype.Map;\n\n      case ProxyType.Set:\n        return Archtype.Set;\n    }\n  }\n\n  return Array.isArray(thing) ? Archtype.Array : isMap(thing) ? Archtype.Map : isSet(thing) ? Archtype.Set : Archtype.Object;\n}\nfunction has(thing, prop) {\n  return getArchtype(thing) === Archtype.Map ? thing.has(prop) : Object.prototype.hasOwnProperty.call(thing, prop);\n}\nfunction get(thing, prop) {\n  // @ts-ignore\n  return getArchtype(thing) === Archtype.Map ? thing.get(prop) : thing[prop];\n}\nfunction set(thing, propOrOldValue, value) {\n  switch (getArchtype(thing)) {\n    case Archtype.Map:\n      thing.set(propOrOldValue, value);\n      break;\n\n    case Archtype.Set:\n      thing.delete(propOrOldValue);\n      thing.add(value);\n      break;\n\n    default:\n      thing[propOrOldValue] = value;\n  }\n}\nfunction is(x, y) {\n  // From: https://github.com/facebook/fbjs/blob/c69904a511b900266935168223063dd8772dfc40/packages/fbjs/src/core/shallowEqual.js\n  if (x === y) {\n    return x !== 0 || 1 / x === 1 / y;\n  } else {\n    return x !== x && y !== y;\n  }\n}\nfunction isMap(target) {\n  return hasMap && target instanceof Map;\n}\nfunction isSet(target) {\n  return hasSet && target instanceof Set;\n}\nfunction latest(state) {\n  return state.copy || state.base;\n}\nfunction shallowCopy(base, invokeGetters) {\n  if (invokeGetters === void 0) {\n    invokeGetters = false;\n  }\n\n  if (Array.isArray(base)) { return base.slice(); }\n  var clone = Object.create(Object.getPrototypeOf(base));\n  ownKeys(base).forEach(function (key) {\n    if (key === DRAFT_STATE) {\n      return; // Never copy over draft state.\n    }\n\n    var desc = Object.getOwnPropertyDescriptor(base, key);\n    var value = desc.value;\n\n    if (desc.get) {\n      if (!invokeGetters) {\n        throw new Error(\"Immer drafts cannot have computed properties\");\n      }\n\n      value = desc.get.call(base);\n    }\n\n    if (desc.enumerable) {\n      clone[key] = value;\n    } else {\n      Object.defineProperty(clone, key, {\n        value: value,\n        writable: true,\n        configurable: true\n      });\n    }\n  });\n  return clone;\n}\nfunction freeze(obj, deep) {\n  if (!isDraftable(obj) || isDraft(obj) || Object.isFrozen(obj)) { return; }\n  var type = getArchtype(obj);\n\n  if (type === Archtype.Set) {\n    obj.add = obj.clear = obj.delete = dontMutateFrozenCollections;\n  } else if (type === Archtype.Map) {\n    obj.set = obj.clear = obj.delete = dontMutateFrozenCollections;\n  }\n\n  Object.freeze(obj);\n  if (deep) { each(obj, function (_, value) {\n    return freeze(value, true);\n  }); }\n}\n\nfunction dontMutateFrozenCollections() {\n  throw new Error(\"This object has been frozen and should not be mutated\");\n}\n\nfunction createHiddenProperty(target, prop, value) {\n  Object.defineProperty(target, prop, {\n    value: value,\n    enumerable: false,\n    writable: true\n  });\n}\n/* istanbul ignore next */\n\nfunction die() {\n  throw new Error(\"Illegal state, please file a bug\");\n}\n\n/** Each scope represents a `produce` call. */\n\nvar ImmerScope =\n/** @class */\nfunction () {\n  function ImmerScope(parent, immer) {\n    this.drafts = [];\n    this.parent = parent;\n    this.immer = immer; // Whenever the modified draft contains a draft from another scope, we\n    // need to prevent auto-freezing so the unowned draft can be finalized.\n\n    this.canAutoFreeze = true;\n  }\n\n  ImmerScope.prototype.usePatches = function (patchListener) {\n    if (patchListener) {\n      this.patches = [];\n      this.inversePatches = [];\n      this.patchListener = patchListener;\n    }\n  };\n\n  ImmerScope.prototype.revoke = function () {\n    this.leave();\n    this.drafts.forEach(revoke); // @ts-ignore\n\n    this.drafts = null;\n  };\n\n  ImmerScope.prototype.leave = function () {\n    if (this === ImmerScope.current) {\n      ImmerScope.current = this.parent;\n    }\n  };\n\n  ImmerScope.enter = function (immer) {\n    var scope = new ImmerScope(ImmerScope.current, immer);\n    ImmerScope.current = scope;\n    return scope;\n  };\n\n  return ImmerScope;\n}();\n\nfunction revoke(draft) {\n  var state = draft[DRAFT_STATE];\n  if (state.type === ProxyType.ProxyObject || state.type === ProxyType.ProxyArray) { state.revoke(); }else { state.revoked = true; }\n}\n\nfunction processResult(immer, result, scope) {\n  var baseDraft = scope.drafts[0];\n  var isReplaced = result !== undefined && result !== baseDraft;\n  immer.willFinalize(scope, result, isReplaced);\n\n  if (isReplaced) {\n    if (baseDraft[DRAFT_STATE].modified) {\n      scope.revoke();\n      throw new Error(\"An immer producer returned a new value *and* modified its draft. Either return a new value *or* modify the draft.\"); // prettier-ignore\n    }\n\n    if (isDraftable(result)) {\n      // Finalize the result in case it contains (or is) a subset of the draft.\n      result = finalize(immer, result, scope);\n      if (!scope.parent) { maybeFreeze(immer, result); }\n    }\n\n    if (scope.patches) {\n      scope.patches.push({\n        op: \"replace\",\n        path: [],\n        value: result\n      });\n      scope.inversePatches.push({\n        op: \"replace\",\n        path: [],\n        value: baseDraft[DRAFT_STATE].base\n      });\n    }\n  } else {\n    // Finalize the base draft.\n    result = finalize(immer, baseDraft, scope, []);\n  }\n\n  scope.revoke();\n\n  if (scope.patches) {\n    scope.patchListener(scope.patches, scope.inversePatches);\n  }\n\n  return result !== NOTHING ? result : undefined;\n}\n\nfunction finalize(immer, draft, scope, path) {\n  var state = draft[DRAFT_STATE];\n\n  if (!state) {\n    if (Object.isFrozen(draft)) { return draft; }\n    return finalizeTree(immer, draft, scope);\n  } // Never finalize drafts owned by another scope.\n\n\n  if (state.scope !== scope) {\n    return draft;\n  }\n\n  if (!state.modified) {\n    maybeFreeze(immer, state.base, true);\n    return state.base;\n  }\n\n  if (!state.finalized) {\n    state.finalized = true;\n    finalizeTree(immer, state.draft, scope, path); // We cannot really delete anything inside of a Set. We can only replace the whole Set.\n\n    if (immer.onDelete && state.type !== ProxyType.Set) {\n      // The `assigned` object is unreliable with ES5 drafts.\n      if (immer.useProxies) {\n        var assigned = state.assigned;\n        each(assigned, function (prop, exists) {\n          if (!exists) { immer.onDelete(state, prop); }\n        });\n      } else {\n        var base = state.base,\n            copy_1 = state.copy;\n        each(base, function (prop) {\n          if (!has(copy_1, prop)) { immer.onDelete(state, prop); }\n        });\n      }\n    }\n\n    if (immer.onCopy) {\n      immer.onCopy(state);\n    } // At this point, all descendants of `state.copy` have been finalized,\n    // so we can be sure that `scope.canAutoFreeze` is accurate.\n\n\n    if (immer.autoFreeze && scope.canAutoFreeze) {\n      freeze(state.copy, false);\n    }\n\n    if (path && scope.patches) {\n      generatePatches(state, path, scope.patches, scope.inversePatches);\n    }\n  }\n\n  return state.copy;\n}\n\nfunction finalizeTree(immer, root, scope, rootPath) {\n  var state = root[DRAFT_STATE];\n\n  if (state) {\n    if (state.type === ProxyType.ES5Object || state.type === ProxyType.ES5Array) {\n      // Create the final copy, with added keys and without deleted keys.\n      state.copy = shallowCopy(state.draft, true);\n    }\n\n    root = state.copy;\n  }\n\n  each(root, function (key, value) {\n    return finalizeProperty(immer, scope, root, state, root, key, value, rootPath);\n  });\n  return root;\n}\n\nfunction finalizeProperty(immer, scope, root, rootState, parentValue, prop, childValue, rootPath) {\n  if (childValue === parentValue) {\n    throw Error(\"Immer forbids circular references\");\n  } // In the `finalizeTree` method, only the `root` object may be a draft.\n\n\n  var isDraftProp = !!rootState && parentValue === root;\n  var isSetMember = isSet(parentValue);\n\n  if (isDraft(childValue)) {\n    var path = rootPath && isDraftProp && !isSetMember && // Set objects are atomic since they have no keys.\n    !has(rootState.assigned, prop) // Skip deep patches for assigned keys.\n    ? rootPath.concat(prop) : undefined; // Drafts owned by `scope` are finalized here.\n\n    childValue = finalize(immer, childValue, scope, path);\n    set(parentValue, prop, childValue); // Drafts from another scope must prevent auto-freezing.\n\n    if (isDraft(childValue)) {\n      scope.canAutoFreeze = false;\n    }\n  } // Unchanged draft properties are ignored.\n  else if (isDraftProp && is(childValue, get(rootState.base, prop))) {\n      return;\n    } // Search new objects for unfinalized drafts. Frozen objects should never contain drafts.\n    // TODO: the recursion over here looks weird, shouldn't non-draft stuff have it's own recursion?\n    // especially the passing on of root and rootState doesn't make sense...\n    else if (isDraftable(childValue)) {\n        each(childValue, function (key, grandChild) {\n          return finalizeProperty(immer, scope, root, rootState, childValue, key, grandChild, rootPath);\n        });\n        if (!scope.parent) { maybeFreeze(immer, childValue); }\n      }\n\n  if (isDraftProp && immer.onAssign && !isSetMember) {\n    immer.onAssign(rootState, prop, childValue);\n  }\n}\n\nfunction maybeFreeze(immer, value, deep) {\n  if (deep === void 0) {\n    deep = false;\n  }\n\n  if (immer.autoFreeze && !isDraft(value)) {\n    freeze(value, deep);\n  }\n}\n\n/**\r\n * Returns a new draft of the `base` object.\r\n *\r\n * The second argument is the parent draft-state (used internally).\r\n */\n\nfunction createProxy(base, parent) {\n  var isArray = Array.isArray(base);\n  var state = {\n    type: isArray ? ProxyType.ProxyArray : ProxyType.ProxyObject,\n    // Track which produce call this is associated with.\n    scope: parent ? parent.scope : ImmerScope.current,\n    // True for both shallow and deep changes.\n    modified: false,\n    // Used during finalization.\n    finalized: false,\n    // Track which properties have been assigned (true) or deleted (false).\n    assigned: {},\n    // The parent draft state.\n    parent: parent,\n    // The base state.\n    base: base,\n    // The base proxy.\n    draft: null,\n    // Any property proxies.\n    drafts: {},\n    // The base copy with any updated values.\n    copy: null,\n    // Called by the `produce` function.\n    revoke: null,\n    isManual: false\n  }; // the traps must target something, a bit like the 'real' base.\n  // but also, we need to be able to determine from the target what the relevant state is\n  // (to avoid creating traps per instance to capture the state in closure,\n  // and to avoid creating weird hidden properties as well)\n  // So the trick is to use 'state' as the actual 'target'! (and make sure we intercept everything)\n  // Note that in the case of an array, we put the state in an array to have better Reflect defaults ootb\n\n  var target = state;\n  var traps = objectTraps;\n\n  if (isArray) {\n    target = [state];\n    traps = arrayTraps;\n  } // TODO: optimization: might be faster, cheaper if we created a non-revocable proxy\n  // and administrate revoking ourselves\n\n\n  var _a = Proxy.revocable(target, traps),\n      revoke = _a.revoke,\n      proxy = _a.proxy;\n\n  state.draft = proxy;\n  state.revoke = revoke;\n  return proxy;\n}\n/**\r\n * Object drafts\r\n */\n\nvar objectTraps = {\n  get: function (state, prop) {\n    if (prop === DRAFT_STATE) { return state; }\n    var drafts = state.drafts; // Check for existing draft in unmodified state.\n\n    if (!state.modified && has(drafts, prop)) {\n      return drafts[prop];\n    }\n\n    var value = latest(state)[prop];\n\n    if (state.finalized || !isDraftable(value)) {\n      return value;\n    } // Check for existing draft in modified state.\n\n\n    if (state.modified) {\n      // Assigned values are never drafted. This catches any drafts we created, too.\n      if (value !== peek(state.base, prop)) { return value; } // Store drafts on the copy (when one exists).\n      // @ts-ignore\n\n      drafts = state.copy;\n    }\n\n    return drafts[prop] = state.scope.immer.createProxy(value, state);\n  },\n  has: function (state, prop) {\n    return prop in latest(state);\n  },\n  ownKeys: function (state) {\n    return Reflect.ownKeys(latest(state));\n  },\n  set: function (state, prop\n  /* strictly not, but helps TS */\n  , value) {\n    if (!state.modified) {\n      var baseValue = peek(state.base, prop); // Optimize based on value's truthiness. Truthy values are guaranteed to\n      // never be undefined, so we can avoid the `in` operator. Lastly, truthy\n      // values may be drafts, but falsy values are never drafts.\n\n      var isUnchanged = value ? is(baseValue, value) || value === state.drafts[prop] : is(baseValue, value) && prop in state.base;\n      if (isUnchanged) { return true; }\n      prepareCopy(state);\n      markChanged(state);\n    }\n\n    state.assigned[prop] = true; // @ts-ignore\n\n    state.copy[prop] = value;\n    return true;\n  },\n  deleteProperty: function (state, prop) {\n    // The `undefined` check is a fast path for pre-existing keys.\n    if (peek(state.base, prop) !== undefined || prop in state.base) {\n      state.assigned[prop] = false;\n      prepareCopy(state);\n      markChanged(state);\n    } else if (state.assigned[prop]) {\n      // if an originally not assigned property was deleted\n      delete state.assigned[prop];\n    } // @ts-ignore\n\n\n    if (state.copy) { delete state.copy[prop]; }\n    return true;\n  },\n  // Note: We never coerce `desc.value` into an Immer draft, because we can't make\n  // the same guarantee in ES5 mode.\n  getOwnPropertyDescriptor: function (state, prop) {\n    var owner = latest(state);\n    var desc = Reflect.getOwnPropertyDescriptor(owner, prop);\n\n    if (desc) {\n      desc.writable = true;\n      desc.configurable = state.type !== ProxyType.ProxyArray || prop !== \"length\";\n    }\n\n    return desc;\n  },\n  defineProperty: function () {\n    throw new Error(\"Object.defineProperty() cannot be used on an Immer draft\"); // prettier-ignore\n  },\n  getPrototypeOf: function (state) {\n    return Object.getPrototypeOf(state.base);\n  },\n  setPrototypeOf: function () {\n    throw new Error(\"Object.setPrototypeOf() cannot be used on an Immer draft\"); // prettier-ignore\n  }\n};\n/**\r\n * Array drafts\r\n */\n\nvar arrayTraps = {};\neach(objectTraps, function (key, fn) {\n  // @ts-ignore\n  arrayTraps[key] = function () {\n    arguments[0] = arguments[0][0];\n    return fn.apply(this, arguments);\n  };\n});\n\narrayTraps.deleteProperty = function (state, prop) {\n  if (isNaN(parseInt(prop))) {\n    throw new Error(\"Immer only supports deleting array indices\"); // prettier-ignore\n  }\n\n  return objectTraps.deleteProperty.call(this, state[0], prop);\n};\n\narrayTraps.set = function (state, prop, value) {\n  if (prop !== \"length\" && isNaN(parseInt(prop))) {\n    throw new Error(\"Immer only supports setting array indices and the 'length' property\"); // prettier-ignore\n  }\n\n  return objectTraps.set.call(this, state[0], prop, value, state[0]);\n};\n/**\r\n * Map drafts\r\n */\n// Access a property without creating an Immer draft.\n\n\nfunction peek(draft, prop) {\n  var state = draft[DRAFT_STATE];\n  var desc = Reflect.getOwnPropertyDescriptor(state ? latest(state) : draft, prop);\n  return desc && desc.value;\n}\n\nfunction markChanged(state) {\n  if (!state.modified) {\n    state.modified = true;\n\n    if (state.type === ProxyType.ProxyObject || state.type === ProxyType.ProxyArray) {\n      var copy_1 = state.copy = shallowCopy(state.base);\n      each(state.drafts, function (key, value) {\n        // @ts-ignore\n        copy_1[key] = value;\n      });\n      state.drafts = undefined;\n    }\n\n    if (state.parent) {\n      markChanged(state.parent);\n    }\n  }\n}\n\nfunction prepareCopy(state) {\n  if (!state.copy) {\n    state.copy = shallowCopy(state.base);\n  }\n}\n\nfunction willFinalizeES5(scope, result, isReplaced) {\n  scope.drafts.forEach(function (draft) {\n    draft[DRAFT_STATE].finalizing = true;\n  });\n\n  if (!isReplaced) {\n    if (scope.patches) {\n      markChangesRecursively(scope.drafts[0]);\n    } // This is faster when we don't care about which attributes changed.\n\n\n    markChangesSweep(scope.drafts);\n  } // When a child draft is returned, look for changes.\n  else if (isDraft(result) && result[DRAFT_STATE].scope === scope) {\n      markChangesSweep(scope.drafts);\n    }\n}\nfunction createES5Proxy(base, parent) {\n  var isArray = Array.isArray(base);\n  var draft = clonePotentialDraft(base);\n  each(draft, function (prop) {\n    proxyProperty(draft, prop, isArray || isEnumerable(base, prop));\n  });\n  var state = {\n    type: isArray ? ProxyType.ES5Array : ProxyType.ES5Object,\n    scope: parent ? parent.scope : ImmerScope.current,\n    modified: false,\n    finalizing: false,\n    finalized: false,\n    assigned: {},\n    parent: parent,\n    base: base,\n    draft: draft,\n    copy: null,\n    revoked: false,\n    isManual: false\n  };\n  createHiddenProperty(draft, DRAFT_STATE, state);\n  return draft;\n} // Access a property without creating an Immer draft.\n\nfunction peek$1(draft, prop) {\n  var state = draft[DRAFT_STATE];\n\n  if (state && !state.finalizing) {\n    state.finalizing = true;\n    var value = draft[prop];\n    state.finalizing = false;\n    return value;\n  }\n\n  return draft[prop];\n}\n\nfunction get$1(state, prop) {\n  assertUnrevoked(state);\n  var value = peek$1(latest(state), prop);\n  if (state.finalizing) { return value; } // Create a draft if the value is unmodified.\n\n  if (value === peek$1(state.base, prop) && isDraftable(value)) {\n    prepareCopy$1(state); // @ts-ignore\n\n    return state.copy[prop] = state.scope.immer.createProxy(value, state);\n  }\n\n  return value;\n}\n\nfunction set$1(state, prop, value) {\n  assertUnrevoked(state);\n  state.assigned[prop] = true;\n\n  if (!state.modified) {\n    if (is(value, peek$1(latest(state), prop))) { return; }\n    markChangedES5(state);\n    prepareCopy$1(state);\n  } // @ts-ignore\n\n\n  state.copy[prop] = value;\n}\n\nfunction markChangedES5(state) {\n  if (!state.modified) {\n    state.modified = true;\n    if (state.parent) { markChangedES5(state.parent); }\n  }\n}\n\nfunction prepareCopy$1(state) {\n  if (!state.copy) { state.copy = clonePotentialDraft(state.base); }\n}\n\nfunction clonePotentialDraft(base) {\n  var state = base && base[DRAFT_STATE];\n\n  if (state) {\n    state.finalizing = true;\n    var draft = shallowCopy(state.draft, true);\n    state.finalizing = false;\n    return draft;\n  }\n\n  return shallowCopy(base);\n} // property descriptors are recycled to make sure we don't create a get and set closure per property,\n// but share them all instead\n\n\nvar descriptors = {};\n\nfunction proxyProperty(draft, prop, enumerable) {\n  var desc = descriptors[prop];\n\n  if (desc) {\n    desc.enumerable = enumerable;\n  } else {\n    descriptors[prop] = desc = {\n      configurable: true,\n      enumerable: enumerable,\n      get: function () {\n        return get$1(this[DRAFT_STATE], prop);\n      },\n      set: function (value) {\n        set$1(this[DRAFT_STATE], prop, value);\n      }\n    };\n  }\n\n  Object.defineProperty(draft, prop, desc);\n}\n\nfunction assertUnrevoked(state) {\n  if (state.revoked === true) { throw new Error(\"Cannot use a proxy that has been revoked. Did you pass an object from inside an immer function to an async process? \" + JSON.stringify(latest(state))); }\n} // This looks expensive, but only proxies are visited, and only objects without known changes are scanned.\n\nfunction markChangesSweep(drafts) {\n  // The natural order of drafts in the `scope` array is based on when they\n  // were accessed. By processing drafts in reverse natural order, we have a\n  // better chance of processing leaf nodes first. When a leaf node is known to\n  // have changed, we can avoid any traversal of its ancestor nodes.\n  for (var i = drafts.length - 1; i >= 0; i--) {\n    var state = drafts[i][DRAFT_STATE];\n\n    if (!state.modified) {\n      switch (state.type) {\n        case ProxyType.ES5Array:\n          if (hasArrayChanges(state)) { markChangedES5(state); }\n          break;\n\n        case ProxyType.ES5Object:\n          if (hasObjectChanges(state)) { markChangedES5(state); }\n          break;\n      }\n    }\n  }\n}\n\nfunction markChangesRecursively(object) {\n  if (!object || typeof object !== \"object\") { return; }\n  var state = object[DRAFT_STATE];\n  if (!state) { return; }\n  var base = state.base,\n      draft = state.draft,\n      assigned = state.assigned,\n      type = state.type;\n\n  if (type === ProxyType.ES5Object) {\n    // Look for added keys.\n    // TODO: looks quite duplicate to hasObjectChanges,\n    // probably there is a faster way to detect changes, as sweep + recurse seems to do some\n    // unnecessary work.\n    // also: probably we can store the information we detect here, to speed up tree finalization!\n    each(draft, function (key) {\n      if (key === DRAFT_STATE) { return; } // The `undefined` check is a fast path for pre-existing keys.\n\n      if (base[key] === undefined && !has(base, key)) {\n        assigned[key] = true;\n        markChangedES5(state);\n      } else if (!assigned[key]) {\n        // Only untouched properties trigger recursion.\n        markChangesRecursively(draft[key]);\n      }\n    }); // Look for removed keys.\n\n    each(base, function (key) {\n      // The `undefined` check is a fast path for pre-existing keys.\n      if (draft[key] === undefined && !has(draft, key)) {\n        assigned[key] = false;\n        markChangedES5(state);\n      }\n    });\n  } else if (type === ProxyType.ES5Array) {\n    if (hasArrayChanges(state)) {\n      markChangedES5(state);\n      assigned.length = true;\n    }\n\n    if (draft.length < base.length) {\n      for (var i = draft.length; i < base.length; i++) { assigned[i] = false; }\n    } else {\n      for (var i = base.length; i < draft.length; i++) { assigned[i] = true; }\n    } // Minimum count is enough, the other parts has been processed.\n\n\n    var min = Math.min(draft.length, base.length);\n\n    for (var i = 0; i < min; i++) {\n      // Only untouched indices trigger recursion.\n      if (assigned[i] === undefined) { markChangesRecursively(draft[i]); }\n    }\n  }\n}\n\nfunction hasObjectChanges(state) {\n  var base = state.base,\n      draft = state.draft; // Search for added keys and changed keys. Start at the back, because\n  // non-numeric keys are ordered by time of definition on the object.\n\n  var keys = Object.keys(draft);\n\n  for (var i = keys.length - 1; i >= 0; i--) {\n    var key = keys[i];\n    var baseValue = base[key]; // The `undefined` check is a fast path for pre-existing keys.\n\n    if (baseValue === undefined && !has(base, key)) {\n      return true;\n    } // Once a base key is deleted, future changes go undetected, because its\n    // descriptor is erased. This branch detects any missed changes.\n    else {\n        var value = draft[key];\n        var state_1 = value && value[DRAFT_STATE];\n\n        if (state_1 ? state_1.base !== baseValue : !is(value, baseValue)) {\n          return true;\n        }\n      }\n  } // At this point, no keys were added or changed.\n  // Compare key count to determine if keys were deleted.\n\n\n  return keys.length !== Object.keys(base).length;\n}\n\nfunction hasArrayChanges(state) {\n  var draft = state.draft;\n  if (draft.length !== state.base.length) { return true; } // See #116\n  // If we first shorten the length, our array interceptors will be removed.\n  // If after that new items are added, result in the same original length,\n  // those last items will have no intercepting property.\n  // So if there is no own descriptor on the last position, we know that items were removed and added\n  // N.B.: splice, unshift, etc only shift values around, but not prop descriptors, so we only have to check\n  // the last one\n\n  var descriptor = Object.getOwnPropertyDescriptor(draft, draft.length - 1); // descriptor can be null, but only for newly created sparse arrays, eg. new Array(10)\n\n  if (descriptor && !descriptor.get) { return true; } // For all other cases, we don't have to compare, as they would have been picked up by the index setters\n\n  return false;\n}\n\nvar DraftMap = function (_super) {\n  if (!_super) {\n    /* istanbul ignore next */\n    throw new Error(\"Map is not polyfilled\");\n  }\n\n  __extends(DraftMap, _super); // Create class manually, cause #502\n\n\n  function DraftMap(target, parent) {\n    this[DRAFT_STATE] = {\n      type: ProxyType.Map,\n      parent: parent,\n      scope: parent ? parent.scope : ImmerScope.current,\n      modified: false,\n      finalized: false,\n      copy: undefined,\n      assigned: undefined,\n      base: target,\n      draft: this,\n      isManual: false,\n      revoked: false\n    };\n    return this;\n  }\n\n  var p = DraftMap.prototype; // TODO: smaller build size if we create a util for Object.defineProperty\n\n  Object.defineProperty(p, \"size\", {\n    get: function () {\n      return latest(this[DRAFT_STATE]).size;\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  p.has = function (key) {\n    return latest(this[DRAFT_STATE]).has(key);\n  };\n\n  p.set = function (key, value) {\n    var state = this[DRAFT_STATE];\n    assertUnrevoked(state);\n\n    if (latest(state).get(key) !== value) {\n      prepareCopy$2(state);\n      state.scope.immer.markChanged(state);\n      state.assigned.set(key, true);\n      state.copy.set(key, value);\n      state.assigned.set(key, true);\n    }\n\n    return this;\n  };\n\n  p.delete = function (key) {\n    if (!this.has(key)) {\n      return false;\n    }\n\n    var state = this[DRAFT_STATE];\n    assertUnrevoked(state);\n    prepareCopy$2(state);\n    state.scope.immer.markChanged(state);\n    state.assigned.set(key, false);\n    state.copy.delete(key);\n    return true;\n  };\n\n  p.clear = function () {\n    var state = this[DRAFT_STATE];\n    assertUnrevoked(state);\n    prepareCopy$2(state);\n    state.scope.immer.markChanged(state);\n    state.assigned = new Map();\n    return state.copy.clear();\n  };\n\n  p.forEach = function (cb, thisArg) {\n    var _this = this;\n\n    var state = this[DRAFT_STATE];\n    latest(state).forEach(function (_value, key, _map) {\n      cb.call(thisArg, _this.get(key), key, _this);\n    });\n  };\n\n  p.get = function (key) {\n    var state = this[DRAFT_STATE];\n    assertUnrevoked(state);\n    var value = latest(state).get(key);\n\n    if (state.finalized || !isDraftable(value)) {\n      return value;\n    }\n\n    if (value !== state.base.get(key)) {\n      return value; // either already drafted or reassigned\n    } // despite what it looks, this creates a draft only once, see above condition\n\n\n    var draft = state.scope.immer.createProxy(value, state);\n    prepareCopy$2(state);\n    state.copy.set(key, draft);\n    return draft;\n  };\n\n  p.keys = function () {\n    return latest(this[DRAFT_STATE]).keys();\n  };\n\n  p.values = function () {\n    var _a;\n\n    var _this = this;\n\n    var iterator = this.keys();\n    return _a = {}, _a[iteratorSymbol] = function () {\n      return _this.values();\n    }, _a.next = function () {\n      var r = iterator.next();\n      /* istanbul ignore next */\n\n      if (r.done) { return r; }\n\n      var value = _this.get(r.value);\n\n      return {\n        done: false,\n        value: value\n      };\n    }, _a;\n  };\n\n  p.entries = function () {\n    var _a;\n\n    var _this = this;\n\n    var iterator = this.keys();\n    return _a = {}, _a[iteratorSymbol] = function () {\n      return _this.entries();\n    }, _a.next = function () {\n      var r = iterator.next();\n      /* istanbul ignore next */\n\n      if (r.done) { return r; }\n\n      var value = _this.get(r.value);\n\n      return {\n        done: false,\n        value: [r.value, value]\n      };\n    }, _a;\n  };\n\n  p[iteratorSymbol] = function () {\n    return this.entries();\n  };\n\n  return DraftMap;\n}(Map);\n\nfunction proxyMap(target, parent) {\n  // @ts-ignore\n  return new DraftMap(target, parent);\n}\n\nfunction prepareCopy$2(state) {\n  if (!state.copy) {\n    state.assigned = new Map();\n    state.copy = new Map(state.base);\n  }\n}\n\nvar DraftSet = function (_super) {\n  if (!_super) {\n    /* istanbul ignore next */\n    throw new Error(\"Set is not polyfilled\");\n  }\n\n  __extends(DraftSet, _super); // Create class manually, cause #502\n\n\n  function DraftSet(target, parent) {\n    this[DRAFT_STATE] = {\n      type: ProxyType.Set,\n      parent: parent,\n      scope: parent ? parent.scope : ImmerScope.current,\n      modified: false,\n      finalized: false,\n      copy: undefined,\n      base: target,\n      draft: this,\n      drafts: new Map(),\n      revoked: false,\n      isManual: false\n    };\n    return this;\n  }\n\n  var p = DraftSet.prototype;\n  Object.defineProperty(p, \"size\", {\n    get: function () {\n      return latest(this[DRAFT_STATE]).size;\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  p.has = function (value) {\n    var state = this[DRAFT_STATE];\n    assertUnrevoked(state); // bit of trickery here, to be able to recognize both the value, and the draft of its value\n\n    if (!state.copy) {\n      return state.base.has(value);\n    }\n\n    if (state.copy.has(value)) { return true; }\n    if (state.drafts.has(value) && state.copy.has(state.drafts.get(value))) { return true; }\n    return false;\n  };\n\n  p.add = function (value) {\n    var state = this[DRAFT_STATE];\n    assertUnrevoked(state);\n\n    if (state.copy) {\n      state.copy.add(value);\n    } else if (!state.base.has(value)) {\n      prepareCopy$3(state);\n      state.scope.immer.markChanged(state);\n      state.copy.add(value);\n    }\n\n    return this;\n  };\n\n  p.delete = function (value) {\n    if (!this.has(value)) {\n      return false;\n    }\n\n    var state = this[DRAFT_STATE];\n    assertUnrevoked(state);\n    prepareCopy$3(state);\n    state.scope.immer.markChanged(state);\n    return state.copy.delete(value) || (state.drafts.has(value) ? state.copy.delete(state.drafts.get(value)) :\n    /* istanbul ignore next */\n    false);\n  };\n\n  p.clear = function () {\n    var state = this[DRAFT_STATE];\n    assertUnrevoked(state);\n    prepareCopy$3(state);\n    state.scope.immer.markChanged(state);\n    return state.copy.clear();\n  };\n\n  p.values = function () {\n    var state = this[DRAFT_STATE];\n    assertUnrevoked(state);\n    prepareCopy$3(state);\n    return state.copy.values();\n  };\n\n  p.entries = function entries() {\n    var state = this[DRAFT_STATE];\n    assertUnrevoked(state);\n    prepareCopy$3(state);\n    return state.copy.entries();\n  };\n\n  p.keys = function () {\n    return this.values();\n  };\n\n  p[iteratorSymbol] = function () {\n    return this.values();\n  };\n\n  p.forEach = function forEach(cb, thisArg) {\n    var iterator = this.values();\n    var result = iterator.next();\n\n    while (!result.done) {\n      cb.call(thisArg, result.value, result.value, this);\n      result = iterator.next();\n    }\n  };\n\n  return DraftSet;\n}(Set);\n\nfunction proxySet(target, parent) {\n  // @ts-ignore\n  return new DraftSet(target, parent);\n}\n\nfunction prepareCopy$3(state) {\n  if (!state.copy) {\n    // create drafts for all entries to preserve insertion order\n    state.copy = new Set();\n    state.base.forEach(function (value) {\n      if (isDraftable(value)) {\n        var draft = state.scope.immer.createProxy(value, state);\n        state.drafts.set(value, draft);\n        state.copy.add(draft);\n      } else {\n        state.copy.add(value);\n      }\n    });\n  }\n}\n\nfunction generatePatches(state, basePath, patches, inversePatches) {\n  switch (state.type) {\n    case ProxyType.ProxyObject:\n    case ProxyType.ES5Object:\n    case ProxyType.Map:\n      return generatePatchesFromAssigned(state, basePath, patches, inversePatches);\n\n    case ProxyType.ES5Array:\n    case ProxyType.ProxyArray:\n      return generateArrayPatches(state, basePath, patches, inversePatches);\n\n    case ProxyType.Set:\n      return generateSetPatches(state, basePath, patches, inversePatches);\n  }\n}\n\nfunction generateArrayPatches(state, basePath, patches, inversePatches) {\n  var _a, _b;\n\n  var base = state.base,\n      assigned = state.assigned,\n      copy = state.copy;\n  /* istanbul ignore next */\n\n  if (!copy) { die(); } // Reduce complexity by ensuring `base` is never longer.\n\n  if (copy.length < base.length) {\n    _a = [copy, base], base = _a[0], copy = _a[1];\n    _b = [inversePatches, patches], patches = _b[0], inversePatches = _b[1];\n  }\n\n  var delta = copy.length - base.length; // Find the first replaced index.\n\n  var start = 0;\n\n  while (base[start] === copy[start] && start < base.length) {\n    ++start;\n  } // Find the last replaced index. Search from the end to optimize splice patches.\n\n\n  var end = base.length;\n\n  while (end > start && base[end - 1] === copy[end + delta - 1]) {\n    --end;\n  } // Process replaced indices.\n\n\n  for (var i = start; i < end; ++i) {\n    if (assigned[i] && copy[i] !== base[i]) {\n      var path = basePath.concat([i]);\n      patches.push({\n        op: \"replace\",\n        path: path,\n        value: copy[i]\n      });\n      inversePatches.push({\n        op: \"replace\",\n        path: path,\n        value: base[i]\n      });\n    }\n  }\n\n  var replaceCount = patches.length; // Process added indices.\n\n  for (var i = end + delta - 1; i >= end; --i) {\n    var path = basePath.concat([i]);\n    patches[replaceCount + i - end] = {\n      op: \"add\",\n      path: path,\n      value: copy[i]\n    };\n    inversePatches.push({\n      op: \"remove\",\n      path: path\n    });\n  }\n} // This is used for both Map objects and normal objects.\n\n\nfunction generatePatchesFromAssigned(state, basePath, patches, inversePatches) {\n  var base = state.base,\n      copy = state.copy;\n  each(state.assigned, function (key, assignedValue) {\n    var origValue = get(base, key);\n    var value = get(copy, key);\n    var op = !assignedValue ? \"remove\" : has(base, key) ? \"replace\" : \"add\";\n    if (origValue === value && op === \"replace\") { return; }\n    var path = basePath.concat(key);\n    patches.push(op === \"remove\" ? {\n      op: op,\n      path: path\n    } : {\n      op: op,\n      path: path,\n      value: value\n    });\n    inversePatches.push(op === \"add\" ? {\n      op: \"remove\",\n      path: path\n    } : op === \"remove\" ? {\n      op: \"add\",\n      path: path,\n      value: origValue\n    } : {\n      op: \"replace\",\n      path: path,\n      value: origValue\n    });\n  });\n}\n\nfunction generateSetPatches(state, basePath, patches, inversePatches) {\n  var base = state.base,\n      copy = state.copy;\n  var i = 0;\n  base.forEach(function (value) {\n    if (!copy.has(value)) {\n      var path = basePath.concat([i]);\n      patches.push({\n        op: \"remove\",\n        path: path,\n        value: value\n      });\n      inversePatches.unshift({\n        op: \"add\",\n        path: path,\n        value: value\n      });\n    }\n\n    i++;\n  });\n  i = 0;\n  copy.forEach(function (value) {\n    if (!base.has(value)) {\n      var path = basePath.concat([i]);\n      patches.push({\n        op: \"add\",\n        path: path,\n        value: value\n      });\n      inversePatches.unshift({\n        op: \"remove\",\n        path: path,\n        value: value\n      });\n    }\n\n    i++;\n  });\n}\n\nfunction applyPatches(draft, patches) {\n  patches.forEach(function (patch) {\n    var path = patch.path,\n        op = patch.op;\n    /* istanbul ignore next */\n\n    if (!path.length) { die(); }\n    var base = draft;\n\n    for (var i = 0; i < path.length - 1; i++) {\n      base = get(base, path[i]);\n      if (!base || typeof base !== \"object\") { throw new Error(\"Cannot apply patch, path doesn't resolve: \" + path.join(\"/\")); } // prettier-ignore\n    }\n\n    var type = getArchtype(base);\n    var value = deepClonePatchValue(patch.value); // used to clone patch to ensure original patch is not modified, see #411\n\n    var key = path[path.length - 1];\n\n    switch (op) {\n      case \"replace\":\n        switch (type) {\n          case Archtype.Map:\n            return base.set(key, value);\n\n          /* istanbul ignore next */\n\n          case Archtype.Set:\n            throw new Error('Sets cannot have \"replace\" patches.');\n\n          default:\n            // if value is an object, then it's assigned by reference\n            // in the following add or remove ops, the value field inside the patch will also be modifyed\n            // so we use value from the cloned patch\n            // @ts-ignore\n            return base[key] = value;\n        }\n\n      case \"add\":\n        switch (type) {\n          case Archtype.Array:\n            return base.splice(key, 0, value);\n\n          case Archtype.Map:\n            return base.set(key, value);\n\n          case Archtype.Set:\n            return base.add(value);\n\n          default:\n            return base[key] = value;\n        }\n\n      case \"remove\":\n        switch (type) {\n          case Archtype.Array:\n            return base.splice(key, 1);\n\n          case Archtype.Map:\n            return base.delete(key);\n\n          case Archtype.Set:\n            return base.delete(patch.value);\n\n          default:\n            return delete base[key];\n        }\n\n      default:\n        throw new Error(\"Unsupported patch operation: \" + op);\n    }\n  });\n  return draft;\n}\n\nfunction deepClonePatchValue(obj) {\n  if (!obj || typeof obj !== \"object\") { return obj; }\n  if (Array.isArray(obj)) { return obj.map(deepClonePatchValue); }\n  if (isMap(obj)) { return new Map(Array.from(obj.entries()).map(function (_a) {\n    var k = _a[0],\n        v = _a[1];\n    return [k, deepClonePatchValue(v)];\n  })); }\n  if (isSet(obj)) { return new Set(Array.from(obj).map(deepClonePatchValue)); }\n  var cloned = Object.create(Object.getPrototypeOf(obj));\n\n  for (var key in obj) { cloned[key] = deepClonePatchValue(obj[key]); }\n\n  return cloned;\n}\n\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n\r\nfunction __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n}\n\n/* istanbul ignore next */\n\nfunction verifyMinified() {}\n\nvar configDefaults = {\n  useProxies: typeof Proxy !== \"undefined\" && typeof Proxy.revocable !== \"undefined\" && typeof Reflect !== \"undefined\",\n  autoFreeze: typeof process !== \"undefined\" ? process.env.NODE_ENV !== \"production\" :\n  /* istanbul ignore next */\n  verifyMinified.name === \"verifyMinified\",\n  onAssign: null,\n  onDelete: null,\n  onCopy: null\n};\n\nvar Immer =\n/** @class */\nfunction () {\n  function Immer(config) {\n    var _this = this;\n\n    this.useProxies = false;\n    this.autoFreeze = false;\n    each(configDefaults, function (key, value) {\n      var _a, _b; // @ts-ignore\n\n\n      _this[key] = (_b = (_a = config) === null || _a === void 0 ? void 0 : _a[key], _b !== null && _b !== void 0 ? _b : value);\n    });\n    this.setUseProxies(this.useProxies);\n    this.produce = this.produce.bind(this);\n    this.produceWithPatches = this.produceWithPatches.bind(this);\n  }\n  /**\r\n   * The `produce` function takes a value and a \"recipe function\" (whose\r\n   * return value often depends on the base state). The recipe function is\r\n   * free to mutate its first argument however it wants. All mutations are\r\n   * only ever applied to a __copy__ of the base state.\r\n   *\r\n   * Pass only a function to create a \"curried producer\" which relieves you\r\n   * from passing the recipe function every time.\r\n   *\r\n   * Only plain objects and arrays are made mutable. All other objects are\r\n   * considered uncopyable.\r\n   *\r\n   * Note: This function is __bound__ to its `Immer` instance.\r\n   *\r\n   * @param {any} base - the initial state\r\n   * @param {Function} producer - function that receives a proxy of the base state as first argument and which can be freely modified\r\n   * @param {Function} patchListener - optional function that will be called with all the patches produced here\r\n   * @returns {any} a new state, or the initial state if nothing was modified\r\n   */\n\n\n  Immer.prototype.produce = function (base, recipe, patchListener) {\n    var _this = this; // curried invocation\n\n\n    if (typeof base === \"function\" && typeof recipe !== \"function\") {\n      var defaultBase_1 = recipe;\n      recipe = base;\n      var self_1 = this;\n      return function curriedProduce(base) {\n        var arguments$1 = arguments;\n\n        var _this = this;\n\n        if (base === void 0) {\n          base = defaultBase_1;\n        }\n\n        var args = [];\n\n        for (var _i = 1; _i < arguments.length; _i++) {\n          args[_i - 1] = arguments$1[_i];\n        }\n\n        return self_1.produce(base, function (draft) {\n          return recipe.call.apply(recipe, __spreadArrays([_this, draft], args));\n        }); // prettier-ignore\n      };\n    } // prettier-ignore\n\n\n    {\n      if (typeof recipe !== \"function\") {\n        throw new Error(\"The first or second argument to `produce` must be a function\");\n      }\n\n      if (patchListener !== undefined && typeof patchListener !== \"function\") {\n        throw new Error(\"The third argument to `produce` must be a function or undefined\");\n      }\n    }\n    var result; // Only plain objects, arrays, and \"immerable classes\" are drafted.\n\n    if (isDraftable(base)) {\n      var scope_1 = ImmerScope.enter(this);\n      var proxy = this.createProxy(base, undefined);\n      var hasError = true;\n\n      try {\n        result = recipe(proxy);\n        hasError = false;\n      } finally {\n        // finally instead of catch + rethrow better preserves original stack\n        if (hasError) { scope_1.revoke(); }else { scope_1.leave(); }\n      }\n\n      if (typeof Promise !== \"undefined\" && result instanceof Promise) {\n        return result.then(function (result) {\n          scope_1.usePatches(patchListener);\n          return processResult(_this, result, scope_1);\n        }, function (error) {\n          scope_1.revoke();\n          throw error;\n        });\n      }\n\n      scope_1.usePatches(patchListener);\n      return processResult(this, result, scope_1);\n    } else {\n      result = recipe(base);\n      if (result === NOTHING) { return undefined; }\n      if (result === undefined) { result = base; }\n      maybeFreeze(this, result, true);\n      return result;\n    }\n  };\n\n  Immer.prototype.produceWithPatches = function (arg1, arg2, arg3) {\n    var _this = this;\n\n    if (typeof arg1 === \"function\") {\n      return function (state) {\n        var arguments$1 = arguments;\n\n        var args = [];\n\n        for (var _i = 1; _i < arguments.length; _i++) {\n          args[_i - 1] = arguments$1[_i];\n        }\n\n        return _this.produceWithPatches(state, function (draft) {\n          return arg1.apply(void 0, __spreadArrays([draft], args));\n        });\n      };\n    } // non-curried form\n\n    /* istanbul ignore next */\n\n\n    if (arg3) { die(); }\n    var patches, inversePatches;\n    var nextState = this.produce(arg1, arg2, function (p, ip) {\n      patches = p;\n      inversePatches = ip;\n    });\n    return [nextState, patches, inversePatches];\n  };\n\n  Immer.prototype.createDraft = function (base) {\n    if (!isDraftable(base)) {\n      throw new Error(\"First argument to `createDraft` must be a plain object, an array, or an immerable object\"); // prettier-ignore\n    }\n\n    var scope = ImmerScope.enter(this);\n    var proxy = this.createProxy(base, undefined);\n    proxy[DRAFT_STATE].isManual = true;\n    scope.leave();\n    return proxy;\n  };\n\n  Immer.prototype.finishDraft = function (draft, patchListener) {\n    var state = draft && draft[DRAFT_STATE];\n\n    if (!state || !state.isManual) {\n      throw new Error(\"First argument to `finishDraft` must be a draft returned by `createDraft`\"); // prettier-ignore\n    }\n\n    if (state.finalized) {\n      throw new Error(\"The given draft is already finalized\"); // prettier-ignore\n    }\n\n    var scope = state.scope;\n    scope.usePatches(patchListener);\n    return processResult(this, undefined, scope);\n  };\n  /**\r\n   * Pass true to automatically freeze all copies created by Immer.\r\n   *\r\n   * By default, auto-freezing is disabled in production.\r\n   */\n\n\n  Immer.prototype.setAutoFreeze = function (value) {\n    this.autoFreeze = value;\n  };\n  /**\r\n   * Pass true to use the ES2015 `Proxy` class when creating drafts, which is\r\n   * always faster than using ES5 proxies.\r\n   *\r\n   * By default, feature detection is used, so calling this is rarely necessary.\r\n   */\n\n\n  Immer.prototype.setUseProxies = function (value) {\n    this.useProxies = value;\n  };\n\n  Immer.prototype.applyPatches = function (base, patches) {\n    // If a patch replaces the entire state, take that replacement as base\n    // before applying patches\n    var i;\n\n    for (i = patches.length - 1; i >= 0; i--) {\n      var patch = patches[i];\n\n      if (patch.path.length === 0 && patch.op === \"replace\") {\n        base = patch.value;\n        break;\n      }\n    }\n\n    if (isDraft(base)) {\n      // N.B: never hits if some patch a replacement, patches are never drafts\n      return applyPatches(base, patches);\n    } // Otherwise, produce a copy of the base state.\n\n\n    return this.produce(base, function (draft) {\n      return applyPatches(draft, patches.slice(i + 1));\n    });\n  };\n\n  Immer.prototype.createProxy = function (value, parent) {\n    // precondition: createProxy should be guarded by isDraftable, so we know we can safely draft\n    var draft = isMap(value) ? proxyMap(value, parent) : isSet(value) ? proxySet(value, parent) : this.useProxies ? createProxy(value, parent) : createES5Proxy(value, parent);\n    var scope = parent ? parent.scope : ImmerScope.current;\n    scope.drafts.push(draft);\n    return draft;\n  };\n\n  Immer.prototype.willFinalize = function (scope, thing, isReplaced) {\n    if (!this.useProxies) { willFinalizeES5(scope, thing, isReplaced); }\n  };\n\n  Immer.prototype.markChanged = function (state) {\n    if (this.useProxies) {\n      markChanged(state);\n    } else {\n      markChangedES5(state);\n    }\n  };\n\n  return Immer;\n}();\n\nvar immer = new Immer();\n/**\r\n * The `produce` function takes a value and a \"recipe function\" (whose\r\n * return value often depends on the base state). The recipe function is\r\n * free to mutate its first argument however it wants. All mutations are\r\n * only ever applied to a __copy__ of the base state.\r\n *\r\n * Pass only a function to create a \"curried producer\" which relieves you\r\n * from passing the recipe function every time.\r\n *\r\n * Only plain objects and arrays are made mutable. All other objects are\r\n * considered uncopyable.\r\n *\r\n * Note: This function is __bound__ to its `Immer` instance.\r\n *\r\n * @param {any} base - the initial state\r\n * @param {Function} producer - function that receives a proxy of the base state as first argument and which can be freely modified\r\n * @param {Function} patchListener - optional function that will be called with all the patches produced here\r\n * @returns {any} a new state, or the initial state if nothing was modified\r\n */\n\nvar produce = immer.produce;\n/**\r\n * Like `produce`, but `produceWithPatches` always returns a tuple\r\n * [nextState, patches, inversePatches] (instead of just the next state)\r\n */\n\nvar produceWithPatches = immer.produceWithPatches.bind(immer);\n/**\r\n * Pass true to automatically freeze all copies created by Immer.\r\n *\r\n * By default, auto-freezing is disabled in production.\r\n */\n\nvar setAutoFreeze = immer.setAutoFreeze.bind(immer);\n/**\r\n * Pass true to use the ES2015 `Proxy` class when creating drafts, which is\r\n * always faster than using ES5 proxies.\r\n *\r\n * By default, feature detection is used, so calling this is rarely necessary.\r\n */\n\nvar setUseProxies = immer.setUseProxies.bind(immer);\n/**\r\n * Apply an array of Immer patches to the first argument.\r\n *\r\n * This function is a producer, which means copy-on-write is in effect.\r\n */\n\nvar applyPatches$1 = immer.applyPatches.bind(immer);\n/**\r\n * Create an Immer draft from the given base state, which may be a draft itself.\r\n * The draft can be modified until you finalize it with the `finishDraft` function.\r\n */\n\nvar createDraft = immer.createDraft.bind(immer);\n/**\r\n * Finalize an Immer draft from a `createDraft` call, returning the base state\r\n * (if no changes were made) or a modified copy. The draft must *not* be\r\n * mutated afterwards.\r\n *\r\n * Pass a function as the 2nd argument to generate Immer patches based on the\r\n * changes that were made.\r\n */\n\nvar finishDraft = immer.finishDraft.bind(immer);\n/**\r\n * This function is actually a no-op, but can be used to cast an immutable type\r\n * to an draft type and make TypeScript happy\r\n *\r\n * @param value\r\n */\n\nfunction castDraft(value) {\n  return value;\n}\n/**\r\n * This function is actually a no-op, but can be used to cast a mutable type\r\n * to an immutable type and make TypeScript happy\r\n * @param value\r\n */\n\nfunction castImmutable(value) {\n  return value;\n}\n\nexport default produce;\nexport { Immer, applyPatches$1 as applyPatches, castDraft, castImmutable, createDraft, finishDraft, DRAFTABLE as immerable, isDraft, isDraftable, NOTHING as nothing, original, produce, produceWithPatches, setAutoFreeze, setUseProxies };\n//# sourceMappingURL=immer.module.js.map\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\n/**\n * Constants.\n */\n\nvar IS_MAC = typeof window != 'undefined' && /Mac|iPod|iPhone|iPad/.test(window.navigator.platform);\n\nvar MODIFIERS = {\n  alt: 'altKey',\n  control: 'ctrlKey',\n  meta: 'metaKey',\n  shift: 'shiftKey'\n};\n\nvar ALIASES = {\n  add: '+',\n  break: 'pause',\n  cmd: 'meta',\n  command: 'meta',\n  ctl: 'control',\n  ctrl: 'control',\n  del: 'delete',\n  down: 'arrowdown',\n  esc: 'escape',\n  ins: 'insert',\n  left: 'arrowleft',\n  mod: IS_MAC ? 'meta' : 'control',\n  opt: 'alt',\n  option: 'alt',\n  return: 'enter',\n  right: 'arrowright',\n  space: ' ',\n  spacebar: ' ',\n  up: 'arrowup',\n  win: 'meta',\n  windows: 'meta'\n};\n\nvar CODES = {\n  backspace: 8,\n  tab: 9,\n  enter: 13,\n  shift: 16,\n  control: 17,\n  alt: 18,\n  pause: 19,\n  capslock: 20,\n  escape: 27,\n  ' ': 32,\n  pageup: 33,\n  pagedown: 34,\n  end: 35,\n  home: 36,\n  arrowleft: 37,\n  arrowup: 38,\n  arrowright: 39,\n  arrowdown: 40,\n  insert: 45,\n  delete: 46,\n  meta: 91,\n  numlock: 144,\n  scrolllock: 145,\n  ';': 186,\n  '=': 187,\n  ',': 188,\n  '-': 189,\n  '.': 190,\n  '/': 191,\n  '`': 192,\n  '[': 219,\n  '\\\\': 220,\n  ']': 221,\n  '\\'': 222\n};\n\nfor (var f = 1; f < 20; f++) {\n  CODES['f' + f] = 111 + f;\n}\n\n/**\n * Is hotkey?\n */\n\nfunction isHotkey(hotkey, options, event) {\n  if (options && !('byKey' in options)) {\n    event = options;\n    options = null;\n  }\n\n  if (!Array.isArray(hotkey)) {\n    hotkey = [hotkey];\n  }\n\n  var array = hotkey.map(function (string) {\n    return parseHotkey(string, options);\n  });\n  var check = function check(e) {\n    return array.some(function (object) {\n      return compareHotkey(object, e);\n    });\n  };\n  var ret = event == null ? check : check(event);\n  return ret;\n}\n\nfunction isCodeHotkey(hotkey, event) {\n  return isHotkey(hotkey, event);\n}\n\nfunction isKeyHotkey(hotkey, event) {\n  return isHotkey(hotkey, { byKey: true }, event);\n}\n\n/**\n * Parse.\n */\n\nfunction parseHotkey(hotkey, options) {\n  var byKey = options && options.byKey;\n  var ret = {};\n\n  // Special case to handle the `+` key since we use it as a separator.\n  hotkey = hotkey.replace('++', '+add');\n  var values = hotkey.split('+');\n  var length = values.length;\n\n  // Ensure that all the modifiers are set to false unless the hotkey has them.\n\n  for (var k in MODIFIERS) {\n    ret[MODIFIERS[k]] = false;\n  }\n\n  var _iteratorNormalCompletion = true;\n  var _didIteratorError = false;\n  var _iteratorError = undefined;\n\n  try {\n    for (var _iterator = values[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n      var value = _step.value;\n\n      var optional = value.endsWith('?') && value.length > 1;\n\n      if (optional) {\n        value = value.slice(0, -1);\n      }\n\n      var name = toKeyName(value);\n      var modifier = MODIFIERS[name];\n\n      if (length === 1 || !modifier) {\n        if (byKey) {\n          ret.key = name;\n        } else {\n          ret.which = toKeyCode(value);\n        }\n      }\n\n      if (modifier) {\n        ret[modifier] = optional ? null : true;\n      }\n    }\n  } catch (err) {\n    _didIteratorError = true;\n    _iteratorError = err;\n  } finally {\n    try {\n      if (!_iteratorNormalCompletion && _iterator.return) {\n        _iterator.return();\n      }\n    } finally {\n      if (_didIteratorError) {\n        throw _iteratorError;\n      }\n    }\n  }\n\n  return ret;\n}\n\n/**\n * Compare.\n */\n\nfunction compareHotkey(object, event) {\n  for (var key in object) {\n    var expected = object[key];\n    var actual = void 0;\n\n    if (expected == null) {\n      continue;\n    }\n\n    if (key === 'key' && event.key != null) {\n      actual = event.key.toLowerCase();\n    } else if (key === 'which') {\n      actual = expected === 91 && event.which === 93 ? 91 : event.which;\n    } else {\n      actual = event[key];\n    }\n\n    if (actual == null && expected === false) {\n      continue;\n    }\n\n    if (actual !== expected) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\n/**\n * Utils.\n */\n\nfunction toKeyCode(name) {\n  name = toKeyName(name);\n  var code = CODES[name] || name.toUpperCase().charCodeAt(0);\n  return code;\n}\n\nfunction toKeyName(name) {\n  name = name.toLowerCase();\n  name = ALIASES[name] || name;\n  return name;\n}\n\n/**\n * Export.\n */\n\nexports.default = isHotkey;\nexports.isHotkey = isHotkey;\nexports.isCodeHotkey = isCodeHotkey;\nexports.isKeyHotkey = isKeyHotkey;\nexports.parseHotkey = parseHotkey;\nexports.compareHotkey = compareHotkey;\nexports.toKeyCode = toKeyCode;\nexports.toKeyName = toKeyName;","var root = require('./_root');\n\n/** Built-in value references. */\nvar Symbol = root.Symbol;\n\nmodule.exports = Symbol;\n","var Symbol = require('./_Symbol'),\n    getRawTag = require('./_getRawTag'),\n    objectToString = require('./_objectToString');\n\n/** `Object#toString` result references. */\nvar nullTag = '[object Null]',\n    undefinedTag = '[object Undefined]';\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * The base implementation of `getTag` without fallbacks for buggy environments.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nfunction baseGetTag(value) {\n  if (value == null) {\n    return value === undefined ? undefinedTag : nullTag;\n  }\n  return (symToStringTag && symToStringTag in Object(value))\n    ? getRawTag(value)\n    : objectToString(value);\n}\n\nmodule.exports = baseGetTag;\n","/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\nmodule.exports = freeGlobal;\n","var Symbol = require('./_Symbol');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * A specialized version of `baseGetTag` which ignores `Symbol.toStringTag` values.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the raw `toStringTag`.\n */\nfunction getRawTag(value) {\n  var isOwn = hasOwnProperty.call(value, symToStringTag),\n      tag = value[symToStringTag];\n\n  try {\n    value[symToStringTag] = undefined;\n    var unmasked = true;\n  } catch (e) {}\n\n  var result = nativeObjectToString.call(value);\n  if (unmasked) {\n    if (isOwn) {\n      value[symToStringTag] = tag;\n    } else {\n      delete value[symToStringTag];\n    }\n  }\n  return result;\n}\n\nmodule.exports = getRawTag;\n","/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/**\n * Converts `value` to a string using `Object.prototype.toString`.\n *\n * @private\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n */\nfunction objectToString(value) {\n  return nativeObjectToString.call(value);\n}\n\nmodule.exports = objectToString;\n","var freeGlobal = require('./_freeGlobal');\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\nmodule.exports = root;\n","var isObject = require('./isObject'),\n    now = require('./now'),\n    toNumber = require('./toNumber');\n\n/** Error message constants. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max,\n    nativeMin = Math.min;\n\n/**\n * Creates a debounced function that delays invoking `func` until after `wait`\n * milliseconds have elapsed since the last time the debounced function was\n * invoked. The debounced function comes with a `cancel` method to cancel\n * delayed `func` invocations and a `flush` method to immediately invoke them.\n * Provide `options` to indicate whether `func` should be invoked on the\n * leading and/or trailing edge of the `wait` timeout. The `func` is invoked\n * with the last arguments provided to the debounced function. Subsequent\n * calls to the debounced function return the result of the last `func`\n * invocation.\n *\n * **Note:** If `leading` and `trailing` options are `true`, `func` is\n * invoked on the trailing edge of the timeout only if the debounced function\n * is invoked more than once during the `wait` timeout.\n *\n * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n *\n * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n * for details over the differences between `_.debounce` and `_.throttle`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to debounce.\n * @param {number} [wait=0] The number of milliseconds to delay.\n * @param {Object} [options={}] The options object.\n * @param {boolean} [options.leading=false]\n *  Specify invoking on the leading edge of the timeout.\n * @param {number} [options.maxWait]\n *  The maximum time `func` is allowed to be delayed before it's invoked.\n * @param {boolean} [options.trailing=true]\n *  Specify invoking on the trailing edge of the timeout.\n * @returns {Function} Returns the new debounced function.\n * @example\n *\n * // Avoid costly calculations while the window size is in flux.\n * jQuery(window).on('resize', _.debounce(calculateLayout, 150));\n *\n * // Invoke `sendMail` when clicked, debouncing subsequent calls.\n * jQuery(element).on('click', _.debounce(sendMail, 300, {\n *   'leading': true,\n *   'trailing': false\n * }));\n *\n * // Ensure `batchLog` is invoked once after 1 second of debounced calls.\n * var debounced = _.debounce(batchLog, 250, { 'maxWait': 1000 });\n * var source = new EventSource('/stream');\n * jQuery(source).on('message', debounced);\n *\n * // Cancel the trailing debounced invocation.\n * jQuery(window).on('popstate', debounced.cancel);\n */\nfunction debounce(func, wait, options) {\n  var lastArgs,\n      lastThis,\n      maxWait,\n      result,\n      timerId,\n      lastCallTime,\n      lastInvokeTime = 0,\n      leading = false,\n      maxing = false,\n      trailing = true;\n\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  wait = toNumber(wait) || 0;\n  if (isObject(options)) {\n    leading = !!options.leading;\n    maxing = 'maxWait' in options;\n    maxWait = maxing ? nativeMax(toNumber(options.maxWait) || 0, wait) : maxWait;\n    trailing = 'trailing' in options ? !!options.trailing : trailing;\n  }\n\n  function invokeFunc(time) {\n    var args = lastArgs,\n        thisArg = lastThis;\n\n    lastArgs = lastThis = undefined;\n    lastInvokeTime = time;\n    result = func.apply(thisArg, args);\n    return result;\n  }\n\n  function leadingEdge(time) {\n    // Reset any `maxWait` timer.\n    lastInvokeTime = time;\n    // Start the timer for the trailing edge.\n    timerId = setTimeout(timerExpired, wait);\n    // Invoke the leading edge.\n    return leading ? invokeFunc(time) : result;\n  }\n\n  function remainingWait(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime,\n        timeWaiting = wait - timeSinceLastCall;\n\n    return maxing\n      ? nativeMin(timeWaiting, maxWait - timeSinceLastInvoke)\n      : timeWaiting;\n  }\n\n  function shouldInvoke(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime;\n\n    // Either this is the first call, activity has stopped and we're at the\n    // trailing edge, the system time has gone backwards and we're treating\n    // it as the trailing edge, or we've hit the `maxWait` limit.\n    return (lastCallTime === undefined || (timeSinceLastCall >= wait) ||\n      (timeSinceLastCall < 0) || (maxing && timeSinceLastInvoke >= maxWait));\n  }\n\n  function timerExpired() {\n    var time = now();\n    if (shouldInvoke(time)) {\n      return trailingEdge(time);\n    }\n    // Restart the timer.\n    timerId = setTimeout(timerExpired, remainingWait(time));\n  }\n\n  function trailingEdge(time) {\n    timerId = undefined;\n\n    // Only invoke if we have `lastArgs` which means `func` has been\n    // debounced at least once.\n    if (trailing && lastArgs) {\n      return invokeFunc(time);\n    }\n    lastArgs = lastThis = undefined;\n    return result;\n  }\n\n  function cancel() {\n    if (timerId !== undefined) {\n      clearTimeout(timerId);\n    }\n    lastInvokeTime = 0;\n    lastArgs = lastCallTime = lastThis = timerId = undefined;\n  }\n\n  function flush() {\n    return timerId === undefined ? result : trailingEdge(now());\n  }\n\n  function debounced() {\n    var time = now(),\n        isInvoking = shouldInvoke(time);\n\n    lastArgs = arguments;\n    lastThis = this;\n    lastCallTime = time;\n\n    if (isInvoking) {\n      if (timerId === undefined) {\n        return leadingEdge(lastCallTime);\n      }\n      if (maxing) {\n        // Handle invocations in a tight loop.\n        clearTimeout(timerId);\n        timerId = setTimeout(timerExpired, wait);\n        return invokeFunc(lastCallTime);\n      }\n    }\n    if (timerId === undefined) {\n      timerId = setTimeout(timerExpired, wait);\n    }\n    return result;\n  }\n  debounced.cancel = cancel;\n  debounced.flush = flush;\n  return debounced;\n}\n\nmodule.exports = debounce;\n","/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return value != null && (type == 'object' || type == 'function');\n}\n\nmodule.exports = isObject;\n","/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return value != null && typeof value == 'object';\n}\n\nmodule.exports = isObjectLike;\n","var baseGetTag = require('./_baseGetTag'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar symbolTag = '[object Symbol]';\n\n/**\n * Checks if `value` is classified as a `Symbol` primitive or object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n * @example\n *\n * _.isSymbol(Symbol.iterator);\n * // => true\n *\n * _.isSymbol('abc');\n * // => false\n */\nfunction isSymbol(value) {\n  return typeof value == 'symbol' ||\n    (isObjectLike(value) && baseGetTag(value) == symbolTag);\n}\n\nmodule.exports = isSymbol;\n","var root = require('./_root');\n\n/**\n * Gets the timestamp of the number of milliseconds that have elapsed since\n * the Unix epoch (1 January 1970 00:00:00 UTC).\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Date\n * @returns {number} Returns the timestamp.\n * @example\n *\n * _.defer(function(stamp) {\n *   console.log(_.now() - stamp);\n * }, _.now());\n * // => Logs the number of milliseconds it took for the deferred invocation.\n */\nvar now = function() {\n  return root.Date.now();\n};\n\nmodule.exports = now;\n","var debounce = require('./debounce'),\n    isObject = require('./isObject');\n\n/** Error message constants. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/**\n * Creates a throttled function that only invokes `func` at most once per\n * every `wait` milliseconds. The throttled function comes with a `cancel`\n * method to cancel delayed `func` invocations and a `flush` method to\n * immediately invoke them. Provide `options` to indicate whether `func`\n * should be invoked on the leading and/or trailing edge of the `wait`\n * timeout. The `func` is invoked with the last arguments provided to the\n * throttled function. Subsequent calls to the throttled function return the\n * result of the last `func` invocation.\n *\n * **Note:** If `leading` and `trailing` options are `true`, `func` is\n * invoked on the trailing edge of the timeout only if the throttled function\n * is invoked more than once during the `wait` timeout.\n *\n * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n *\n * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n * for details over the differences between `_.throttle` and `_.debounce`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to throttle.\n * @param {number} [wait=0] The number of milliseconds to throttle invocations to.\n * @param {Object} [options={}] The options object.\n * @param {boolean} [options.leading=true]\n *  Specify invoking on the leading edge of the timeout.\n * @param {boolean} [options.trailing=true]\n *  Specify invoking on the trailing edge of the timeout.\n * @returns {Function} Returns the new throttled function.\n * @example\n *\n * // Avoid excessively updating the position while scrolling.\n * jQuery(window).on('scroll', _.throttle(updatePosition, 100));\n *\n * // Invoke `renewToken` when the click event is fired, but not more than once every 5 minutes.\n * var throttled = _.throttle(renewToken, 300000, { 'trailing': false });\n * jQuery(element).on('click', throttled);\n *\n * // Cancel the trailing throttled invocation.\n * jQuery(window).on('popstate', throttled.cancel);\n */\nfunction throttle(func, wait, options) {\n  var leading = true,\n      trailing = true;\n\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  if (isObject(options)) {\n    leading = 'leading' in options ? !!options.leading : leading;\n    trailing = 'trailing' in options ? !!options.trailing : trailing;\n  }\n  return debounce(func, wait, {\n    'leading': leading,\n    'maxWait': wait,\n    'trailing': trailing\n  });\n}\n\nmodule.exports = throttle;\n","var isObject = require('./isObject'),\n    isSymbol = require('./isSymbol');\n\n/** Used as references for various `Number` constants. */\nvar NAN = 0 / 0;\n\n/** Used to match leading and trailing whitespace. */\nvar reTrim = /^\\s+|\\s+$/g;\n\n/** Used to detect bad signed hexadecimal string values. */\nvar reIsBadHex = /^[-+]0x[0-9a-f]+$/i;\n\n/** Used to detect binary string values. */\nvar reIsBinary = /^0b[01]+$/i;\n\n/** Used to detect octal string values. */\nvar reIsOctal = /^0o[0-7]+$/i;\n\n/** Built-in method references without a dependency on `root`. */\nvar freeParseInt = parseInt;\n\n/**\n * Converts `value` to a number.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to process.\n * @returns {number} Returns the number.\n * @example\n *\n * _.toNumber(3.2);\n * // => 3.2\n *\n * _.toNumber(Number.MIN_VALUE);\n * // => 5e-324\n *\n * _.toNumber(Infinity);\n * // => Infinity\n *\n * _.toNumber('3.2');\n * // => 3.2\n */\nfunction toNumber(value) {\n  if (typeof value == 'number') {\n    return value;\n  }\n  if (isSymbol(value)) {\n    return NAN;\n  }\n  if (isObject(value)) {\n    var other = typeof value.valueOf == 'function' ? value.valueOf() : value;\n    value = isObject(other) ? (other + '') : other;\n  }\n  if (typeof value != 'string') {\n    return value === 0 ? value : +value;\n  }\n  value = value.replace(reTrim, '');\n  var isBinary = reIsBinary.test(value);\n  return (isBinary || reIsOctal.test(value))\n    ? freeParseInt(value.slice(2), isBinary ? 2 : 8)\n    : (reIsBadHex.test(value) ? NAN : +value);\n}\n\nmodule.exports = toNumber;\n","/*\nobject-assign\n(c) Sindre Sorhus\n@license MIT\n*/\n\n'use strict';\n/* eslint-disable no-unused-vars */\nvar getOwnPropertySymbols = Object.getOwnPropertySymbols;\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\nvar propIsEnumerable = Object.prototype.propertyIsEnumerable;\n\nfunction toObject(val) {\n\tif (val === null || val === undefined) {\n\t\tthrow new TypeError('Object.assign cannot be called with null or undefined');\n\t}\n\n\treturn Object(val);\n}\n\nfunction shouldUseNative() {\n\ttry {\n\t\tif (!Object.assign) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// Detect buggy property enumeration order in older V8 versions.\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=4118\n\t\tvar test1 = new String('abc');  // eslint-disable-line no-new-wrappers\n\t\ttest1[5] = 'de';\n\t\tif (Object.getOwnPropertyNames(test1)[0] === '5') {\n\t\t\treturn false;\n\t\t}\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\tvar test2 = {};\n\t\tfor (var i = 0; i < 10; i++) {\n\t\t\ttest2['_' + String.fromCharCode(i)] = i;\n\t\t}\n\t\tvar order2 = Object.getOwnPropertyNames(test2).map(function (n) {\n\t\t\treturn test2[n];\n\t\t});\n\t\tif (order2.join('') !== '0123456789') {\n\t\t\treturn false;\n\t\t}\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\tvar test3 = {};\n\t\t'abcdefghijklmnopqrst'.split('').forEach(function (letter) {\n\t\t\ttest3[letter] = letter;\n\t\t});\n\t\tif (Object.keys(Object.assign({}, test3)).join('') !==\n\t\t\t\t'abcdefghijklmnopqrst') {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t} catch (err) {\n\t\t// We don't expect any of the above to throw, but better to be safe.\n\t\treturn false;\n\t}\n}\n\nmodule.exports = shouldUseNative() ? Object.assign : function (target, source) {\n\tvar from;\n\tvar to = toObject(target);\n\tvar symbols;\n\n\tfor (var s = 1; s < arguments.length; s++) {\n\t\tfrom = Object(arguments[s]);\n\n\t\tfor (var key in from) {\n\t\t\tif (hasOwnProperty.call(from, key)) {\n\t\t\t\tto[key] = from[key];\n\t\t\t}\n\t\t}\n\n\t\tif (getOwnPropertySymbols) {\n\t\t\tsymbols = getOwnPropertySymbols(from);\n\t\t\tfor (var i = 0; i < symbols.length; i++) {\n\t\t\t\tif (propIsEnumerable.call(from, symbols[i])) {\n\t\t\t\t\tto[symbols[i]] = from[symbols[i]];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn to;\n};\n","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n","/** @license React vundefined\n * use-subscription.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n'use strict';var e=require(\"object-assign\"),g=require(\"react\");\nexports.useSubscription=function(a){var c=a.getCurrentValue,d=a.subscribe,b=g.useState(function(){return{getCurrentValue:c,subscribe:d,value:c()}});a=b[0];var f=b[1];b=a.value;if(a.getCurrentValue!==c||a.subscribe!==d)b=c(),f({getCurrentValue:c,subscribe:d,value:b});g.useDebugValue(b);g.useEffect(function(){function b(){if(!a){var b=c();f(function(a){return a.getCurrentValue!==c||a.subscribe!==d||a.value===b?a:e({},a,{value:b})})}}var a=!1,h=d(b);b();return function(){a=!0;h()}},[c,d]);return b};\n","'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('./cjs/use-subscription.production.min.js');\n} else {\n  module.exports = require('./cjs/use-subscription.development.js');\n}\n","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n","module.exports = function(module) {\n\tif (!module.webpackPolyfill) {\n\t\tmodule.deprecate = function() {};\n\t\tmodule.paths = [];\n\t\t// module.parent = undefined by default\n\t\tif (!module.children) module.children = [];\n\t\tObject.defineProperty(module, \"loaded\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.l;\n\t\t\t}\n\t\t});\n\t\tObject.defineProperty(module, \"id\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.i;\n\t\t\t}\n\t\t});\n\t\tmodule.webpackPolyfill = 1;\n\t}\n\treturn module;\n};\n","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar WebRtcDataChannel = /** @class */ (function () {\n    function WebRtcDataChannel(_a) {\n        var _b = _a === void 0 ? {} : _a, connection = _b.connection, wrtc = _b.wrtc;\n        var _this = this;\n        this.candidates = [];\n        this.alisteners = {};\n        this.eventsListeners = {};\n        this.dataChannel = null;\n        this.messageNonce = 0;\n        this.on = function (event, subscriber) {\n            return Array.isArray(_this.eventsListeners[event])\n                ? _this.eventsListeners[event].push(subscriber)\n                : _this.eventsListeners[event] = [subscriber];\n        };\n        this.emit = function (event, data) {\n            return Array.isArray(_this.eventsListeners[event]) &&\n                _this.eventsListeners[event].forEach(function (fn) { return fn(data); });\n        };\n        this.getCandidates = function (i) {\n            if (i === void 0) { i = 0; }\n            return __awaiter(_this, void 0, void 0, function () {\n                return __generator(this, function (_a) {\n                    switch (_a.label) {\n                        case 0:\n                            if (i >= 20)\n                                return [2 /*return*/, Promise.reject('No connection.')];\n                            if (!(this.candidates.length > 0)) return [3 /*break*/, 1];\n                            return [2 /*return*/, Promise.resolve(JSON.stringify(this.candidates))];\n                        case 1: return [4 /*yield*/, new Promise(function (resolve) { return setTimeout(resolve, 100); })];\n                        case 2:\n                            _a.sent();\n                            return [4 /*yield*/, this.getCandidates(++i)];\n                        case 3: return [2 /*return*/, _a.sent()];\n                    }\n                });\n            });\n        };\n        this.createOffer = function () { return __awaiter(_this, void 0, void 0, function () {\n            var offer;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.rpc.createOffer()];\n                    case 1:\n                        offer = _a.sent();\n                        return [4 /*yield*/, this.rpc.setLocalDescription(offer)];\n                    case 2:\n                        _a.sent();\n                        return [2 /*return*/, offer.sdp];\n                }\n            });\n        }); };\n        this.createChannel = function (name) {\n            if (name === void 0) { name = 'chat'; }\n            var channel = _this.rpc.createDataChannel(name);\n            channel.onopen = function () { return _this.emit('open'); };\n            channel.onclose = function () { return _this.emit('close'); };\n            channel.onerror = function (error) { return _this.emit('error', error); };\n            channel.onmessage = function (_a) {\n                var data = _a.data;\n                try {\n                    var msg = JSON.parse(data);\n                    var nonce = msg.nonce, message = msg.message;\n                    _this.emit('message', message);\n                    if (_this.alisteners[nonce]) {\n                        _this.alisteners[nonce](message);\n                        delete _this.alisteners[nonce];\n                    }\n                }\n                catch (err) {\n                    console.error('Message couldn\\'t be parsed. It has not a valid format.');\n                }\n            };\n            return channel;\n        };\n        this.setOffer = function (offer) { return __awaiter(_this, void 0, void 0, function () {\n            var answer;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.rpc.setRemoteDescription({ type: 'offer', sdp: offer })];\n                    case 1:\n                        _a.sent();\n                        return [4 /*yield*/, this.rpc.createAnswer()];\n                    case 2:\n                        answer = _a.sent();\n                        return [4 /*yield*/, this.rpc.setLocalDescription(answer)];\n                    case 3:\n                        _a.sent();\n                        return [2 /*return*/, answer.sdp];\n                }\n            });\n        }); };\n        this.setRemote = function (answer) { return __awaiter(_this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.rpc.setRemoteDescription({ type: 'answer', sdp: answer })];\n                    case 1:\n                        _a.sent();\n                        return [2 /*return*/, this.rpc.currentRemoteDescription];\n                }\n            });\n        }); };\n        this.addCandidates = function (candidates) { return __awaiter(_this, void 0, void 0, function () {\n            var values, promises;\n            var _this = this;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        values = JSON.parse(candidates);\n                        promises = values.map(function (candidate) {\n                            return _this.rpc.addIceCandidate(new _this.RTCIceCandidate(candidate));\n                        });\n                        return [4 /*yield*/, Promise.all(promises)];\n                    case 1:\n                        _a.sent();\n                        return [2 /*return*/, this.candidates];\n                }\n            });\n        }); };\n        this.channelOpened = function () { return __awaiter(_this, void 0, void 0, function () {\n            var _this = this;\n            return __generator(this, function (_a) {\n                return [2 /*return*/, new Promise(function (resolve) { return _this.dataChannel ? resolve() : _this.on('datachannel', resolve); })];\n            });\n        }); };\n        this.send = function (message) {\n            return new Promise(function (resolve, reject) {\n                if (!_this.dataChannel)\n                    return reject(Error('dataChannel doesn\\'t opened'));\n                _this.dataChannel.send(JSON.stringify({\n                    nonce: ++_this.messageNonce,\n                    message: message\n                }));\n                _this.alisteners[_this.messageNonce] = resolve;\n            });\n        };\n        this.initiateConnect = function () { return __awaiter(_this, void 0, void 0, function () {\n            var offer, candidates, request;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        this.createChannel();\n                        return [4 /*yield*/, this.createOffer()];\n                    case 1:\n                        offer = _a.sent();\n                        return [4 /*yield*/, this.getCandidates()];\n                    case 2:\n                        candidates = _a.sent();\n                        request = JSON.stringify([encodeURI(offer), candidates]);\n                        return [2 /*return*/, request];\n                }\n            });\n        }); };\n        this.setAnswer = function (response) { return __awaiter(_this, void 0, void 0, function () {\n            var _a, encodedAnswer, decodedCandidates, err_1;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        _b.trys.push([0, 4, , 5]);\n                        _a = JSON.parse(response), encodedAnswer = _a[0], decodedCandidates = _a[1];\n                        return [4 /*yield*/, this.setRemote(decodeURI(encodedAnswer))];\n                    case 1:\n                        _b.sent();\n                        return [4 /*yield*/, this.addCandidates(decodedCandidates)];\n                    case 2:\n                        _b.sent();\n                        return [4 /*yield*/, this.channelOpened()];\n                    case 3:\n                        _b.sent();\n                        return [3 /*break*/, 5];\n                    case 4:\n                        err_1 = _b.sent();\n                        return [2 /*return*/, err_1];\n                    case 5: return [2 /*return*/];\n                }\n            });\n        }); };\n        this.initByRequest = function (request) { return __awaiter(_this, void 0, void 0, function () {\n            var _a, encodedOffer, decodedCandidates, answer, candidates, response;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        this.createChannel();\n                        _a = JSON.parse(request), encodedOffer = _a[0], decodedCandidates = _a[1];\n                        return [4 /*yield*/, this.setOffer(decodeURI(encodedOffer))];\n                    case 1:\n                        answer = _b.sent();\n                        return [4 /*yield*/, this.addCandidates(decodedCandidates)];\n                    case 2:\n                        _b.sent();\n                        return [4 /*yield*/, this.getCandidates()];\n                    case 3:\n                        candidates = _b.sent();\n                        response = JSON.stringify([encodeURI(answer), candidates]);\n                        return [2 /*return*/, response];\n                }\n            });\n        }); };\n        var RTC = wrtc ? wrtc.RTCPeerConnection : RTCPeerConnection;\n        this.RTCIceCandidate = wrtc ? wrtc.RTCIceCandidate : RTCIceCandidate;\n        this.rpc = new RTC(connection);\n        this.rpc.onicecandidate = function (_a) {\n            var candidate = _a.candidate;\n            return candidate && (_this.candidates.push(candidate),\n                _this.emit('icecandidate', candidate));\n        };\n        this.rpc.ondatachannel = function (event) {\n            _this.dataChannel = event.channel;\n            _this.emit('datachannel', event);\n        };\n        this.rpc.onconnectionstatechange = function (event) {\n            return _this.emit('connectionstatechange', event);\n        };\n    }\n    return WebRtcDataChannel;\n}());\nexports.default = WebRtcDataChannel;\n//# sourceMappingURL=index.js.map","/*!\n * isobject <https://github.com/jonschlinkert/isobject>\n *\n * Copyright (c) 2014-2017, Jon Schlinkert.\n * Released under the MIT License.\n */\n\nfunction isObject(val) {\n  return val != null && typeof val === 'object' && Array.isArray(val) === false;\n}\n\n/*!\n * is-plain-object <https://github.com/jonschlinkert/is-plain-object>\n *\n * Copyright (c) 2014-2017, Jon Schlinkert.\n * Released under the MIT License.\n */\n\nfunction isObjectObject(o) {\n  return isObject(o) === true\n    && Object.prototype.toString.call(o) === '[object Object]';\n}\n\nfunction isPlainObject(o) {\n  var ctor,prot;\n\n  if (isObjectObject(o) === false) return false;\n\n  // If has modified constructor\n  ctor = o.constructor;\n  if (typeof ctor !== 'function') return false;\n\n  // If has modified prototype\n  prot = ctor.prototype;\n  if (isObjectObject(prot) === false) return false;\n\n  // If constructor does not have an Object-specific method\n  if (prot.hasOwnProperty('isPrototypeOf') === false) {\n    return false;\n  }\n\n  // Most likely a plain Object\n  return true;\n}\n\nexport default isPlainObject;\n","import isPlainObject from 'is-plain-object';\nimport { reverse } from 'esrever';\nimport { produce, createDraft, finishDraft, isDraft } from 'immer';\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}\n\nfunction _objectWithoutProperties(source, excluded) {\n  if (source == null) return {};\n  var target = _objectWithoutPropertiesLoose(source, excluded);\n  var key, i;\n\n  if (Object.getOwnPropertySymbols) {\n    var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n\n    for (i = 0; i < sourceSymbolKeys.length; i++) {\n      key = sourceSymbolKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n      target[key] = source[key];\n    }\n  }\n\n  return target;\n}\n\nvar DIRTY_PATHS = new WeakMap();\nvar FLUSHING = new WeakMap();\nvar NORMALIZING = new WeakMap();\nvar PATH_REFS = new WeakMap();\nvar POINT_REFS = new WeakMap();\nvar RANGE_REFS = new WeakMap();\n\n/**\r\n * Constants for string distance checking.\r\n */\nvar SPACE = /\\s/;\nvar PUNCTUATION = /[\\u0021-\\u0023\\u0025-\\u002A\\u002C-\\u002F\\u003A\\u003B\\u003F\\u0040\\u005B-\\u005D\\u005F\\u007B\\u007D\\u00A1\\u00A7\\u00AB\\u00B6\\u00B7\\u00BB\\u00BF\\u037E\\u0387\\u055A-\\u055F\\u0589\\u058A\\u05BE\\u05C0\\u05C3\\u05C6\\u05F3\\u05F4\\u0609\\u060A\\u060C\\u060D\\u061B\\u061E\\u061F\\u066A-\\u066D\\u06D4\\u0700-\\u070D\\u07F7-\\u07F9\\u0830-\\u083E\\u085E\\u0964\\u0965\\u0970\\u0AF0\\u0DF4\\u0E4F\\u0E5A\\u0E5B\\u0F04-\\u0F12\\u0F14\\u0F3A-\\u0F3D\\u0F85\\u0FD0-\\u0FD4\\u0FD9\\u0FDA\\u104A-\\u104F\\u10FB\\u1360-\\u1368\\u1400\\u166D\\u166E\\u169B\\u169C\\u16EB-\\u16ED\\u1735\\u1736\\u17D4-\\u17D6\\u17D8-\\u17DA\\u1800-\\u180A\\u1944\\u1945\\u1A1E\\u1A1F\\u1AA0-\\u1AA6\\u1AA8-\\u1AAD\\u1B5A-\\u1B60\\u1BFC-\\u1BFF\\u1C3B-\\u1C3F\\u1C7E\\u1C7F\\u1CC0-\\u1CC7\\u1CD3\\u2010-\\u2027\\u2030-\\u2043\\u2045-\\u2051\\u2053-\\u205E\\u207D\\u207E\\u208D\\u208E\\u2329\\u232A\\u2768-\\u2775\\u27C5\\u27C6\\u27E6-\\u27EF\\u2983-\\u2998\\u29D8-\\u29DB\\u29FC\\u29FD\\u2CF9-\\u2CFC\\u2CFE\\u2CFF\\u2D70\\u2E00-\\u2E2E\\u2E30-\\u2E3B\\u3001-\\u3003\\u3008-\\u3011\\u3014-\\u301F\\u3030\\u303D\\u30A0\\u30FB\\uA4FE\\uA4FF\\uA60D-\\uA60F\\uA673\\uA67E\\uA6F2-\\uA6F7\\uA874-\\uA877\\uA8CE\\uA8CF\\uA8F8-\\uA8FA\\uA92E\\uA92F\\uA95F\\uA9C1-\\uA9CD\\uA9DE\\uA9DF\\uAA5C-\\uAA5F\\uAADE\\uAADF\\uAAF0\\uAAF1\\uABEB\\uFD3E\\uFD3F\\uFE10-\\uFE19\\uFE30-\\uFE52\\uFE54-\\uFE61\\uFE63\\uFE68\\uFE6A\\uFE6B\\uFF01-\\uFF03\\uFF05-\\uFF0A\\uFF0C-\\uFF0F\\uFF1A\\uFF1B\\uFF1F\\uFF20\\uFF3B-\\uFF3D\\uFF3F\\uFF5B\\uFF5D\\uFF5F-\\uFF65]/;\nvar CHAMELEON = /['\\u2018\\u2019]/;\nvar SURROGATE_START = 0xd800;\nvar SURROGATE_END = 0xdfff;\nvar ZERO_WIDTH_JOINER = 0x200d;\n/**\r\n * Get the distance to the end of the first character in a string of text.\r\n */\n\nvar getCharacterDistance = text => {\n  var offset = 0; // prev types:\n  // SURR: surrogate pair\n  // MOD: modifier (technically also surrogate pair)\n  // ZWJ: zero width joiner\n  // VAR: variation selector\n  // BMP: sequenceable character from basic multilingual plane\n\n  var prev = null;\n  var charCode = text.charCodeAt(0);\n\n  while (charCode) {\n    if (isSurrogate(charCode)) {\n      var modifier = isModifier(charCode, text, offset); // Early returns are the heart of this function, where we decide if previous and current\n      // codepoints should form a single character (in terms of how many of them should selection\n      // jump over).\n\n      if (prev === 'SURR' || prev === 'BMP') {\n        break;\n      }\n\n      offset += 2;\n      prev = modifier ? 'MOD' : 'SURR';\n      charCode = text.charCodeAt(offset); // Absolutely fine to `continue` without any checks because if `charCode` is NaN (which\n      // is the case when out of `text` range), next `while` loop won\"t execute and we\"re done.\n\n      continue;\n    }\n\n    if (charCode === ZERO_WIDTH_JOINER) {\n      offset += 1;\n      prev = 'ZWJ';\n      charCode = text.charCodeAt(offset);\n      continue;\n    }\n\n    if (isBMPEmoji(charCode)) {\n      if (prev && prev !== 'ZWJ' && prev !== 'VAR') {\n        break;\n      }\n\n      offset += 1;\n      prev = 'BMP';\n      charCode = text.charCodeAt(offset);\n      continue;\n    }\n\n    if (isVariationSelector(charCode)) {\n      if (prev && prev !== 'ZWJ') {\n        break;\n      }\n\n      offset += 1;\n      prev = 'VAR';\n      charCode = text.charCodeAt(offset);\n      continue;\n    } // Modifier 'groups up' with what ever character is before that (even whitespace), need to\n    // look ahead.\n\n\n    if (prev === 'MOD') {\n      offset += 1;\n      break;\n    } // If while loop ever gets here, we're done (e.g latin chars).\n\n\n    break;\n  }\n\n  return offset || 1;\n};\n/**\r\n * Get the distance to the end of the first word in a string of text.\r\n */\n\nvar getWordDistance = text => {\n  var length = 0;\n  var i = 0;\n  var started = false;\n  var char;\n\n  while (char = text.charAt(i)) {\n    var l = getCharacterDistance(char);\n    char = text.slice(i, i + l);\n    var rest = text.slice(i + l);\n\n    if (isWordCharacter(char, rest)) {\n      started = true;\n      length += l;\n    } else if (!started) {\n      length += l;\n    } else {\n      break;\n    }\n\n    i += l;\n  }\n\n  return length;\n};\n/**\r\n * Check if a character is a word character. The `remaining` argument is used\r\n * because sometimes you must read subsequent characters to truly determine it.\r\n */\n\nvar isWordCharacter = (char, remaining) => {\n  if (SPACE.test(char)) {\n    return false;\n  } // Chameleons count as word characters as long as they're in a word, so\n  // recurse to see if the next one is a word character or not.\n\n\n  if (CHAMELEON.test(char)) {\n    var next = remaining.charAt(0);\n    var length = getCharacterDistance(next);\n    next = remaining.slice(0, length);\n    var rest = remaining.slice(length);\n\n    if (isWordCharacter(next, rest)) {\n      return true;\n    }\n  }\n\n  if (PUNCTUATION.test(char)) {\n    return false;\n  }\n\n  return true;\n};\n/**\r\n * Determines if `code` is a surrogate\r\n */\n\n\nvar isSurrogate = code => SURROGATE_START <= code && code <= SURROGATE_END;\n/**\r\n * Does `code` form Modifier with next one.\r\n *\r\n * https://emojipedia.org/modifiers/\r\n */\n\n\nvar isModifier = (code, text, offset) => {\n  if (code === 0xd83c) {\n    var next = text.charCodeAt(offset + 1);\n    return next <= 0xdfff && next >= 0xdffb;\n  }\n\n  return false;\n};\n/**\r\n * Is `code` a Variation Selector.\r\n *\r\n * https://codepoints.net/variation_selectors\r\n */\n\n\nvar isVariationSelector = code => {\n  return code <= 0xfe0f && code >= 0xfe00;\n};\n/**\r\n * Is `code` one of the BMP codes used in emoji sequences.\r\n *\r\n * https://emojipedia.org/emoji-zwj-sequences/\r\n */\n\n\nvar isBMPEmoji = code => {\n  // This requires tiny bit of maintanance, better ideas?\n  // Fortunately it only happens if new Unicode Standard\n  // is released. Fails gracefully if upkeep lags behind,\n  // same way Slate previously behaved with all emojis.\n  return code === 0x2764 || // heart ()\n  code === 0x2642 || // male ()\n  code === 0x2640 || // female ()\n  code === 0x2620 || // scull ()\n  code === 0x2695 || // medical ()\n  code === 0x2708 || // plane ()\n  code === 0x25ef // large circle ()\n  ;\n};\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\nvar Editor = {\n  /**\r\n   * Get the ancestor above a location in the document.\r\n   */\n  above(editor) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var {\n      voids = false,\n      mode = 'lowest',\n      at = editor.selection,\n      match\n    } = options;\n\n    if (!at) {\n      return;\n    }\n\n    var path = Editor.path(editor, at);\n    var reverse = mode === 'lowest';\n\n    for (var [n, p] of Editor.levels(editor, {\n      at: path,\n      voids,\n      match,\n      reverse\n    })) {\n      if (!Text.isText(n) && !Path.equals(path, p)) {\n        return [n, p];\n      }\n    }\n  },\n\n  /**\r\n   * Add a custom property to the leaf text nodes in the current selection.\r\n   *\r\n   * If the selection is currently collapsed, the marks will be added to the\r\n   * `editor.marks` property instead, and applied when text is inserted next.\r\n   */\n  addMark(editor, key, value) {\n    editor.addMark(key, value);\n  },\n\n  /**\r\n   * Get the point after a location.\r\n   */\n  after(editor, at) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    var anchor = Editor.point(editor, at, {\n      edge: 'end'\n    });\n    var focus = Editor.end(editor, []);\n    var range = {\n      anchor,\n      focus\n    };\n    var {\n      distance = 1\n    } = options;\n    var d = 0;\n    var target;\n\n    for (var p of Editor.positions(editor, _objectSpread({}, options, {\n      at: range\n    }))) {\n      if (d > distance) {\n        break;\n      }\n\n      if (d !== 0) {\n        target = p;\n      }\n\n      d++;\n    }\n\n    return target;\n  },\n\n  /**\r\n   * Get the point before a location.\r\n   */\n  before(editor, at) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    var anchor = Editor.start(editor, []);\n    var focus = Editor.point(editor, at, {\n      edge: 'start'\n    });\n    var range = {\n      anchor,\n      focus\n    };\n    var {\n      distance = 1\n    } = options;\n    var d = 0;\n    var target;\n\n    for (var p of Editor.positions(editor, _objectSpread({}, options, {\n      at: range,\n      reverse: true\n    }))) {\n      if (d > distance) {\n        break;\n      }\n\n      if (d !== 0) {\n        target = p;\n      }\n\n      d++;\n    }\n\n    return target;\n  },\n\n  /**\r\n   * Delete content in the editor backward from the current selection.\r\n   */\n  deleteBackward(editor) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var {\n      unit = 'character'\n    } = options;\n    editor.deleteBackward(unit);\n  },\n\n  /**\r\n   * Delete content in the editor forward from the current selection.\r\n   */\n  deleteForward(editor) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var {\n      unit = 'character'\n    } = options;\n    editor.deleteForward(unit);\n  },\n\n  /**\r\n   * Delete the content in the current selection.\r\n   */\n  deleteFragment(editor) {\n    editor.deleteFragment();\n  },\n\n  /**\r\n   * Get the start and end points of a location.\r\n   */\n  edges(editor, at) {\n    return [Editor.start(editor, at), Editor.end(editor, at)];\n  },\n\n  /**\r\n   * Get the end point of a location.\r\n   */\n  end(editor, at) {\n    return Editor.point(editor, at, {\n      edge: 'end'\n    });\n  },\n\n  /**\r\n   * Get the first node at a location.\r\n   */\n  first(editor, at) {\n    var path = Editor.path(editor, at, {\n      edge: 'start'\n    });\n    return Editor.node(editor, path);\n  },\n\n  /**\r\n   * Get the fragment at a location.\r\n   */\n  fragment(editor, at) {\n    var range = Editor.range(editor, at);\n    var fragment = Node.fragment(editor, range);\n    return fragment;\n  },\n\n  /**\r\n   * Check if a node has block children.\r\n   */\n  hasBlocks(editor, element) {\n    return element.children.some(n => Editor.isBlock(editor, n));\n  },\n\n  /**\r\n   * Check if a node has inline and text children.\r\n   */\n  hasInlines(editor, element) {\n    return element.children.some(n => Text.isText(n) || Editor.isInline(editor, n));\n  },\n\n  /**\r\n   * Check if a node has text children.\r\n   */\n  hasTexts(editor, element) {\n    return element.children.every(n => Text.isText(n));\n  },\n\n  /**\r\n   * Insert a block break at the current selection.\r\n   *\r\n   * If the selection is currently expanded, it will be deleted first.\r\n   */\n  insertBreak(editor) {\n    editor.insertBreak();\n  },\n\n  /**\r\n   * Insert a fragment at the current selection.\r\n   *\r\n   * If the selection is currently expanded, it will be deleted first.\r\n   */\n  insertFragment(editor, fragment) {\n    editor.insertFragment(fragment);\n  },\n\n  /**\r\n   * Insert a node at the current selection.\r\n   *\r\n   * If the selection is currently expanded, it will be deleted first.\r\n   */\n  insertNode(editor, node) {\n    editor.insertNode(node);\n  },\n\n  /**\r\n   * Insert text at the current selection.\r\n   *\r\n   * If the selection is currently expanded, it will be deleted first.\r\n   */\n  insertText(editor, text) {\n    editor.insertText(text);\n  },\n\n  /**\r\n   * Check if a value is a block `Element` object.\r\n   */\n  isBlock(editor, value) {\n    return Element.isElement(value) && !editor.isInline(value);\n  },\n\n  /**\r\n   * Check if a value is an `Editor` object.\r\n   */\n  isEditor(value) {\n    return isPlainObject(value) && typeof value.addMark === 'function' && typeof value.apply === 'function' && typeof value.deleteBackward === 'function' && typeof value.deleteForward === 'function' && typeof value.deleteFragment === 'function' && typeof value.insertBreak === 'function' && typeof value.insertFragment === 'function' && typeof value.insertNode === 'function' && typeof value.insertText === 'function' && typeof value.isInline === 'function' && typeof value.isVoid === 'function' && typeof value.normalizeNode === 'function' && typeof value.onChange === 'function' && typeof value.removeMark === 'function' && (value.marks === null || isPlainObject(value.marks)) && (value.selection === null || Range.isRange(value.selection)) && Node.isNodeList(value.children) && Operation.isOperationList(value.operations);\n  },\n\n  /**\r\n   * Check if a point is the end point of a location.\r\n   */\n  isEnd(editor, point, at) {\n    var end = Editor.end(editor, at);\n    return Point.equals(point, end);\n  },\n\n  /**\r\n   * Check if a point is an edge of a location.\r\n   */\n  isEdge(editor, point, at) {\n    return Editor.isStart(editor, point, at) || Editor.isEnd(editor, point, at);\n  },\n\n  /**\r\n   * Check if an element is empty, accounting for void nodes.\r\n   */\n  isEmpty(editor, element) {\n    var {\n      children\n    } = element;\n    var [first] = children;\n    return children.length === 0 || children.length === 1 && Text.isText(first) && first.text === '' && !editor.isVoid(element);\n  },\n\n  /**\r\n   * Check if a value is an inline `Element` object.\r\n   */\n  isInline(editor, value) {\n    return Element.isElement(value) && editor.isInline(value);\n  },\n\n  /**\r\n   * Check if the editor is currently normalizing after each operation.\r\n   */\n  isNormalizing(editor) {\n    var isNormalizing = NORMALIZING.get(editor);\n    return isNormalizing === undefined ? true : isNormalizing;\n  },\n\n  /**\r\n   * Check if a point is the start point of a location.\r\n   */\n  isStart(editor, point, at) {\n    // PERF: If the offset isn't `0` we know it's not the start.\n    if (point.offset !== 0) {\n      return false;\n    }\n\n    var start = Editor.start(editor, at);\n    return Point.equals(point, start);\n  },\n\n  /**\r\n   * Check if a value is a void `Element` object.\r\n   */\n  isVoid(editor, value) {\n    return Element.isElement(value) && editor.isVoid(value);\n  },\n\n  /**\r\n   * Get the last node at a location.\r\n   */\n  last(editor, at) {\n    var path = Editor.path(editor, at, {\n      edge: 'end'\n    });\n    return Editor.node(editor, path);\n  },\n\n  /**\r\n   * Get the leaf text node at a location.\r\n   */\n  leaf(editor, at) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    var path = Editor.path(editor, at, options);\n    var node = Node.leaf(editor, path);\n    return [node, path];\n  },\n\n  /**\r\n   * Iterate through all of the levels at a location.\r\n   */\n  *levels(editor) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var {\n      at = editor.selection,\n      reverse = false,\n      voids = false\n    } = options;\n    var {\n      match\n    } = options;\n\n    if (match == null) {\n      match = () => true;\n    }\n\n    if (!at) {\n      return;\n    }\n\n    var levels = [];\n    var path = Editor.path(editor, at);\n\n    for (var [n, p] of Node.levels(editor, path)) {\n      if (!match(n)) {\n        continue;\n      }\n\n      levels.push([n, p]);\n\n      if (!voids && Editor.isVoid(editor, n)) {\n        break;\n      }\n    }\n\n    if (reverse) {\n      levels.reverse();\n    }\n\n    yield* levels;\n  },\n\n  /**\r\n   * Get the marks that would be added to text at the current selection.\r\n   */\n  marks(editor) {\n    var {\n      marks,\n      selection\n    } = editor;\n\n    if (!selection) {\n      return null;\n    }\n\n    if (marks) {\n      return marks;\n    }\n\n    if (Range.isExpanded(selection)) {\n      var [match] = Editor.nodes(editor, {\n        match: Text.isText\n      });\n\n      if (match) {\n        var [_node] = match;\n\n        var _rest = _objectWithoutProperties(_node, [\"text\"]);\n\n        return _rest;\n      } else {\n        return {};\n      }\n    }\n\n    var {\n      anchor\n    } = selection;\n    var {\n      path\n    } = anchor;\n    var [node] = Editor.leaf(editor, path);\n\n    if (anchor.offset === 0) {\n      var prev = Editor.previous(editor, {\n        at: path,\n        match: Text.isText\n      });\n      var block = Editor.above(editor, {\n        match: n => Editor.isBlock(editor, n)\n      });\n\n      if (prev && block) {\n        var [prevNode, prevPath] = prev;\n        var [, blockPath] = block;\n\n        if (Path.isAncestor(blockPath, prevPath)) {\n          node = prevNode;\n        }\n      }\n    }\n\n    var rest = _objectWithoutProperties(node, [\"text\"]);\n\n    return rest;\n  },\n\n  /**\r\n   * Get the matching node in the branch of the document after a location.\r\n   */\n  next(editor) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var {\n      mode = 'lowest',\n      voids = false\n    } = options;\n    var {\n      match,\n      at = editor.selection\n    } = options;\n\n    if (!at) {\n      return;\n    }\n\n    var [, from] = Editor.last(editor, at);\n    var [, to] = Editor.last(editor, []);\n    var span = [from, to];\n\n    if (Path.isPath(at) && at.length === 0) {\n      throw new Error(\"Cannot get the next node from the root node!\");\n    }\n\n    if (match == null) {\n      if (Path.isPath(at)) {\n        var [parent] = Editor.parent(editor, at);\n\n        match = n => parent.children.includes(n);\n      } else {\n        match = () => true;\n      }\n    }\n\n    var [, next] = Editor.nodes(editor, {\n      at: span,\n      match,\n      mode,\n      voids\n    });\n    return next;\n  },\n\n  /**\r\n   * Get the node at a location.\r\n   */\n  node(editor, at) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    var path = Editor.path(editor, at, options);\n    var node = Node.get(editor, path);\n    return [node, path];\n  },\n\n  /**\r\n   * Iterate through all of the nodes in the Editor.\r\n   */\n  *nodes(editor) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var {\n      at = editor.selection,\n      mode = 'all',\n      universal = false,\n      reverse = false,\n      voids = false\n    } = options;\n    var {\n      match\n    } = options;\n\n    if (!match) {\n      match = () => true;\n    }\n\n    if (!at) {\n      return;\n    }\n\n    var from;\n    var to;\n\n    if (Span.isSpan(at)) {\n      from = at[0];\n      to = at[1];\n    } else {\n      var first = Editor.path(editor, at, {\n        edge: 'start'\n      });\n      var last = Editor.path(editor, at, {\n        edge: 'end'\n      });\n      from = reverse ? last : first;\n      to = reverse ? first : last;\n    }\n\n    var nodeEntries = Node.nodes(editor, {\n      reverse,\n      from,\n      to,\n      pass: (_ref) => {\n        var [n] = _ref;\n        return voids ? false : Editor.isVoid(editor, n);\n      }\n    });\n    var matches = [];\n    var hit;\n\n    for (var [node, path] of nodeEntries) {\n      var isLower = hit && Path.compare(path, hit[1]) === 0; // In highest mode any node lower than the last hit is not a match.\n\n      if (mode === 'highest' && isLower) {\n        continue;\n      }\n\n      if (!match(node)) {\n        // If we've arrived at a leaf text node that is not lower than the last\n        // hit, then we've found a branch that doesn't include a match, which\n        // means the match is not universal.\n        if (universal && !isLower && Text.isText(node)) {\n          return;\n        } else {\n          continue;\n        }\n      } // If there's a match and it's lower than the last, update the hit.\n\n\n      if (mode === 'lowest' && isLower) {\n        hit = [node, path];\n        continue;\n      } // In lowest mode we emit the last hit, once it's guaranteed lowest.\n\n\n      var emit = mode === 'lowest' ? hit : [node, path];\n\n      if (emit) {\n        if (universal) {\n          matches.push(emit);\n        } else {\n          yield emit;\n        }\n      }\n\n      hit = [node, path];\n    } // Since lowest is always emitting one behind, catch up at the end.\n\n\n    if (mode === 'lowest' && hit) {\n      if (universal) {\n        matches.push(hit);\n      } else {\n        yield hit;\n      }\n    } // Universal defers to ensure that the match occurs in every branch, so we\n    // yield all of the matches after iterating.\n\n\n    if (universal) {\n      yield* matches;\n    }\n  },\n\n  /**\r\n   * Normalize any dirty objects in the editor.\r\n   */\n  normalize(editor) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var {\n      force = false\n    } = options;\n\n    var getDirtyPaths = editor => {\n      return DIRTY_PATHS.get(editor) || [];\n    };\n\n    if (!Editor.isNormalizing(editor)) {\n      return;\n    }\n\n    if (force) {\n      var allPaths = Array.from(Node.nodes(editor), (_ref2) => {\n        var [, p] = _ref2;\n        return p;\n      });\n      DIRTY_PATHS.set(editor, allPaths);\n    }\n\n    if (getDirtyPaths(editor).length === 0) {\n      return;\n    }\n\n    Editor.withoutNormalizing(editor, () => {\n      var max = getDirtyPaths(editor).length * 42; // HACK: better way?\n\n      var m = 0;\n\n      while (getDirtyPaths(editor).length !== 0) {\n        if (m > max) {\n          throw new Error(\"\\n            Could not completely normalize the editor after \".concat(max, \" iterations! This is usually due to incorrect normalization logic that leaves a node in an invalid state.\\n          \"));\n        }\n\n        var path = getDirtyPaths(editor).pop();\n        var entry = Editor.node(editor, path);\n        editor.normalizeNode(entry);\n        m++;\n      }\n    });\n  },\n\n  /**\r\n   * Get the parent node of a location.\r\n   */\n  parent(editor, at) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    var path = Editor.path(editor, at, options);\n    var parentPath = Path.parent(path);\n    var entry = Editor.node(editor, parentPath);\n    return entry;\n  },\n\n  /**\r\n   * Get the path of a location.\r\n   */\n  path(editor, at) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    var {\n      depth,\n      edge\n    } = options;\n\n    if (Path.isPath(at)) {\n      if (edge === 'start') {\n        var [, firstPath] = Node.first(editor, at);\n        at = firstPath;\n      } else if (edge === 'end') {\n        var [, lastPath] = Node.last(editor, at);\n        at = lastPath;\n      }\n    }\n\n    if (Range.isRange(at)) {\n      if (edge === 'start') {\n        at = Range.start(at);\n      } else if (edge === 'end') {\n        at = Range.end(at);\n      } else {\n        at = Path.common(at.anchor.path, at.focus.path);\n      }\n    }\n\n    if (Point.isPoint(at)) {\n      at = at.path;\n    }\n\n    if (depth != null) {\n      at = at.slice(0, depth);\n    }\n\n    return at;\n  },\n\n  /**\r\n   * Create a mutable ref for a `Path` object, which will stay in sync as new\r\n   * operations are applied to the editor.\r\n   */\n  pathRef(editor, path) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    var {\n      affinity = 'forward'\n    } = options;\n    var ref = {\n      current: path,\n      affinity,\n\n      unref() {\n        var {\n          current\n        } = ref;\n        var pathRefs = Editor.pathRefs(editor);\n        pathRefs.delete(ref);\n        ref.current = null;\n        return current;\n      }\n\n    };\n    var refs = Editor.pathRefs(editor);\n    refs.add(ref);\n    return ref;\n  },\n\n  /**\r\n   * Get the set of currently tracked path refs of the editor.\r\n   */\n  pathRefs(editor) {\n    var refs = PATH_REFS.get(editor);\n\n    if (!refs) {\n      refs = new Set();\n      PATH_REFS.set(editor, refs);\n    }\n\n    return refs;\n  },\n\n  /**\r\n   * Get the start or end point of a location.\r\n   */\n  point(editor, at) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    var {\n      edge = 'start'\n    } = options;\n\n    if (Path.isPath(at)) {\n      var path;\n\n      if (edge === 'end') {\n        var [, lastPath] = Node.last(editor, at);\n        path = lastPath;\n      } else {\n        var [, firstPath] = Node.first(editor, at);\n        path = firstPath;\n      }\n\n      var node = Node.get(editor, path);\n\n      if (!Text.isText(node)) {\n        throw new Error(\"Cannot get the \".concat(edge, \" point in the node at path [\").concat(at, \"] because it has no \").concat(edge, \" text node.\"));\n      }\n\n      return {\n        path,\n        offset: edge === 'end' ? node.text.length : 0\n      };\n    }\n\n    if (Range.isRange(at)) {\n      var [start, end] = Range.edges(at);\n      return edge === 'start' ? start : end;\n    }\n\n    return at;\n  },\n\n  /**\r\n   * Create a mutable ref for a `Point` object, which will stay in sync as new\r\n   * operations are applied to the editor.\r\n   */\n  pointRef(editor, point) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    var {\n      affinity = 'forward'\n    } = options;\n    var ref = {\n      current: point,\n      affinity,\n\n      unref() {\n        var {\n          current\n        } = ref;\n        var pointRefs = Editor.pointRefs(editor);\n        pointRefs.delete(ref);\n        ref.current = null;\n        return current;\n      }\n\n    };\n    var refs = Editor.pointRefs(editor);\n    refs.add(ref);\n    return ref;\n  },\n\n  /**\r\n   * Get the set of currently tracked point refs of the editor.\r\n   */\n  pointRefs(editor) {\n    var refs = POINT_REFS.get(editor);\n\n    if (!refs) {\n      refs = new Set();\n      POINT_REFS.set(editor, refs);\n    }\n\n    return refs;\n  },\n\n  /**\r\n   * Iterate through all of the positions in the document where a `Point` can be\r\n   * placed.\r\n   *\r\n   * By default it will move forward by individual offsets at a time,  but you\r\n   * can pass the `unit: 'character'` option to moved forward one character, word,\r\n   * or line at at time.\r\n   *\r\n   * Note: void nodes are treated as a single point, and iteration will not\r\n   * happen inside their content.\r\n   */\n  *positions(editor) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var {\n      at = editor.selection,\n      unit = 'offset',\n      reverse: reverse$1 = false\n    } = options;\n\n    if (!at) {\n      return;\n    }\n\n    var range = Editor.range(editor, at);\n    var [start, end] = Range.edges(range);\n    var first = reverse$1 ? end : start;\n    var string = '';\n    var available = 0;\n    var offset = 0;\n    var distance = null;\n    var isNewBlock = false;\n\n    var advance = () => {\n      if (distance == null) {\n        if (unit === 'character') {\n          distance = getCharacterDistance(string);\n        } else if (unit === 'word') {\n          distance = getWordDistance(string);\n        } else if (unit === 'line' || unit === 'block') {\n          distance = string.length;\n        } else {\n          distance = 1;\n        }\n\n        string = string.slice(distance);\n      } // Add or substract the offset.\n\n\n      offset = reverse$1 ? offset - distance : offset + distance; // Subtract the distance traveled from the available text.\n\n      available = available - distance; // If the available had room to spare, reset the distance so that it will\n      // advance again next time. Otherwise, set it to the overflow amount.\n\n      distance = available >= 0 ? null : 0 - available;\n    };\n\n    for (var [node, path] of Editor.nodes(editor, {\n      at,\n      reverse: reverse$1\n    })) {\n      if (Element.isElement(node)) {\n        // Void nodes are a special case, since we don't want to iterate over\n        // their content. We instead always just yield their first point.\n        if (editor.isVoid(node)) {\n          yield Editor.start(editor, path);\n          continue;\n        }\n\n        if (editor.isInline(node)) {\n          continue;\n        }\n\n        if (Editor.hasInlines(editor, node)) {\n          var e = Path.isAncestor(path, end.path) ? end : Editor.end(editor, path);\n          var s = Path.isAncestor(path, start.path) ? start : Editor.start(editor, path);\n          var text = Editor.string(editor, {\n            anchor: s,\n            focus: e\n          });\n          string = reverse$1 ? reverse(text) : text;\n          isNewBlock = true;\n        }\n      }\n\n      if (Text.isText(node)) {\n        var isFirst = Path.equals(path, first.path);\n        available = node.text.length;\n        offset = reverse$1 ? available : 0;\n\n        if (isFirst) {\n          available = reverse$1 ? first.offset : available - first.offset;\n          offset = first.offset;\n        }\n\n        if (isFirst || isNewBlock || unit === 'offset') {\n          yield {\n            path,\n            offset\n          };\n        }\n\n        while (true) {\n          // If there's no more string, continue to the next block.\n          if (string === '') {\n            break;\n          } else {\n            advance();\n          } // If the available space hasn't overflow, we have another point to\n          // yield in the current text node.\n\n\n          if (available >= 0) {\n            yield {\n              path,\n              offset\n            };\n          } else {\n            break;\n          }\n        }\n\n        isNewBlock = false;\n      }\n    }\n  },\n\n  /**\r\n   * Get the matching node in the branch of the document before a location.\r\n   */\n  previous(editor) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var {\n      mode = 'lowest',\n      voids = false\n    } = options;\n    var {\n      match,\n      at = editor.selection\n    } = options;\n\n    if (!at) {\n      return;\n    }\n\n    var [, from] = Editor.first(editor, at);\n    var [, to] = Editor.first(editor, []);\n    var span = [from, to];\n\n    if (Path.isPath(at) && at.length === 0) {\n      throw new Error(\"Cannot get the previous node from the root node!\");\n    }\n\n    if (match == null) {\n      if (Path.isPath(at)) {\n        var [parent] = Editor.parent(editor, at);\n\n        match = n => parent.children.includes(n);\n      } else {\n        match = () => true;\n      }\n    }\n\n    var [, previous] = Editor.nodes(editor, {\n      reverse: true,\n      at: span,\n      match,\n      mode,\n      voids\n    });\n    return previous;\n  },\n\n  /**\r\n   * Get a range of a location.\r\n   */\n  range(editor, at, to) {\n    if (Range.isRange(at) && !to) {\n      return at;\n    }\n\n    var start = Editor.start(editor, at);\n    var end = Editor.end(editor, to || at);\n    return {\n      anchor: start,\n      focus: end\n    };\n  },\n\n  /**\r\n   * Create a mutable ref for a `Range` object, which will stay in sync as new\r\n   * operations are applied to the editor.\r\n   */\n  rangeRef(editor, range) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    var {\n      affinity = 'forward'\n    } = options;\n    var ref = {\n      current: range,\n      affinity,\n\n      unref() {\n        var {\n          current\n        } = ref;\n        var rangeRefs = Editor.rangeRefs(editor);\n        rangeRefs.delete(ref);\n        ref.current = null;\n        return current;\n      }\n\n    };\n    var refs = Editor.rangeRefs(editor);\n    refs.add(ref);\n    return ref;\n  },\n\n  /**\r\n   * Get the set of currently tracked range refs of the editor.\r\n   */\n  rangeRefs(editor) {\n    var refs = RANGE_REFS.get(editor);\n\n    if (!refs) {\n      refs = new Set();\n      RANGE_REFS.set(editor, refs);\n    }\n\n    return refs;\n  },\n\n  /**\r\n   * Remove a custom property from all of the leaf text nodes in the current\r\n   * selection.\r\n   *\r\n   * If the selection is currently collapsed, the removal will be stored on\r\n   * `editor.marks` and applied to the text inserted next.\r\n   */\n  removeMark(editor, key) {\n    editor.removeMark(key);\n  },\n\n  /**\r\n   * Get the start point of a location.\r\n   */\n  start(editor, at) {\n    return Editor.point(editor, at, {\n      edge: 'start'\n    });\n  },\n\n  /**\r\n   * Get the text string content of a location.\r\n   *\r\n   * Note: the text of void nodes is presumed to be an empty string, regardless\r\n   * of what their actual content is.\r\n   */\n  string(editor, at) {\n    var range = Editor.range(editor, at);\n    var [start, end] = Range.edges(range);\n    var text = '';\n\n    for (var [node, path] of Editor.nodes(editor, {\n      at: range,\n      match: Text.isText\n    })) {\n      var t = node.text;\n\n      if (Path.equals(path, end.path)) {\n        t = t.slice(0, end.offset);\n      }\n\n      if (Path.equals(path, start.path)) {\n        t = t.slice(start.offset);\n      }\n\n      text += t;\n    }\n\n    return text;\n  },\n\n  /**\r\n   * Convert a range into a non-hanging one.\r\n   */\n  unhangRange(editor, range) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    var {\n      voids = false\n    } = options;\n    var [start, end] = Range.edges(range); // PERF: exit early if we can guarantee that the range isn't hanging.\n\n    if (start.offset !== 0 || end.offset !== 0 || Range.isCollapsed(range)) {\n      return range;\n    }\n\n    var endBlock = Editor.above(editor, {\n      at: end,\n      match: n => Editor.isBlock(editor, n)\n    });\n    var blockPath = endBlock ? endBlock[1] : [];\n    var first = Editor.start(editor, []);\n    var before = {\n      anchor: first,\n      focus: end\n    };\n    var skip = true;\n\n    for (var [node, path] of Editor.nodes(editor, {\n      at: before,\n      match: Text.isText,\n      reverse: true,\n      voids\n    })) {\n      if (skip) {\n        skip = false;\n        continue;\n      }\n\n      if (node.text !== '' || Path.isBefore(path, blockPath)) {\n        end = {\n          path,\n          offset: node.text.length\n        };\n        break;\n      }\n    }\n\n    return {\n      anchor: start,\n      focus: end\n    };\n  },\n\n  /**\r\n   * Match a void node in the current branch of the editor.\r\n   */\n  void(editor) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    return Editor.above(editor, _objectSpread({}, options, {\n      match: n => Editor.isVoid(editor, n)\n    }));\n  },\n\n  /**\r\n   * Call a function, deferring normalization until after it completes.\r\n   */\n  withoutNormalizing(editor, fn) {\n    var value = Editor.isNormalizing(editor);\n    NORMALIZING.set(editor, false);\n    fn();\n    NORMALIZING.set(editor, value);\n    Editor.normalize(editor);\n  }\n\n};\n\nvar Element = {\n  /**\r\n   * Check if a value implements the `Element` interface.\r\n   */\n  isElement(value) {\n    return isPlainObject(value) && Node.isNodeList(value.children) && !Editor.isEditor(value);\n  },\n\n  /**\r\n   * Check if a value is an array of `Element` objects.\r\n   */\n  isElementList(value) {\n    return Array.isArray(value) && (value.length === 0 || Element.isElement(value[0]));\n  },\n\n  /**\r\n   * Check if an element matches set of properties.\r\n   *\r\n   * Note: this checks custom properties, and it does not ensure that any\r\n   * children are equivalent.\r\n   */\n  matches(element, props) {\n    for (var key in props) {\n      if (key === 'children') {\n        continue;\n      }\n\n      if (element[key] !== props[key]) {\n        return false;\n      }\n    }\n\n    return true;\n  }\n\n};\n\nvar Location = {\n  /**\r\n   * Check if a value implements the `Location` interface.\r\n   */\n  isLocation(value) {\n    return Path.isPath(value) || Point.isPoint(value) || Range.isRange(value);\n  }\n\n};\nvar Span = {\n  /**\r\n   * Check if a value implements the `Span` interface.\r\n   */\n  isSpan(value) {\n    return Array.isArray(value) && value.length === 2 && value.every(Path.isPath);\n  }\n\n};\n\nvar Node = {\n  /**\r\n   * Get the node at a specific path, asserting that it's an ancestor node.\r\n   */\n  ancestor(root, path) {\n    var node = Node.get(root, path);\n\n    if (Text.isText(node)) {\n      throw new Error(\"Cannot get the ancestor node at path [\".concat(path, \"] because it refers to a text node instead: \").concat(node));\n    }\n\n    return node;\n  },\n\n  /**\r\n   * Return a generator of all the ancestor nodes above a specific path.\r\n   *\r\n   * By default the order is bottom-up, from lowest to highest ancestor in\r\n   * the tree, but you can pass the `reverse: true` option to go top-down.\r\n   */\n  *ancestors(root, path) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n    for (var p of Path.ancestors(path, options)) {\n      var n = Node.ancestor(root, p);\n      var entry = [n, p];\n      yield entry;\n    }\n  },\n\n  /**\r\n   * Get the child of a node at a specific index.\r\n   */\n  child(root, index) {\n    if (Text.isText(root)) {\n      throw new Error(\"Cannot get the child of a text node: \".concat(JSON.stringify(root)));\n    }\n\n    var c = root.children[index];\n\n    if (c == null) {\n      throw new Error(\"Cannot get child at index `\".concat(index, \"` in node: \").concat(JSON.stringify(root)));\n    }\n\n    return c;\n  },\n\n  /**\r\n   * Iterate over the children of a node at a specific path.\r\n   */\n  *children(root, path) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    var {\n      reverse = false\n    } = options;\n    var ancestor = Node.ancestor(root, path);\n    var {\n      children\n    } = ancestor;\n    var index = reverse ? children.length - 1 : 0;\n\n    while (reverse ? index >= 0 : index < children.length) {\n      var child = Node.child(ancestor, index);\n      var childPath = path.concat(index);\n      yield [child, childPath];\n      index = reverse ? index - 1 : index + 1;\n    }\n  },\n\n  /**\r\n   * Get an entry for the common ancesetor node of two paths.\r\n   */\n  common(root, path, another) {\n    var p = Path.common(path, another);\n    var n = Node.get(root, p);\n    return [n, p];\n  },\n\n  /**\r\n   * Get the node at a specific path, asserting that it's a descendant node.\r\n   */\n  descendant(root, path) {\n    var node = Node.get(root, path);\n\n    if (Editor.isEditor(node)) {\n      throw new Error(\"Cannot get the descendant node at path [\".concat(path, \"] because it refers to the root editor node instead: \").concat(node));\n    }\n\n    return node;\n  },\n\n  /**\r\n   * Return a generator of all the descendant node entries inside a root node.\r\n   */\n  *descendants(root) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    for (var [node, path] of Node.nodes(root, options)) {\n      if (path.length !== 0) {\n        // NOTE: we have to coerce here because checking the path's length does\n        // guarantee that `node` is not a `Editor`, but TypeScript doesn't know.\n        yield [node, path];\n      }\n    }\n  },\n\n  /**\r\n   * Return a generator of all the element nodes inside a root node. Each iteration\r\n   * will return an `ElementEntry` tuple consisting of `[Element, Path]`. If the\r\n   * root node is an element it will be included in the iteration as well.\r\n   */\n  *elements(root) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    for (var [node, path] of Node.nodes(root, options)) {\n      if (Element.isElement(node)) {\n        yield [node, path];\n      }\n    }\n  },\n\n  /**\r\n   * Get the first node entry in a root node from a path.\r\n   */\n  first(root, path) {\n    var p = path.slice();\n    var n = Node.get(root, p);\n\n    while (n) {\n      if (Text.isText(n) || n.children.length === 0) {\n        break;\n      } else {\n        n = n.children[0];\n        p.push(0);\n      }\n    }\n\n    return [n, p];\n  },\n\n  /**\r\n   * Get the sliced fragment represented by a range inside a root node.\r\n   */\n  fragment(root, range) {\n    if (Text.isText(root)) {\n      throw new Error(\"Cannot get a fragment starting from a root text node: \".concat(JSON.stringify(root)));\n    }\n\n    var newRoot = produce(root, r => {\n      var [start, end] = Range.edges(range);\n      var nodeEntries = Node.nodes(r, {\n        reverse: true,\n        pass: (_ref) => {\n          var [, path] = _ref;\n          return !Range.includes(range, path);\n        }\n      });\n\n      for (var [, path] of nodeEntries) {\n        if (!Range.includes(range, path)) {\n          var parent = Node.parent(r, path);\n          var index = path[path.length - 1];\n          parent.children.splice(index, 1);\n        }\n\n        if (Path.equals(path, end.path)) {\n          var leaf = Node.leaf(r, path);\n          leaf.text = leaf.text.slice(0, end.offset);\n        }\n\n        if (Path.equals(path, start.path)) {\n          var _leaf = Node.leaf(r, path);\n\n          _leaf.text = _leaf.text.slice(start.offset);\n        }\n      }\n\n      delete r.selection;\n    });\n    return newRoot.children;\n  },\n\n  /**\r\n   * Get the descendant node referred to by a specific path. If the path is an\r\n   * empty array, it refers to the root node itself.\r\n   */\n  get(root, path) {\n    var node = root;\n\n    for (var i = 0; i < path.length; i++) {\n      var p = path[i];\n\n      if (Text.isText(node) || !node.children[p]) {\n        throw new Error(\"Cannot find a descendant at path [\".concat(path, \"] in node: \").concat(JSON.stringify(root)));\n      }\n\n      node = node.children[p];\n    }\n\n    return node;\n  },\n\n  /**\r\n   * Check if a descendant node exists at a specific path.\r\n   */\n  has(root, path) {\n    var node = root;\n\n    for (var i = 0; i < path.length; i++) {\n      var p = path[i];\n\n      if (Text.isText(node) || !node.children[p]) {\n        return false;\n      }\n\n      node = node.children[p];\n    }\n\n    return true;\n  },\n\n  /**\r\n   * Check if a value implements the `Node` interface.\r\n   */\n  isNode(value) {\n    return Text.isText(value) || Element.isElement(value) || Editor.isEditor(value);\n  },\n\n  /**\r\n   * Check if a value is a list of `Node` objects.\r\n   */\n  isNodeList(value) {\n    return Array.isArray(value) && (value.length === 0 || Node.isNode(value[0]));\n  },\n\n  /**\r\n   * Get the last node entry in a root node from a path.\r\n   */\n  last(root, path) {\n    var p = path.slice();\n    var n = Node.get(root, p);\n\n    while (n) {\n      if (Text.isText(n) || n.children.length === 0) {\n        break;\n      } else {\n        var i = n.children.length - 1;\n        n = n.children[i];\n        p.push(i);\n      }\n    }\n\n    return [n, p];\n  },\n\n  /**\r\n   * Get the node at a specific path, ensuring it's a leaf text node.\r\n   */\n  leaf(root, path) {\n    var node = Node.get(root, path);\n\n    if (!Text.isText(node)) {\n      throw new Error(\"Cannot get the leaf node at path [\".concat(path, \"] because it refers to a non-leaf node: \").concat(node));\n    }\n\n    return node;\n  },\n\n  /**\r\n   * Return a generator of the in a branch of the tree, from a specific path.\r\n   *\r\n   * By default the order is top-down, from lowest to highest node in the tree,\r\n   * but you can pass the `reverse: true` option to go bottom-up.\r\n   */\n  *levels(root, path) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n    for (var p of Path.levels(path, options)) {\n      var n = Node.get(root, p);\n      yield [n, p];\n    }\n  },\n\n  /**\r\n   * Check if a node matches a set of props.\r\n   */\n  matches(node, props) {\n    return Element.isElement(node) && Element.matches(node, props) || Text.isText(node) && Text.matches(node, props);\n  },\n\n  /**\r\n   * Return a generator of all the node entries of a root node. Each entry is\r\n   * returned as a `[Node, Path]` tuple, with the path referring to the node's\r\n   * position inside the root node.\r\n   */\n  *nodes(root) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var {\n      pass,\n      reverse = false\n    } = options;\n    var {\n      from = [],\n      to\n    } = options;\n    var visited = new Set();\n    var p = [];\n    var n = root;\n\n    while (true) {\n      if (to && (reverse ? Path.isBefore(p, to) : Path.isAfter(p, to))) {\n        break;\n      }\n\n      if (!visited.has(n)) {\n        yield [n, p];\n      } // If we're allowed to go downward and we haven't decsended yet, do.\n\n\n      if (!visited.has(n) && !Text.isText(n) && n.children.length !== 0 && (pass == null || pass([n, p]) === false)) {\n        visited.add(n);\n        var nextIndex = reverse ? n.children.length - 1 : 0;\n\n        if (Path.isAncestor(p, from)) {\n          nextIndex = from[p.length];\n        }\n\n        p = p.concat(nextIndex);\n        n = Node.get(root, p);\n        continue;\n      } // If we're at the root and we can't go down, we're done.\n\n\n      if (p.length === 0) {\n        break;\n      } // If we're going forward...\n\n\n      if (!reverse) {\n        var newPath = Path.next(p);\n\n        if (Node.has(root, newPath)) {\n          p = newPath;\n          n = Node.get(root, p);\n          continue;\n        }\n      } // If we're going backward...\n\n\n      if (reverse && p[p.length - 1] !== 0) {\n        var _newPath = Path.previous(p);\n\n        p = _newPath;\n        n = Node.get(root, p);\n        continue;\n      } // Otherwise we're going upward...\n\n\n      p = Path.parent(p);\n      n = Node.get(root, p);\n      visited.add(n);\n    }\n  },\n\n  /**\r\n   * Get the parent of a node at a specific path.\r\n   */\n  parent(root, path) {\n    var parentPath = Path.parent(path);\n    var p = Node.get(root, parentPath);\n\n    if (Text.isText(p)) {\n      throw new Error(\"Cannot get the parent of path [\".concat(path, \"] because it does not exist in the root.\"));\n    }\n\n    return p;\n  },\n\n  /**\r\n   * Get the concatenated text string of a node's content.\r\n   *\r\n   * Note that this will not include spaces or line breaks between block nodes.\r\n   * It is not a user-facing string, but a string for performing offset-related\r\n   * computations for a node.\r\n   */\n  string(node) {\n    if (Text.isText(node)) {\n      return node.text;\n    } else {\n      return node.children.map(Node.string).join('');\n    }\n  },\n\n  /**\r\n   * Return a generator of all leaf text nodes in a root node.\r\n   */\n  *texts(root) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    for (var [node, path] of Node.nodes(root, options)) {\n      if (Text.isText(node)) {\n        yield [node, path];\n      }\n    }\n  }\n\n};\n\nfunction ownKeys$1(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread$1(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys$1(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys$1(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\nvar Operation = {\n  /**\r\n   * Check of a value is a `NodeOperation` object.\r\n   */\n  isNodeOperation(value) {\n    return Operation.isOperation(value) && value.type.endsWith('_node');\n  },\n\n  /**\r\n   * Check of a value is an `Operation` object.\r\n   */\n  isOperation(value) {\n    if (!isPlainObject(value)) {\n      return false;\n    }\n\n    switch (value.type) {\n      case 'insert_node':\n        return Path.isPath(value.path) && Node.isNode(value.node);\n\n      case 'insert_text':\n        return typeof value.offset === 'number' && typeof value.text === 'string' && Path.isPath(value.path);\n\n      case 'merge_node':\n        return typeof value.position === 'number' && Path.isPath(value.path) && isPlainObject(value.properties);\n\n      case 'move_node':\n        return Path.isPath(value.path) && Path.isPath(value.newPath);\n\n      case 'remove_node':\n        return Path.isPath(value.path) && Node.isNode(value.node);\n\n      case 'remove_text':\n        return typeof value.offset === 'number' && typeof value.text === 'string' && Path.isPath(value.path);\n\n      case 'set_node':\n        return Path.isPath(value.path) && isPlainObject(value.properties) && isPlainObject(value.newProperties);\n\n      case 'set_selection':\n        return value.properties === null && Range.isRange(value.newProperties) || value.newProperties === null && Range.isRange(value.properties) || isPlainObject(value.properties) && isPlainObject(value.newProperties);\n\n      case 'split_node':\n        return Path.isPath(value.path) && typeof value.position === 'number' && isPlainObject(value.properties);\n\n      default:\n        return false;\n    }\n  },\n\n  /**\r\n   * Check if a value is a list of `Operation` objects.\r\n   */\n  isOperationList(value) {\n    return Array.isArray(value) && (value.length === 0 || Operation.isOperation(value[0]));\n  },\n\n  /**\r\n   * Check of a value is a `SelectionOperation` object.\r\n   */\n  isSelectionOperation(value) {\n    return Operation.isOperation(value) && value.type.endsWith('_selection');\n  },\n\n  /**\r\n   * Check of a value is a `TextOperation` object.\r\n   */\n  isTextOperation(value) {\n    return Operation.isOperation(value) && value.type.endsWith('_text');\n  },\n\n  /**\r\n   * Invert an operation, returning a new operation that will exactly undo the\r\n   * original when applied.\r\n   */\n  inverse(op) {\n    switch (op.type) {\n      case 'insert_node':\n        {\n          return _objectSpread$1({}, op, {\n            type: 'remove_node'\n          });\n        }\n\n      case 'insert_text':\n        {\n          return _objectSpread$1({}, op, {\n            type: 'remove_text'\n          });\n        }\n\n      case 'merge_node':\n        {\n          return _objectSpread$1({}, op, {\n            type: 'split_node',\n            path: Path.previous(op.path)\n          });\n        }\n\n      case 'move_node':\n        {\n          var {\n            newPath,\n            path\n          } = op; // PERF: in this case the move operation is a no-op anyways.\n\n          if (Path.equals(newPath, path)) {\n            return op;\n          } // If the move happens completely within a single parent the path and\n          // newPath are stable with respect to each other.\n\n\n          if (Path.isSibling(path, newPath)) {\n            return _objectSpread$1({}, op, {\n              path: newPath,\n              newPath: path\n            });\n          } // If the move does not happen within a single parent it is possible\n          // for the move to impact the true path to the location where the node\n          // was removed from and where it was inserted. We have to adjust for this\n          // and find the original path. We can accomplish this (only in non-sibling)\n          // moves by looking at the impact of the move operation on the node\n          // after the original move path.\n\n\n          var inversePath = Path.transform(path, op);\n          var inverseNewPath = Path.transform(Path.next(path), op);\n          return _objectSpread$1({}, op, {\n            path: inversePath,\n            newPath: inverseNewPath\n          });\n        }\n\n      case 'remove_node':\n        {\n          return _objectSpread$1({}, op, {\n            type: 'insert_node'\n          });\n        }\n\n      case 'remove_text':\n        {\n          return _objectSpread$1({}, op, {\n            type: 'insert_text'\n          });\n        }\n\n      case 'set_node':\n        {\n          var {\n            properties,\n            newProperties\n          } = op;\n          return _objectSpread$1({}, op, {\n            properties: newProperties,\n            newProperties: properties\n          });\n        }\n\n      case 'set_selection':\n        {\n          var {\n            properties: _properties,\n            newProperties: _newProperties\n          } = op;\n\n          if (_properties == null) {\n            return _objectSpread$1({}, op, {\n              properties: _newProperties,\n              newProperties: null\n            });\n          } else if (_newProperties == null) {\n            return _objectSpread$1({}, op, {\n              properties: null,\n              newProperties: _properties\n            });\n          } else {\n            return _objectSpread$1({}, op, {\n              properties: _newProperties,\n              newProperties: _properties\n            });\n          }\n        }\n\n      case 'split_node':\n        {\n          return _objectSpread$1({}, op, {\n            type: 'merge_node',\n            path: Path.next(op.path)\n          });\n        }\n    }\n  }\n\n};\n\nvar Path = {\n  /**\r\n   * Get a list of ancestor paths for a given path.\r\n   *\r\n   * The paths are sorted from deepest to shallowest ancestor. However, if the\r\n   * `reverse: true` option is passed, they are reversed.\r\n   */\n  ancestors(path) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var {\n      reverse = false\n    } = options;\n    var paths = Path.levels(path, options);\n\n    if (reverse) {\n      paths = paths.slice(1);\n    } else {\n      paths = paths.slice(0, -1);\n    }\n\n    return paths;\n  },\n\n  /**\r\n   * Get the common ancestor path of two paths.\r\n   */\n  common(path, another) {\n    var common = [];\n\n    for (var i = 0; i < path.length && i < another.length; i++) {\n      var av = path[i];\n      var bv = another[i];\n\n      if (av !== bv) {\n        break;\n      }\n\n      common.push(av);\n    }\n\n    return common;\n  },\n\n  /**\r\n   * Compare a path to another, returning an integer indicating whether the path\r\n   * was before, at, or after the other.\r\n   *\r\n   * Note: Two paths of unequal length can still receive a `0` result if one is\r\n   * directly above or below the other. If you want exact matching, use\r\n   * [[Path.equals]] instead.\r\n   */\n  compare(path, another) {\n    var min = Math.min(path.length, another.length);\n\n    for (var i = 0; i < min; i++) {\n      if (path[i] < another[i]) return -1;\n      if (path[i] > another[i]) return 1;\n    }\n\n    return 0;\n  },\n\n  /**\r\n   * Check if a path ends after one of the indexes in another.\r\n   */\n  endsAfter(path, another) {\n    var i = path.length - 1;\n    var as = path.slice(0, i);\n    var bs = another.slice(0, i);\n    var av = path[i];\n    var bv = another[i];\n    return Path.equals(as, bs) && av > bv;\n  },\n\n  /**\r\n   * Check if a path ends at one of the indexes in another.\r\n   */\n  endsAt(path, another) {\n    var i = path.length;\n    var as = path.slice(0, i);\n    var bs = another.slice(0, i);\n    return Path.equals(as, bs);\n  },\n\n  /**\r\n   * Check if a path ends before one of the indexes in another.\r\n   */\n  endsBefore(path, another) {\n    var i = path.length - 1;\n    var as = path.slice(0, i);\n    var bs = another.slice(0, i);\n    var av = path[i];\n    var bv = another[i];\n    return Path.equals(as, bs) && av < bv;\n  },\n\n  /**\r\n   * Check if a path is exactly equal to another.\r\n   */\n  equals(path, another) {\n    return path.length === another.length && path.every((n, i) => n === another[i]);\n  },\n\n  /**\r\n   * Check if a path is after another.\r\n   */\n  isAfter(path, another) {\n    return Path.compare(path, another) === 1;\n  },\n\n  /**\r\n   * Check if a path is an ancestor of another.\r\n   */\n  isAncestor(path, another) {\n    return path.length < another.length && Path.compare(path, another) === 0;\n  },\n\n  /**\r\n   * Check if a path is before another.\r\n   */\n  isBefore(path, another) {\n    return Path.compare(path, another) === -1;\n  },\n\n  /**\r\n   * Check if a path is a child of another.\r\n   */\n  isChild(path, another) {\n    return path.length === another.length + 1 && Path.compare(path, another) === 0;\n  },\n\n  /**\r\n   * Check if a path is equal to or an ancestor of another.\r\n   */\n  isCommon(path, another) {\n    return path.length <= another.length && Path.compare(path, another) === 0;\n  },\n\n  /**\r\n   * Check if a path is a descendant of another.\r\n   */\n  isDescendant(path, another) {\n    return path.length > another.length && Path.compare(path, another) === 0;\n  },\n\n  /**\r\n   * Check if a path is the parent of another.\r\n   */\n  isParent(path, another) {\n    return path.length + 1 === another.length && Path.compare(path, another) === 0;\n  },\n\n  /**\r\n   * Check is a value implements the `Path` interface.\r\n   */\n  isPath(value) {\n    return Array.isArray(value) && (value.length === 0 || typeof value[0] === 'number');\n  },\n\n  /**\r\n   * Check if a path is a sibling of another.\r\n   */\n  isSibling(path, another) {\n    if (path.length !== another.length) {\n      return false;\n    }\n\n    var as = path.slice(0, -1);\n    var bs = another.slice(0, -1);\n    var al = path[path.length - 1];\n    var bl = another[another.length - 1];\n    return al !== bl && Path.equals(as, bs);\n  },\n\n  /**\r\n   * Get a list of paths at every level down to a path. Note: this is the same\r\n   * as `Path.ancestors`, but including the path itself.\r\n   *\r\n   * The paths are sorted from shallowest to deepest. However, if the `reverse:\r\n   * true` option is passed, they are reversed.\r\n   */\n  levels(path) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var {\n      reverse = false\n    } = options;\n    var list = [];\n\n    for (var i = 0; i <= path.length; i++) {\n      list.push(path.slice(0, i));\n    }\n\n    if (reverse) {\n      list.reverse();\n    }\n\n    return list;\n  },\n\n  /**\r\n   * Given a path, get the path to the next sibling node.\r\n   */\n  next(path) {\n    if (path.length === 0) {\n      throw new Error(\"Cannot get the next path of a root path [\".concat(path, \"], because it has no next index.\"));\n    }\n\n    var last = path[path.length - 1];\n    return path.slice(0, -1).concat(last + 1);\n  },\n\n  /**\r\n   * Given a path, return a new path referring to the parent node above it.\r\n   */\n  parent(path) {\n    if (path.length === 0) {\n      throw new Error(\"Cannot get the parent path of the root path [\".concat(path, \"].\"));\n    }\n\n    return path.slice(0, -1);\n  },\n\n  /**\r\n   * Given a path, get the path to the previous sibling node.\r\n   */\n  previous(path) {\n    if (path.length === 0) {\n      throw new Error(\"Cannot get the previous path of a root path [\".concat(path, \"], because it has no previous index.\"));\n    }\n\n    var last = path[path.length - 1];\n\n    if (last <= 0) {\n      throw new Error(\"Cannot get the previous path of a first child path [\".concat(path, \"] because it would result in a negative index.\"));\n    }\n\n    return path.slice(0, -1).concat(last - 1);\n  },\n\n  /**\r\n   * Get a path relative to an ancestor.\r\n   */\n  relative(path, ancestor) {\n    if (!Path.isAncestor(ancestor, path) && !Path.equals(path, ancestor)) {\n      throw new Error(\"Cannot get the relative path of [\".concat(path, \"] inside ancestor [\").concat(ancestor, \"], because it is not above or equal to the path.\"));\n    }\n\n    return path.slice(ancestor.length);\n  },\n\n  /**\r\n   * Transform a path by an operation.\r\n   */\n  transform(path, operation) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    return produce(path, p => {\n      var {\n        affinity = 'forward'\n      } = options; // PERF: Exit early if the operation is guaranteed not to have an effect.\n\n      if (path.length === 0) {\n        return;\n      }\n\n      switch (operation.type) {\n        case 'insert_node':\n          {\n            var {\n              path: op\n            } = operation;\n\n            if (Path.equals(op, p) || Path.endsBefore(op, p) || Path.isAncestor(op, p)) {\n              p[op.length - 1] += 1;\n            }\n\n            break;\n          }\n\n        case 'remove_node':\n          {\n            var {\n              path: _op\n            } = operation;\n\n            if (Path.equals(_op, p) || Path.isAncestor(_op, p)) {\n              return null;\n            } else if (Path.endsBefore(_op, p)) {\n              p[_op.length - 1] -= 1;\n            }\n\n            break;\n          }\n\n        case 'merge_node':\n          {\n            var {\n              path: _op2,\n              position\n            } = operation;\n\n            if (Path.equals(_op2, p) || Path.endsBefore(_op2, p)) {\n              p[_op2.length - 1] -= 1;\n            } else if (Path.isAncestor(_op2, p)) {\n              p[_op2.length - 1] -= 1;\n              p[_op2.length] += position;\n            }\n\n            break;\n          }\n\n        case 'split_node':\n          {\n            var {\n              path: _op3,\n              position: _position\n            } = operation;\n\n            if (Path.equals(_op3, p)) {\n              if (affinity === 'forward') {\n                p[p.length - 1] += 1;\n              } else if (affinity === 'backward') ; else {\n                return null;\n              }\n            } else if (Path.endsBefore(_op3, p)) {\n              p[_op3.length - 1] += 1;\n            } else if (Path.isAncestor(_op3, p) && path[_op3.length] >= _position) {\n              p[_op3.length - 1] += 1;\n              p[_op3.length] -= _position;\n            }\n\n            break;\n          }\n\n        case 'move_node':\n          {\n            var {\n              path: _op4,\n              newPath: onp\n            } = operation; // If the old and new path are the same, it's a no-op.\n\n            if (Path.equals(_op4, onp)) {\n              return;\n            }\n\n            if (Path.isAncestor(_op4, p) || Path.equals(_op4, p)) {\n              var copy = onp.slice();\n\n              if (Path.endsBefore(_op4, onp) && _op4.length < onp.length) {\n                copy[_op4.length - 1] -= 1;\n              }\n\n              return copy.concat(p.slice(_op4.length));\n            } else if (Path.isSibling(_op4, onp) && (Path.isAncestor(onp, p) || Path.equals(onp, p))) {\n              if (Path.endsBefore(_op4, p)) {\n                p[_op4.length - 1] -= 1;\n              } else {\n                p[_op4.length - 1] += 1;\n              }\n            } else if (Path.endsBefore(onp, p) || Path.equals(onp, p) || Path.isAncestor(onp, p)) {\n              if (Path.endsBefore(_op4, p)) {\n                p[_op4.length - 1] -= 1;\n              }\n\n              p[onp.length - 1] += 1;\n            } else if (Path.endsBefore(_op4, p)) {\n              if (Path.equals(onp, p)) {\n                p[onp.length - 1] += 1;\n              }\n\n              p[_op4.length - 1] -= 1;\n            }\n\n            break;\n          }\n      }\n    });\n  }\n\n};\n\nvar PathRef = {\n  /**\r\n   * Transform the path ref's current value by an operation.\r\n   */\n  transform(ref, op) {\n    var {\n      current,\n      affinity\n    } = ref;\n\n    if (current == null) {\n      return;\n    }\n\n    var path = Path.transform(current, op, {\n      affinity\n    });\n    ref.current = path;\n\n    if (path == null) {\n      ref.unref();\n    }\n  }\n\n};\n\nfunction ownKeys$2(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread$2(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys$2(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys$2(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\nvar Point = {\n  /**\r\n   * Compare a point to another, returning an integer indicating whether the\r\n   * point was before, at, or after the other.\r\n   */\n  compare(point, another) {\n    var result = Path.compare(point.path, another.path);\n\n    if (result === 0) {\n      if (point.offset < another.offset) return -1;\n      if (point.offset > another.offset) return 1;\n      return 0;\n    }\n\n    return result;\n  },\n\n  /**\r\n   * Check if a point is after another.\r\n   */\n  isAfter(point, another) {\n    return Point.compare(point, another) === 1;\n  },\n\n  /**\r\n   * Check if a point is before another.\r\n   */\n  isBefore(point, another) {\n    return Point.compare(point, another) === -1;\n  },\n\n  /**\r\n   * Check if a point is exactly equal to another.\r\n   */\n  equals(point, another) {\n    // PERF: ensure the offsets are equal first since they are cheaper to check.\n    return point.offset === another.offset && Path.equals(point.path, another.path);\n  },\n\n  /**\r\n   * Check if a value implements the `Point` interface.\r\n   */\n  isPoint(value) {\n    return isPlainObject(value) && typeof value.offset === 'number' && Path.isPath(value.path);\n  },\n\n  /**\r\n   * Transform a point by an operation.\r\n   */\n  transform(point, op) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    return produce(point, p => {\n      var {\n        affinity = 'forward'\n      } = options;\n      var {\n        path,\n        offset\n      } = p;\n\n      switch (op.type) {\n        case 'insert_node':\n        case 'move_node':\n          {\n            p.path = Path.transform(path, op, options);\n            break;\n          }\n\n        case 'insert_text':\n          {\n            if (Path.equals(op.path, path) && op.offset <= offset) {\n              p.offset += op.text.length;\n            }\n\n            break;\n          }\n\n        case 'merge_node':\n          {\n            if (Path.equals(op.path, path)) {\n              p.offset += op.position;\n            }\n\n            p.path = Path.transform(path, op, options);\n            break;\n          }\n\n        case 'remove_text':\n          {\n            if (Path.equals(op.path, path) && op.offset <= offset) {\n              p.offset -= Math.min(offset - op.offset, op.text.length);\n            }\n\n            break;\n          }\n\n        case 'remove_node':\n          {\n            if (Path.equals(op.path, path) || Path.isAncestor(op.path, path)) {\n              return null;\n            }\n\n            p.path = Path.transform(path, op, options);\n            break;\n          }\n\n        case 'split_node':\n          {\n            if (Path.equals(op.path, path)) {\n              if (op.position === offset && affinity == null) {\n                return null;\n              } else if (op.position < offset || op.position === offset && affinity === 'forward') {\n                p.offset -= op.position;\n                p.path = Path.transform(path, op, _objectSpread$2({}, options, {\n                  affinity: 'forward'\n                }));\n              }\n            } else {\n              p.path = Path.transform(path, op, options);\n            }\n\n            break;\n          }\n      }\n    });\n  }\n\n};\n\nvar PointRef = {\n  /**\r\n   * Transform the point ref's current value by an operation.\r\n   */\n  transform(ref, op) {\n    var {\n      current,\n      affinity\n    } = ref;\n\n    if (current == null) {\n      return;\n    }\n\n    var point = Point.transform(current, op, {\n      affinity\n    });\n    ref.current = point;\n\n    if (point == null) {\n      ref.unref();\n    }\n  }\n\n};\n\nfunction ownKeys$3(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread$3(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys$3(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys$3(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\nvar Range = {\n  /**\r\n   * Get the start and end points of a range, in the order in which they appear\r\n   * in the document.\r\n   */\n  edges(range) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var {\n      reverse = false\n    } = options;\n    var {\n      anchor,\n      focus\n    } = range;\n    return Range.isBackward(range) === reverse ? [anchor, focus] : [focus, anchor];\n  },\n\n  /**\r\n   * Get the end point of a range.\r\n   */\n  end(range) {\n    var [, end] = Range.edges(range);\n    return end;\n  },\n\n  /**\r\n   * Check if a range is exactly equal to another.\r\n   */\n  equals(range, another) {\n    return Point.equals(range.anchor, another.anchor) && Point.equals(range.focus, another.focus);\n  },\n\n  /**\r\n   * Check if a range includes a path, a point or part of another range.\r\n   */\n  includes(range, target) {\n    if (Range.isRange(target)) {\n      if (Range.includes(range, target.anchor) || Range.includes(range, target.focus)) {\n        return true;\n      }\n\n      var [rs, re] = Range.edges(range);\n      var [ts, te] = Range.edges(target);\n      return Point.isBefore(rs, ts) && Point.isAfter(re, te);\n    }\n\n    var [start, end] = Range.edges(range);\n    var isAfterStart = false;\n    var isBeforeEnd = false;\n\n    if (Point.isPoint(target)) {\n      isAfterStart = Point.compare(target, start) >= 0;\n      isBeforeEnd = Point.compare(target, end) <= 0;\n    } else {\n      isAfterStart = Path.compare(target, start.path) >= 0;\n      isBeforeEnd = Path.compare(target, end.path) <= 0;\n    }\n\n    return isAfterStart && isBeforeEnd;\n  },\n\n  /**\r\n   * Get the intersection of a range with another.\r\n   */\n  intersection(range, another) {\n    var rest = _objectWithoutProperties(range, [\"anchor\", \"focus\"]);\n\n    var [s1, e1] = Range.edges(range);\n    var [s2, e2] = Range.edges(another);\n    var start = Point.isBefore(s1, s2) ? s2 : s1;\n    var end = Point.isBefore(e1, e2) ? e1 : e2;\n\n    if (Point.isBefore(end, start)) {\n      return null;\n    } else {\n      return _objectSpread$3({\n        anchor: start,\n        focus: end\n      }, rest);\n    }\n  },\n\n  /**\r\n   * Check if a range is backward, meaning that its anchor point appears in the\r\n   * document _after_ its focus point.\r\n   */\n  isBackward(range) {\n    var {\n      anchor,\n      focus\n    } = range;\n    return Point.isAfter(anchor, focus);\n  },\n\n  /**\r\n   * Check if a range is collapsed, meaning that both its anchor and focus\r\n   * points refer to the exact same position in the document.\r\n   */\n  isCollapsed(range) {\n    var {\n      anchor,\n      focus\n    } = range;\n    return Point.equals(anchor, focus);\n  },\n\n  /**\r\n   * Check if a range is expanded.\r\n   *\r\n   * This is the opposite of [[Range.isCollapsed]] and is provided for legibility.\r\n   */\n  isExpanded(range) {\n    return !Range.isCollapsed(range);\n  },\n\n  /**\r\n   * Check if a range is forward.\r\n   *\r\n   * This is the opposite of [[Range.isBackward]] and is provided for legibility.\r\n   */\n  isForward(range) {\n    return !Range.isBackward(range);\n  },\n\n  /**\r\n   * Check if a value implements the [[Range]] interface.\r\n   */\n  isRange(value) {\n    return isPlainObject(value) && Point.isPoint(value.anchor) && Point.isPoint(value.focus);\n  },\n\n  /**\r\n   * Iterate through all of the point entries in a range.\r\n   */\n  *points(range) {\n    yield [range.anchor, 'anchor'];\n    yield [range.focus, 'focus'];\n  },\n\n  /**\r\n   * Get the start point of a range.\r\n   */\n  start(range) {\n    var [start] = Range.edges(range);\n    return start;\n  },\n\n  /**\r\n   * Transform a range by an operation.\r\n   */\n  transform(range, op) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    var {\n      affinity = 'inward'\n    } = options;\n    var affinityAnchor;\n    var affinityFocus;\n\n    if (affinity === 'inward') {\n      if (Range.isForward(range)) {\n        affinityAnchor = 'forward';\n        affinityFocus = 'backward';\n      } else {\n        affinityAnchor = 'backward';\n        affinityFocus = 'forward';\n      }\n    } else if (affinity === 'outward') {\n      if (Range.isForward(range)) {\n        affinityAnchor = 'backward';\n        affinityFocus = 'forward';\n      } else {\n        affinityAnchor = 'forward';\n        affinityFocus = 'backward';\n      }\n    } else {\n      affinityAnchor = affinity;\n      affinityFocus = affinity;\n    }\n\n    return produce(range, r => {\n      var anchor = Point.transform(r.anchor, op, {\n        affinity: affinityAnchor\n      });\n      var focus = Point.transform(r.focus, op, {\n        affinity: affinityFocus\n      });\n\n      if (!anchor || !focus) {\n        return null;\n      }\n\n      r.anchor = anchor;\n      r.focus = focus;\n    });\n  }\n\n};\n\nvar RangeRef = {\n  /**\r\n   * Transform the range ref's current value by an operation.\r\n   */\n  transform(ref, op) {\n    var {\n      current,\n      affinity\n    } = ref;\n\n    if (current == null) {\n      return;\n    }\n\n    var path = Range.transform(current, op, {\n      affinity\n    });\n    ref.current = path;\n\n    if (path == null) {\n      ref.unref();\n    }\n  }\n\n};\n\nfunction ownKeys$4(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread$4(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys$4(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys$4(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\nvar Text = {\n  /**\r\n   * Check if two text nodes are equal.\r\n   */\n  equals(text, another) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    var {\n      loose = false\n    } = options;\n\n    for (var key in text) {\n      if (loose && key === 'text') {\n        continue;\n      }\n\n      if (text[key] !== another[key]) {\n        return false;\n      }\n    }\n\n    for (var _key in another) {\n      if (loose && _key === 'text') {\n        continue;\n      }\n\n      if (text[_key] !== another[_key]) {\n        return false;\n      }\n    }\n\n    return true;\n  },\n\n  /**\r\n   * Check if a value implements the `Text` interface.\r\n   */\n  isText(value) {\n    return isPlainObject(value) && typeof value.text === 'string';\n  },\n\n  /**\r\n   * Check if a value is a list of `Text` objects.\r\n   */\n  isTextList(value) {\n    return Array.isArray(value) && (value.length === 0 || Text.isText(value[0]));\n  },\n\n  /**\r\n   * Check if an text matches set of properties.\r\n   *\r\n   * Note: this is for matching custom properties, and it does not ensure that\r\n   * the `text` property are two nodes equal.\r\n   */\n  matches(text, props) {\n    for (var key in props) {\n      if (key === 'text') {\n        continue;\n      }\n\n      if (text[key] !== props[key]) {\n        return false;\n      }\n    }\n\n    return true;\n  },\n\n  /**\r\n   * Get the leaves for a text node given decorations.\r\n   */\n  decorations(node, decorations) {\n    var leaves = [_objectSpread$4({}, node)];\n\n    for (var dec of decorations) {\n      var rest = _objectWithoutProperties(dec, [\"anchor\", \"focus\"]);\n\n      var [start, end] = Range.edges(dec);\n      var next = [];\n      var o = 0;\n\n      for (var leaf of leaves) {\n        var {\n          length\n        } = leaf.text;\n        var offset = o;\n        o += length; // If the range encompases the entire leaf, add the range.\n\n        if (start.offset <= offset && end.offset >= offset + length) {\n          Object.assign(leaf, rest);\n          next.push(leaf);\n          continue;\n        } // If the range starts after the leaf, or ends before it, continue.\n\n\n        if (start.offset > offset + length || end.offset < offset || end.offset === offset && offset !== 0) {\n          next.push(leaf);\n          continue;\n        } // Otherwise we need to split the leaf, at the start, end, or both,\n        // and add the range to the middle intersecting section. Do the end\n        // split first since we don't need to update the offset that way.\n\n\n        var middle = leaf;\n        var before = void 0;\n        var after = void 0;\n\n        if (end.offset < offset + length) {\n          var off = end.offset - offset;\n          after = _objectSpread$4({}, middle, {\n            text: middle.text.slice(off)\n          });\n          middle = _objectSpread$4({}, middle, {\n            text: middle.text.slice(0, off)\n          });\n        }\n\n        if (start.offset > offset) {\n          var _off = start.offset - offset;\n\n          before = _objectSpread$4({}, middle, {\n            text: middle.text.slice(0, _off)\n          });\n          middle = _objectSpread$4({}, middle, {\n            text: middle.text.slice(_off)\n          });\n        }\n\n        Object.assign(middle, rest);\n\n        if (before) {\n          next.push(before);\n        }\n\n        next.push(middle);\n\n        if (after) {\n          next.push(after);\n        }\n      }\n\n      leaves = next;\n    }\n\n    return leaves;\n  }\n\n};\n\nfunction ownKeys$5(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread$5(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys$5(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys$5(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\nvar GeneralTransforms = {\n  /**\r\n   * Transform the editor by an operation.\r\n   */\n  transform(editor, op) {\n    editor.children = createDraft(editor.children);\n    var selection = editor.selection && createDraft(editor.selection);\n\n    switch (op.type) {\n      case 'insert_node':\n        {\n          var {\n            path,\n            node\n          } = op;\n          var parent = Node.parent(editor, path);\n          var index = path[path.length - 1];\n          parent.children.splice(index, 0, node);\n\n          if (selection) {\n            for (var [point, key] of Range.points(selection)) {\n              selection[key] = Point.transform(point, op);\n            }\n          }\n\n          break;\n        }\n\n      case 'insert_text':\n        {\n          var {\n            path: _path,\n            offset,\n            text\n          } = op;\n\n          var _node = Node.leaf(editor, _path);\n\n          var before = _node.text.slice(0, offset);\n\n          var after = _node.text.slice(offset);\n\n          _node.text = before + text + after;\n\n          if (selection) {\n            for (var [_point, _key] of Range.points(selection)) {\n              selection[_key] = Point.transform(_point, op);\n            }\n          }\n\n          break;\n        }\n\n      case 'merge_node':\n        {\n          var {\n            path: _path2\n          } = op;\n\n          var _node2 = Node.get(editor, _path2);\n\n          var prevPath = Path.previous(_path2);\n          var prev = Node.get(editor, prevPath);\n\n          var _parent = Node.parent(editor, _path2);\n\n          var _index = _path2[_path2.length - 1];\n\n          if (Text.isText(_node2) && Text.isText(prev)) {\n            prev.text += _node2.text;\n          } else if (!Text.isText(_node2) && !Text.isText(prev)) {\n            prev.children.push(..._node2.children);\n          } else {\n            throw new Error(\"Cannot apply a \\\"merge_node\\\" operation at path [\".concat(_path2, \"] to nodes of different interaces: \").concat(_node2, \" \").concat(prev));\n          }\n\n          _parent.children.splice(_index, 1);\n\n          if (selection) {\n            for (var [_point2, _key2] of Range.points(selection)) {\n              selection[_key2] = Point.transform(_point2, op);\n            }\n          }\n\n          break;\n        }\n\n      case 'move_node':\n        {\n          var {\n            path: _path3,\n            newPath\n          } = op;\n\n          if (Path.isAncestor(_path3, newPath)) {\n            throw new Error(\"Cannot move a path [\".concat(_path3, \"] to new path [\").concat(newPath, \"] because the destination is inside itself.\"));\n          }\n\n          var _node3 = Node.get(editor, _path3);\n\n          var _parent2 = Node.parent(editor, _path3);\n\n          var _index2 = _path3[_path3.length - 1]; // This is tricky, but since the `path` and `newPath` both refer to\n          // the same snapshot in time, there's a mismatch. After either\n          // removing the original position, the second step's path can be out\n          // of date. So instead of using the `op.newPath` directly, we\n          // transform `op.path` to ascertain what the `newPath` would be after\n          // the operation was applied.\n\n          _parent2.children.splice(_index2, 1);\n\n          var truePath = Path.transform(_path3, op);\n          var newParent = Node.get(editor, Path.parent(truePath));\n          var newIndex = truePath[truePath.length - 1];\n          newParent.children.splice(newIndex, 0, _node3);\n\n          if (selection) {\n            for (var [_point3, _key3] of Range.points(selection)) {\n              selection[_key3] = Point.transform(_point3, op);\n            }\n          }\n\n          break;\n        }\n\n      case 'remove_node':\n        {\n          var {\n            path: _path4\n          } = op;\n          var _index3 = _path4[_path4.length - 1];\n\n          var _parent3 = Node.parent(editor, _path4);\n\n          _parent3.children.splice(_index3, 1); // Transform all of the points in the value, but if the point was in the\n          // node that was removed we need to update the range or remove it.\n\n\n          if (selection) {\n            for (var [_point4, _key4] of Range.points(selection)) {\n              var result = Point.transform(_point4, op);\n\n              if (selection != null && result != null) {\n                selection[_key4] = result;\n              } else {\n                var _prev = void 0;\n\n                var next = void 0;\n\n                for (var [n, p] of Node.texts(editor)) {\n                  if (Path.compare(p, _path4) === -1) {\n                    _prev = [n, p];\n                  } else {\n                    next = [n, p];\n                    break;\n                  }\n                }\n\n                if (_prev) {\n                  _point4.path = _prev[1];\n                  _point4.offset = _prev[0].text.length;\n                } else if (next) {\n                  _point4.path = next[1];\n                  _point4.offset = 0;\n                } else {\n                  selection = null;\n                }\n              }\n            }\n          }\n\n          break;\n        }\n\n      case 'remove_text':\n        {\n          var {\n            path: _path5,\n            offset: _offset,\n            text: _text\n          } = op;\n\n          var _node4 = Node.leaf(editor, _path5);\n\n          var _before = _node4.text.slice(0, _offset);\n\n          var _after = _node4.text.slice(_offset + _text.length);\n\n          _node4.text = _before + _after;\n\n          if (selection) {\n            for (var [_point5, _key5] of Range.points(selection)) {\n              selection[_key5] = Point.transform(_point5, op);\n            }\n          }\n\n          break;\n        }\n\n      case 'set_node':\n        {\n          var {\n            path: _path6,\n            newProperties\n          } = op;\n\n          if (_path6.length === 0) {\n            throw new Error(\"Cannot set properties on the root node!\");\n          }\n\n          var _node5 = Node.get(editor, _path6);\n\n          for (var _key6 in newProperties) {\n            if (_key6 === 'children' || _key6 === 'text') {\n              throw new Error(\"Cannot set the \\\"\".concat(_key6, \"\\\" property of nodes!\"));\n            }\n\n            var value = newProperties[_key6];\n\n            if (value == null) {\n              delete _node5[_key6];\n            } else {\n              _node5[_key6] = value;\n            }\n          }\n\n          break;\n        }\n\n      case 'set_selection':\n        {\n          var {\n            newProperties: _newProperties\n          } = op;\n\n          if (_newProperties == null) {\n            selection = _newProperties;\n          } else if (selection == null) {\n            if (!Range.isRange(_newProperties)) {\n              throw new Error(\"Cannot apply an incomplete \\\"set_selection\\\" operation properties \".concat(JSON.stringify(_newProperties), \" when there is no current selection.\"));\n            }\n\n            selection = _newProperties;\n          } else {\n            Object.assign(selection, _newProperties);\n          }\n\n          break;\n        }\n\n      case 'split_node':\n        {\n          var {\n            path: _path7,\n            position,\n            properties\n          } = op;\n\n          if (_path7.length === 0) {\n            throw new Error(\"Cannot apply a \\\"split_node\\\" operation at path [\".concat(_path7, \"] because the root node cannot be split.\"));\n          }\n\n          var _node6 = Node.get(editor, _path7);\n\n          var _parent4 = Node.parent(editor, _path7);\n\n          var _index4 = _path7[_path7.length - 1];\n          var newNode;\n\n          if (Text.isText(_node6)) {\n            var _before2 = _node6.text.slice(0, position);\n\n            var _after2 = _node6.text.slice(position);\n\n            _node6.text = _before2;\n            newNode = _objectSpread$5({}, _node6, {}, properties, {\n              text: _after2\n            });\n          } else {\n            var _before3 = _node6.children.slice(0, position);\n\n            var _after3 = _node6.children.slice(position);\n\n            _node6.children = _before3;\n            newNode = _objectSpread$5({}, _node6, {}, properties, {\n              children: _after3\n            });\n          }\n\n          _parent4.children.splice(_index4 + 1, 0, newNode);\n\n          if (selection) {\n            for (var [_point6, _key7] of Range.points(selection)) {\n              selection[_key7] = Point.transform(_point6, op);\n            }\n          }\n\n          break;\n        }\n    }\n\n    editor.children = finishDraft(editor.children);\n\n    if (selection) {\n      editor.selection = isDraft(selection) ? finishDraft(selection) : selection;\n    } else {\n      editor.selection = null;\n    }\n  }\n\n};\n\nfunction ownKeys$6(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread$6(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys$6(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys$6(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\nvar NodeTransforms = {\n  /**\r\n   * Insert nodes at a specific location in the Editor.\r\n   */\n  insertNodes(editor, nodes) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    Editor.withoutNormalizing(editor, () => {\n      var {\n        hanging = false,\n        voids = false,\n        mode = 'lowest'\n      } = options;\n      var {\n        at,\n        match,\n        select\n      } = options;\n\n      if (Node.isNode(nodes)) {\n        nodes = [nodes];\n      }\n\n      if (nodes.length === 0) {\n        return;\n      }\n\n      var [node] = nodes; // By default, use the selection as the target location. But if there is\n      // no selection, insert at the end of the document since that is such a\n      // common use case when inserting from a non-selected state.\n\n      if (!at) {\n        if (editor.selection) {\n          at = editor.selection;\n        } else if (editor.children.length > 0) {\n          at = Editor.end(editor, []);\n        } else {\n          at = [0];\n        }\n\n        select = true;\n      }\n\n      if (select == null) {\n        select = false;\n      }\n\n      if (Range.isRange(at)) {\n        if (!hanging) {\n          at = Editor.unhangRange(editor, at);\n        }\n\n        if (Range.isCollapsed(at)) {\n          at = at.anchor;\n        } else {\n          var [, end] = Range.edges(at);\n          var pointRef = Editor.pointRef(editor, end);\n          Transforms.delete(editor, {\n            at\n          });\n          at = pointRef.unref();\n        }\n      }\n\n      if (Point.isPoint(at)) {\n        if (match == null) {\n          if (Text.isText(node)) {\n            match = n => Text.isText(n);\n          } else if (editor.isInline(node)) {\n            match = n => Text.isText(n) || Editor.isInline(editor, n);\n          } else {\n            match = n => Editor.isBlock(editor, n);\n          }\n        }\n\n        var [entry] = Editor.nodes(editor, {\n          at: at.path,\n          match,\n          mode,\n          voids\n        });\n\n        if (entry) {\n          var [, _matchPath] = entry;\n          var pathRef = Editor.pathRef(editor, _matchPath);\n          var isAtEnd = Editor.isEnd(editor, at, _matchPath);\n          Transforms.splitNodes(editor, {\n            at,\n            match,\n            mode,\n            voids\n          });\n          var path = pathRef.unref();\n          at = isAtEnd ? Path.next(path) : path;\n        } else {\n          return;\n        }\n      }\n\n      var parentPath = Path.parent(at);\n      var index = at[at.length - 1];\n\n      if (!voids && Editor.void(editor, {\n        at: parentPath\n      })) {\n        return;\n      }\n\n      for (var _node of nodes) {\n        var _path = parentPath.concat(index);\n\n        index++;\n        editor.apply({\n          type: 'insert_node',\n          path: _path,\n          node: _node\n        });\n      }\n\n      if (select) {\n        var point = Editor.end(editor, at);\n\n        if (point) {\n          Transforms.select(editor, point);\n        }\n      }\n    });\n  },\n\n  /**\r\n   * Lift nodes at a specific location upwards in the document tree, splitting\r\n   * their parent in two if necessary.\r\n   */\n  liftNodes(editor) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    Editor.withoutNormalizing(editor, () => {\n      var {\n        at = editor.selection,\n        mode = 'lowest',\n        voids = false\n      } = options;\n      var {\n        match\n      } = options;\n\n      if (match == null) {\n        match = Path.isPath(at) ? matchPath(editor, at) : n => Editor.isBlock(editor, n);\n      }\n\n      if (!at) {\n        return;\n      }\n\n      var matches = Editor.nodes(editor, {\n        at,\n        match,\n        mode,\n        voids\n      });\n      var pathRefs = Array.from(matches, (_ref) => {\n        var [, p] = _ref;\n        return Editor.pathRef(editor, p);\n      });\n\n      for (var pathRef of pathRefs) {\n        var path = pathRef.unref();\n\n        if (path.length < 2) {\n          throw new Error(\"Cannot lift node at a path [\".concat(path, \"] because it has a depth of less than `2`.\"));\n        }\n\n        var parentNodeEntry = Editor.node(editor, Path.parent(path));\n        var [parent, parentPath] = parentNodeEntry;\n        var index = path[path.length - 1];\n        var {\n          length\n        } = parent.children;\n\n        if (length === 1) {\n          var toPath = Path.next(parentPath);\n          Transforms.moveNodes(editor, {\n            at: path,\n            to: toPath,\n            voids\n          });\n          Transforms.removeNodes(editor, {\n            at: parentPath,\n            voids\n          });\n        } else if (index === 0) {\n          Transforms.moveNodes(editor, {\n            at: path,\n            to: parentPath,\n            voids\n          });\n        } else if (index === length - 1) {\n          var _toPath = Path.next(parentPath);\n\n          Transforms.moveNodes(editor, {\n            at: path,\n            to: _toPath,\n            voids\n          });\n        } else {\n          var splitPath = Path.next(path);\n\n          var _toPath2 = Path.next(parentPath);\n\n          Transforms.splitNodes(editor, {\n            at: splitPath,\n            voids\n          });\n          Transforms.moveNodes(editor, {\n            at: path,\n            to: _toPath2,\n            voids\n          });\n        }\n      }\n    });\n  },\n\n  /**\r\n   * Merge a node at a location with the previous node of the same depth,\r\n   * removing any empty containing nodes after the merge if necessary.\r\n   */\n  mergeNodes(editor) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    Editor.withoutNormalizing(editor, () => {\n      var {\n        match,\n        at = editor.selection\n      } = options;\n      var {\n        hanging = false,\n        voids = false,\n        mode = 'lowest'\n      } = options;\n\n      if (!at) {\n        return;\n      }\n\n      if (match == null) {\n        if (Path.isPath(at)) {\n          var [parent] = Editor.parent(editor, at);\n\n          match = n => parent.children.includes(n);\n        } else {\n          match = n => Editor.isBlock(editor, n);\n        }\n      }\n\n      if (!hanging && Range.isRange(at)) {\n        at = Editor.unhangRange(editor, at);\n      }\n\n      if (Range.isRange(at)) {\n        if (Range.isCollapsed(at)) {\n          at = at.anchor;\n        } else {\n          var [, end] = Range.edges(at);\n          var pointRef = Editor.pointRef(editor, end);\n          Transforms.delete(editor, {\n            at\n          });\n          at = pointRef.unref();\n\n          if (options.at == null) {\n            Transforms.select(editor, at);\n          }\n        }\n      }\n\n      var [current] = Editor.nodes(editor, {\n        at,\n        match,\n        voids,\n        mode\n      });\n      var prev = Editor.previous(editor, {\n        at,\n        match,\n        voids,\n        mode\n      });\n\n      if (!current || !prev) {\n        return;\n      }\n\n      var [node, path] = current;\n      var [prevNode, prevPath] = prev;\n\n      if (path.length === 0 || prevPath.length === 0) {\n        return;\n      }\n\n      var newPath = Path.next(prevPath);\n      var commonPath = Path.common(path, prevPath);\n      var isPreviousSibling = Path.isSibling(path, prevPath);\n      var levels = Array.from(Editor.levels(editor, {\n        at: path\n      }), (_ref2) => {\n        var [n] = _ref2;\n        return n;\n      }).slice(commonPath.length).slice(0, -1); // Determine if the merge will leave an ancestor of the path empty as a\n      // result, in which case we'll want to remove it after merging.\n\n      var emptyAncestor = Editor.above(editor, {\n        at: path,\n        mode: 'highest',\n        match: n => levels.includes(n) && Element.isElement(n) && n.children.length === 1\n      });\n      var emptyRef = emptyAncestor && Editor.pathRef(editor, emptyAncestor[1]);\n      var properties;\n      var position; // Ensure that the nodes are equivalent, and figure out what the position\n      // and extra properties of the merge will be.\n\n      if (Text.isText(node) && Text.isText(prevNode)) {\n        var rest = _objectWithoutProperties(node, [\"text\"]);\n\n        position = prevNode.text.length;\n        properties = rest;\n      } else if (Element.isElement(node) && Element.isElement(prevNode)) {\n        var rest = _objectWithoutProperties(node, [\"children\"]);\n\n        position = prevNode.children.length;\n        properties = rest;\n      } else {\n        throw new Error(\"Cannot merge the node at path [\".concat(path, \"] with the previous sibling because it is not the same kind: \").concat(JSON.stringify(node), \" \").concat(JSON.stringify(prevNode)));\n      } // If the node isn't already the next sibling of the previous node, move\n      // it so that it is before merging.\n\n\n      if (!isPreviousSibling) {\n        Transforms.moveNodes(editor, {\n          at: path,\n          to: newPath,\n          voids\n        });\n      } // If there was going to be an empty ancestor of the node that was merged,\n      // we remove it from the tree.\n\n\n      if (emptyRef) {\n        Transforms.removeNodes(editor, {\n          at: emptyRef.current,\n          voids\n        });\n      } // If the target node that we're merging with is empty, remove it instead\n      // of merging the two. This is a common rich text editor behavior to\n      // prevent losing formatting when deleting entire nodes when you have a\n      // hanging selection.\n\n\n      if (Element.isElement(prevNode) && Editor.isEmpty(editor, prevNode) || Text.isText(prevNode) && prevNode.text === '') {\n        Transforms.removeNodes(editor, {\n          at: prevPath,\n          voids\n        });\n      } else {\n        editor.apply({\n          type: 'merge_node',\n          path: newPath,\n          position,\n          properties\n        });\n      }\n\n      if (emptyRef) {\n        emptyRef.unref();\n      }\n    });\n  },\n\n  /**\r\n   * Move the nodes at a location to a new location.\r\n   */\n  moveNodes(editor, options) {\n    Editor.withoutNormalizing(editor, () => {\n      var {\n        to,\n        at = editor.selection,\n        mode = 'lowest',\n        voids = false\n      } = options;\n      var {\n        match\n      } = options;\n\n      if (!at) {\n        return;\n      }\n\n      if (match == null) {\n        match = Path.isPath(at) ? matchPath(editor, at) : n => Editor.isBlock(editor, n);\n      }\n\n      var toRef = Editor.pathRef(editor, to);\n      var targets = Editor.nodes(editor, {\n        at,\n        match,\n        mode,\n        voids\n      });\n      var pathRefs = Array.from(targets, (_ref3) => {\n        var [, p] = _ref3;\n        return Editor.pathRef(editor, p);\n      });\n\n      for (var pathRef of pathRefs) {\n        var path = pathRef.unref();\n        var newPath = toRef.current;\n\n        if (path.length !== 0) {\n          editor.apply({\n            type: 'move_node',\n            path,\n            newPath\n          });\n        }\n      }\n\n      toRef.unref();\n    });\n  },\n\n  /**\r\n   * Remove the nodes at a specific location in the document.\r\n   */\n  removeNodes(editor) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    Editor.withoutNormalizing(editor, () => {\n      var {\n        hanging = false,\n        voids = false,\n        mode = 'lowest'\n      } = options;\n      var {\n        at = editor.selection,\n        match\n      } = options;\n\n      if (!at) {\n        return;\n      }\n\n      if (match == null) {\n        match = Path.isPath(at) ? matchPath(editor, at) : n => Editor.isBlock(editor, n);\n      }\n\n      if (!hanging && Range.isRange(at)) {\n        at = Editor.unhangRange(editor, at);\n      }\n\n      var depths = Editor.nodes(editor, {\n        at,\n        match,\n        mode,\n        voids\n      });\n      var pathRefs = Array.from(depths, (_ref4) => {\n        var [, p] = _ref4;\n        return Editor.pathRef(editor, p);\n      });\n\n      for (var pathRef of pathRefs) {\n        var path = pathRef.unref();\n\n        if (path) {\n          var [node] = Editor.node(editor, path);\n          editor.apply({\n            type: 'remove_node',\n            path,\n            node\n          });\n        }\n      }\n    });\n  },\n\n  /**\r\n   * Set new properties on the nodes at a location.\r\n   */\n  setNodes(editor, props) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    Editor.withoutNormalizing(editor, () => {\n      var {\n        match,\n        at = editor.selection\n      } = options;\n      var {\n        hanging = false,\n        mode = 'lowest',\n        split = false,\n        voids = false\n      } = options;\n\n      if (!at) {\n        return;\n      }\n\n      if (match == null) {\n        match = Path.isPath(at) ? matchPath(editor, at) : n => Editor.isBlock(editor, n);\n      }\n\n      if (!hanging && Range.isRange(at)) {\n        at = Editor.unhangRange(editor, at);\n      }\n\n      if (split && Range.isRange(at)) {\n        var rangeRef = Editor.rangeRef(editor, at, {\n          affinity: 'inward'\n        });\n        var [start, end] = Range.edges(at);\n        var splitMode = mode === 'lowest' ? 'lowest' : 'highest';\n        Transforms.splitNodes(editor, {\n          at: end,\n          match,\n          mode: splitMode,\n          voids\n        });\n        Transforms.splitNodes(editor, {\n          at: start,\n          match,\n          mode: splitMode,\n          voids\n        });\n        at = rangeRef.unref();\n\n        if (options.at == null) {\n          Transforms.select(editor, at);\n        }\n      }\n\n      for (var [node, path] of Editor.nodes(editor, {\n        at,\n        match,\n        mode,\n        voids\n      })) {\n        var properties = {};\n        var newProperties = {}; // You can't set properties on the editor node.\n\n        if (path.length === 0) {\n          continue;\n        }\n\n        for (var k in props) {\n          if (k === 'children' || k === 'text') {\n            continue;\n          }\n\n          if (props[k] !== node[k]) {\n            properties[k] = node[k];\n            newProperties[k] = props[k];\n          }\n        }\n\n        if (Object.keys(newProperties).length !== 0) {\n          editor.apply({\n            type: 'set_node',\n            path,\n            properties,\n            newProperties\n          });\n        }\n      }\n    });\n  },\n\n  /**\r\n   * Split the nodes at a specific location.\r\n   */\n  splitNodes(editor) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    Editor.withoutNormalizing(editor, () => {\n      var {\n        mode = 'lowest',\n        voids = false\n      } = options;\n      var {\n        match,\n        at = editor.selection,\n        height = 0,\n        always = false\n      } = options;\n\n      if (match == null) {\n        match = n => Editor.isBlock(editor, n);\n      }\n\n      if (Range.isRange(at)) {\n        at = deleteRange(editor, at);\n      } // If the target is a path, the default height-skipping and position\n      // counters need to account for us potentially splitting at a non-leaf.\n\n\n      if (Path.isPath(at)) {\n        var path = at;\n        var point = Editor.point(editor, path);\n        var [parent] = Editor.parent(editor, path);\n\n        match = n => n === parent;\n\n        height = point.path.length - path.length + 1;\n        at = point;\n        always = true;\n      }\n\n      if (!at) {\n        return;\n      }\n\n      var beforeRef = Editor.pointRef(editor, at, {\n        affinity: 'backward'\n      });\n      var [highest] = Editor.nodes(editor, {\n        at,\n        match,\n        mode,\n        voids\n      });\n\n      if (!highest) {\n        return;\n      }\n\n      var voidMatch = Editor.void(editor, {\n        at,\n        mode: 'highest'\n      });\n      var nudge = 0;\n\n      if (!voids && voidMatch) {\n        var [voidNode, voidPath] = voidMatch;\n\n        if (Element.isElement(voidNode) && editor.isInline(voidNode)) {\n          var after = Editor.after(editor, voidPath);\n\n          if (!after) {\n            var text = {\n              text: ''\n            };\n            var afterPath = Path.next(voidPath);\n            Transforms.insertNodes(editor, text, {\n              at: afterPath,\n              voids\n            });\n            after = Editor.point(editor, afterPath);\n          }\n\n          at = after;\n          always = true;\n        }\n\n        var siblingHeight = at.path.length - voidPath.length;\n        height = siblingHeight + 1;\n        always = true;\n      }\n\n      var afterRef = Editor.pointRef(editor, at);\n      var depth = at.path.length - height;\n      var [, highestPath] = highest;\n      var lowestPath = at.path.slice(0, depth);\n      var position = height === 0 ? at.offset : at.path[depth] + nudge;\n\n      for (var [node, _path2] of Editor.levels(editor, {\n        at: lowestPath,\n        reverse: true,\n        voids\n      })) {\n        var split = false;\n\n        if (_path2.length < highestPath.length || _path2.length === 0 || !voids && Editor.isVoid(editor, node)) {\n          break;\n        }\n\n        var _point = beforeRef.current;\n        var isEnd = Editor.isEnd(editor, _point, _path2);\n\n        if (always || !beforeRef || !Editor.isEdge(editor, _point, _path2)) {\n          split = true;\n\n          var properties = _objectWithoutProperties(node, [\"text\", \"children\"]);\n\n          editor.apply({\n            type: 'split_node',\n            path: _path2,\n            position,\n            properties\n          });\n        }\n\n        position = _path2[_path2.length - 1] + (split || isEnd ? 1 : 0);\n      }\n\n      if (options.at == null) {\n        var _point2 = afterRef.current || Editor.end(editor, []);\n\n        Transforms.select(editor, _point2);\n      }\n\n      beforeRef.unref();\n      afterRef.unref();\n    });\n  },\n\n  /**\r\n   * Unset properties on the nodes at a location.\r\n   */\n  unsetNodes(editor, props) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n    if (!Array.isArray(props)) {\n      props = [props];\n    }\n\n    var obj = {};\n\n    for (var key of props) {\n      obj[key] = null;\n    }\n\n    Transforms.setNodes(editor, obj, options);\n  },\n\n  /**\r\n   * Unwrap the nodes at a location from a parent node, splitting the parent if\r\n   * necessary to ensure that only the content in the range is unwrapped.\r\n   */\n  unwrapNodes(editor, options) {\n    Editor.withoutNormalizing(editor, () => {\n      var {\n        mode = 'lowest',\n        split = false,\n        voids = false\n      } = options;\n      var {\n        at = editor.selection,\n        match\n      } = options;\n\n      if (!at) {\n        return;\n      }\n\n      if (match == null) {\n        match = Path.isPath(at) ? matchPath(editor, at) : n => Editor.isBlock(editor, n);\n      }\n\n      if (Path.isPath(at)) {\n        at = Editor.range(editor, at);\n      }\n\n      var rangeRef = Range.isRange(at) ? Editor.rangeRef(editor, at) : null;\n      var matches = Editor.nodes(editor, {\n        at,\n        match,\n        mode,\n        voids\n      });\n      var pathRefs = Array.from(matches, (_ref5) => {\n        var [, p] = _ref5;\n        return Editor.pathRef(editor, p);\n      });\n\n      var _loop = function _loop(pathRef) {\n        var path = pathRef.unref();\n        var [node] = Editor.node(editor, path);\n        var range = Editor.range(editor, path);\n\n        if (split && rangeRef) {\n          range = Range.intersection(rangeRef.current, range);\n        }\n\n        Transforms.liftNodes(editor, {\n          at: range,\n          match: n => node.children.includes(n),\n          voids\n        });\n      };\n\n      for (var pathRef of pathRefs) {\n        _loop(pathRef);\n      }\n\n      if (rangeRef) {\n        rangeRef.unref();\n      }\n    });\n  },\n\n  /**\r\n   * Wrap the nodes at a location in a new container node, splitting the edges\r\n   * of the range first to ensure that only the content in the range is wrapped.\r\n   */\n  wrapNodes(editor, element) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    Editor.withoutNormalizing(editor, () => {\n      var {\n        mode = 'lowest',\n        split = false,\n        voids = false\n      } = options;\n      var {\n        match,\n        at = editor.selection\n      } = options;\n\n      if (!at) {\n        return;\n      }\n\n      if (match == null) {\n        if (Path.isPath(at)) {\n          match = matchPath(editor, at);\n        } else if (editor.isInline(element)) {\n          match = n => Editor.isInline(editor, n) || Text.isText(n);\n        } else {\n          match = n => Editor.isBlock(editor, n);\n        }\n      }\n\n      if (split && Range.isRange(at)) {\n        var [start, end] = Range.edges(at);\n        var rangeRef = Editor.rangeRef(editor, at, {\n          affinity: 'inward'\n        });\n        Transforms.splitNodes(editor, {\n          at: end,\n          match,\n          voids\n        });\n        Transforms.splitNodes(editor, {\n          at: start,\n          match,\n          voids\n        });\n        at = rangeRef.unref();\n\n        if (options.at == null) {\n          Transforms.select(editor, at);\n        }\n      }\n\n      var roots = Array.from(Editor.nodes(editor, {\n        at,\n        match: editor.isInline(element) ? n => Editor.isBlock(editor, n) : n => Editor.isEditor(n),\n        mode: 'lowest',\n        voids\n      }));\n\n      for (var [, rootPath] of roots) {\n        var a = Range.isRange(at) ? Range.intersection(at, Editor.range(editor, rootPath)) : at;\n\n        if (!a) {\n          continue;\n        }\n\n        var matches = Array.from(Editor.nodes(editor, {\n          at: a,\n          match,\n          mode,\n          voids\n        }));\n\n        if (matches.length > 0) {\n          (function () {\n            var [first] = matches;\n            var last = matches[matches.length - 1];\n            var [, firstPath] = first;\n            var [, lastPath] = last;\n            var commonPath = Path.equals(firstPath, lastPath) ? Path.parent(firstPath) : Path.common(firstPath, lastPath);\n            var range = Editor.range(editor, firstPath, lastPath);\n            var commonNodeEntry = Editor.node(editor, commonPath);\n            var [commonNode] = commonNodeEntry;\n            var depth = commonPath.length + 1;\n            var wrapperPath = Path.next(lastPath.slice(0, depth));\n\n            var wrapper = _objectSpread$6({}, element, {\n              children: []\n            });\n\n            Transforms.insertNodes(editor, wrapper, {\n              at: wrapperPath,\n              voids\n            });\n            Transforms.moveNodes(editor, {\n              at: range,\n              match: n => commonNode.children.includes(n),\n              to: wrapperPath.concat(0),\n              voids\n            });\n          })();\n        }\n      }\n    });\n  }\n\n};\n/**\r\n * Convert a range into a point by deleting it's content.\r\n */\n\nvar deleteRange = (editor, range) => {\n  if (Range.isCollapsed(range)) {\n    return range.anchor;\n  } else {\n    var [, end] = Range.edges(range);\n    var pointRef = Editor.pointRef(editor, end);\n    Transforms.delete(editor, {\n      at: range\n    });\n    return pointRef.unref();\n  }\n};\n\nvar matchPath = (editor, path) => {\n  var [node] = Editor.node(editor, path);\n  return n => n === node;\n};\n\nfunction ownKeys$7(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread$7(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys$7(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys$7(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\nvar SelectionTransforms = {\n  /**\r\n   * Collapse the selection.\r\n   */\n  collapse(editor) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var {\n      edge = 'anchor'\n    } = options;\n    var {\n      selection\n    } = editor;\n\n    if (!selection) {\n      return;\n    } else if (edge === 'anchor') {\n      Transforms.select(editor, selection.anchor);\n    } else if (edge === 'focus') {\n      Transforms.select(editor, selection.focus);\n    } else if (edge === 'start') {\n      var [start] = Range.edges(selection);\n      Transforms.select(editor, start);\n    } else if (edge === 'end') {\n      var [, end] = Range.edges(selection);\n      Transforms.select(editor, end);\n    }\n  },\n\n  /**\r\n   * Unset the selection.\r\n   */\n  deselect(editor) {\n    var {\n      selection\n    } = editor;\n\n    if (selection) {\n      editor.apply({\n        type: 'set_selection',\n        properties: selection,\n        newProperties: null\n      });\n    }\n  },\n\n  /**\r\n   * Move the selection's point forward or backward.\r\n   */\n  move(editor) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var {\n      selection\n    } = editor;\n    var {\n      distance = 1,\n      unit = 'character',\n      reverse = false\n    } = options;\n    var {\n      edge = null\n    } = options;\n\n    if (!selection) {\n      return;\n    }\n\n    if (edge === 'start') {\n      edge = Range.isBackward(selection) ? 'focus' : 'anchor';\n    }\n\n    if (edge === 'end') {\n      edge = Range.isBackward(selection) ? 'anchor' : 'focus';\n    }\n\n    var {\n      anchor,\n      focus\n    } = selection;\n    var opts = {\n      distance,\n      unit\n    };\n    var props = {};\n\n    if (edge == null || edge === 'anchor') {\n      var point = reverse ? Editor.before(editor, anchor, opts) : Editor.after(editor, anchor, opts);\n\n      if (point) {\n        props.anchor = point;\n      }\n    }\n\n    if (edge == null || edge === 'focus') {\n      var _point = reverse ? Editor.before(editor, focus, opts) : Editor.after(editor, focus, opts);\n\n      if (_point) {\n        props.focus = _point;\n      }\n    }\n\n    Transforms.setSelection(editor, props);\n  },\n\n  /**\r\n   * Set the selection to a new value.\r\n   */\n  select(editor, target) {\n    var {\n      selection\n    } = editor;\n    target = Editor.range(editor, target);\n\n    if (selection) {\n      Transforms.setSelection(editor, target);\n      return;\n    }\n\n    if (!Range.isRange(target)) {\n      throw new Error(\"When setting the selection and the current selection is `null` you must provide at least an `anchor` and `focus`, but you passed: \".concat(JSON.stringify(target)));\n    }\n\n    editor.apply({\n      type: 'set_selection',\n      properties: selection,\n      newProperties: target\n    });\n  },\n\n  /**\r\n   * Set new properties on one of the selection's points.\r\n   */\n  setPoint(editor, props, options) {\n    var {\n      selection\n    } = editor;\n    var {\n      edge = 'both'\n    } = options;\n\n    if (!selection) {\n      return;\n    }\n\n    if (edge === 'start') {\n      edge = Range.isBackward(selection) ? 'focus' : 'anchor';\n    }\n\n    if (edge === 'end') {\n      edge = Range.isBackward(selection) ? 'anchor' : 'focus';\n    }\n\n    var {\n      anchor,\n      focus\n    } = selection;\n    var point = edge === 'anchor' ? anchor : focus;\n    Transforms.setSelection(editor, {\n      [edge === 'anchor' ? 'anchor' : 'focus']: _objectSpread$7({}, point, {}, props)\n    });\n  },\n\n  /**\r\n   * Set new properties on the selection.\r\n   */\n  setSelection(editor, props) {\n    var {\n      selection\n    } = editor;\n    var oldProps = {};\n    var newProps = {};\n\n    if (!selection) {\n      return;\n    }\n\n    for (var k in props) {\n      if (k === 'anchor' && props.anchor != null && !Point.equals(props.anchor, selection.anchor) || k === 'focus' && props.focus != null && !Point.equals(props.focus, selection.focus) || k !== 'anchor' && k !== 'focus' && props[k] !== selection[k]) {\n        oldProps[k] = selection[k];\n        newProps[k] = props[k];\n      }\n    }\n\n    if (Object.keys(oldProps).length > 0) {\n      editor.apply({\n        type: 'set_selection',\n        properties: oldProps,\n        newProperties: newProps\n      });\n    }\n  }\n\n};\n\nvar TextTransforms = {\n  /**\r\n   * Delete content in the editor.\r\n   */\n  delete(editor) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    Editor.withoutNormalizing(editor, () => {\n      var {\n        reverse = false,\n        unit = 'character',\n        distance = 1,\n        voids = false\n      } = options;\n      var {\n        at = editor.selection,\n        hanging = false\n      } = options;\n\n      if (!at) {\n        return;\n      }\n\n      if (Range.isRange(at) && Range.isCollapsed(at)) {\n        at = at.anchor;\n      }\n\n      if (Point.isPoint(at)) {\n        var furthestVoid = Editor.void(editor, {\n          at,\n          mode: 'highest'\n        });\n\n        if (!voids && furthestVoid) {\n          var [, voidPath] = furthestVoid;\n          at = voidPath;\n        } else {\n          var opts = {\n            unit,\n            distance\n          };\n          var target = reverse ? Editor.before(editor, at, opts) || Editor.start(editor, []) : Editor.after(editor, at, opts) || Editor.end(editor, []);\n          at = {\n            anchor: at,\n            focus: target\n          };\n          hanging = true;\n        }\n      }\n\n      if (Path.isPath(at)) {\n        Transforms.removeNodes(editor, {\n          at,\n          voids\n        });\n        return;\n      }\n\n      if (Range.isCollapsed(at)) {\n        return;\n      }\n\n      if (!hanging) {\n        at = Editor.unhangRange(editor, at, {\n          voids\n        });\n      }\n\n      var [start, end] = Range.edges(at);\n      var startBlock = Editor.above(editor, {\n        match: n => Editor.isBlock(editor, n),\n        at: start,\n        voids\n      });\n      var endBlock = Editor.above(editor, {\n        match: n => Editor.isBlock(editor, n),\n        at: end,\n        voids\n      });\n      var isAcrossBlocks = startBlock && endBlock && !Path.equals(startBlock[1], endBlock[1]);\n      var isSingleText = Path.equals(start.path, end.path);\n      var startVoid = voids ? null : Editor.void(editor, {\n        at: start,\n        mode: 'highest'\n      });\n      var endVoid = voids ? null : Editor.void(editor, {\n        at: end,\n        mode: 'highest'\n      }); // If the start or end points are inside an inline void, nudge them out.\n\n      if (startVoid) {\n        var before = Editor.before(editor, start);\n\n        if (before && startBlock && Path.isAncestor(startBlock[1], before.path)) {\n          start = before;\n        }\n      }\n\n      if (endVoid) {\n        var after = Editor.after(editor, end);\n\n        if (after && endBlock && Path.isAncestor(endBlock[1], after.path)) {\n          end = after;\n        }\n      } // Get the highest nodes that are completely inside the range, as well as\n      // the start and end nodes.\n\n\n      var matches = [];\n      var lastPath;\n\n      for (var entry of Editor.nodes(editor, {\n        at,\n        voids\n      })) {\n        var [node, path] = entry;\n\n        if (lastPath && Path.compare(path, lastPath) === 0) {\n          continue;\n        }\n\n        if (!voids && Editor.isVoid(editor, node) || !Path.isCommon(path, start.path) && !Path.isCommon(path, end.path)) {\n          matches.push(entry);\n          lastPath = path;\n        }\n      }\n\n      var pathRefs = Array.from(matches, (_ref) => {\n        var [, p] = _ref;\n        return Editor.pathRef(editor, p);\n      });\n      var startRef = Editor.pointRef(editor, start);\n      var endRef = Editor.pointRef(editor, end);\n\n      if (!isSingleText && !startVoid) {\n        var _point = startRef.current;\n        var [_node] = Editor.leaf(editor, _point);\n        var {\n          path: _path\n        } = _point;\n        var {\n          offset\n        } = start;\n\n        var text = _node.text.slice(offset);\n\n        editor.apply({\n          type: 'remove_text',\n          path: _path,\n          offset,\n          text\n        });\n      }\n\n      for (var pathRef of pathRefs) {\n        var _path2 = pathRef.unref();\n\n        Transforms.removeNodes(editor, {\n          at: _path2,\n          voids\n        });\n      }\n\n      if (!endVoid) {\n        var _point2 = endRef.current;\n        var [_node2] = Editor.leaf(editor, _point2);\n        var {\n          path: _path3\n        } = _point2;\n\n        var _offset = isSingleText ? start.offset : 0;\n\n        var _text = _node2.text.slice(_offset, end.offset);\n\n        editor.apply({\n          type: 'remove_text',\n          path: _path3,\n          offset: _offset,\n          text: _text\n        });\n      }\n\n      if (!isSingleText && isAcrossBlocks && endRef.current && startRef.current) {\n        Transforms.mergeNodes(editor, {\n          at: endRef.current,\n          hanging: true,\n          voids\n        });\n      }\n\n      var point = endRef.unref() || startRef.unref();\n\n      if (options.at == null && point) {\n        Transforms.select(editor, point);\n      }\n    });\n  },\n\n  /**\r\n   * Insert a fragment at a specific location in the editor.\r\n   */\n  insertFragment(editor, fragment) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    Editor.withoutNormalizing(editor, () => {\n      var {\n        hanging = false,\n        voids = false\n      } = options;\n      var {\n        at = editor.selection\n      } = options;\n\n      if (!fragment.length) {\n        return;\n      }\n\n      if (!at) {\n        return;\n      } else if (Range.isRange(at)) {\n        if (!hanging) {\n          at = Editor.unhangRange(editor, at);\n        }\n\n        if (Range.isCollapsed(at)) {\n          at = at.anchor;\n        } else {\n          var [, end] = Range.edges(at);\n\n          if (!voids && Editor.void(editor, {\n            at: end\n          })) {\n            return;\n          }\n\n          var pointRef = Editor.pointRef(editor, end);\n          Transforms.delete(editor, {\n            at\n          });\n          at = pointRef.unref();\n        }\n      } else if (Path.isPath(at)) {\n        at = Editor.start(editor, at);\n      }\n\n      if (!voids && Editor.void(editor, {\n        at\n      })) {\n        return;\n      } // If the insert point is at the edge of an inline node, move it outside\n      // instead since it will need to be split otherwise.\n\n\n      var inlineElementMatch = Editor.above(editor, {\n        at,\n        match: n => Editor.isInline(editor, n),\n        mode: 'highest',\n        voids\n      });\n\n      if (inlineElementMatch) {\n        var [, _inlinePath] = inlineElementMatch;\n\n        if (Editor.isEnd(editor, at, _inlinePath)) {\n          var after = Editor.after(editor, _inlinePath);\n          at = after;\n        } else if (Editor.isStart(editor, at, _inlinePath)) {\n          var before = Editor.before(editor, _inlinePath);\n          at = before;\n        }\n      }\n\n      var blockMatch = Editor.above(editor, {\n        match: n => Editor.isBlock(editor, n),\n        at,\n        voids\n      });\n      var [, blockPath] = blockMatch;\n      var isBlockStart = Editor.isStart(editor, at, blockPath);\n      var isBlockEnd = Editor.isEnd(editor, at, blockPath);\n      var mergeStart = !isBlockStart || isBlockStart && isBlockEnd;\n      var mergeEnd = !isBlockEnd;\n      var [, firstPath] = Node.first({\n        children: fragment\n      }, []);\n      var [, lastPath] = Node.last({\n        children: fragment\n      }, []);\n      var matches = [];\n\n      var matcher = (_ref2) => {\n        var [n, p] = _ref2;\n\n        if (mergeStart && Path.isAncestor(p, firstPath) && Element.isElement(n) && !editor.isVoid(n) && !editor.isInline(n)) {\n          return false;\n        }\n\n        if (mergeEnd && Path.isAncestor(p, lastPath) && Element.isElement(n) && !editor.isVoid(n) && !editor.isInline(n)) {\n          return false;\n        }\n\n        return true;\n      };\n\n      for (var entry of Node.nodes({\n        children: fragment\n      }, {\n        pass: matcher\n      })) {\n        if (entry[1].length > 0 && matcher(entry)) {\n          matches.push(entry);\n        }\n      }\n\n      var starts = [];\n      var middles = [];\n      var ends = [];\n      var starting = true;\n      var hasBlocks = false;\n\n      for (var [node] of matches) {\n        if (Element.isElement(node) && !editor.isInline(node)) {\n          starting = false;\n          hasBlocks = true;\n          middles.push(node);\n        } else if (starting) {\n          starts.push(node);\n        } else {\n          ends.push(node);\n        }\n      }\n\n      var [inlineMatch] = Editor.nodes(editor, {\n        at,\n        match: n => Text.isText(n) || Editor.isInline(editor, n),\n        mode: 'highest',\n        voids\n      });\n      var [, inlinePath] = inlineMatch;\n      var isInlineStart = Editor.isStart(editor, at, inlinePath);\n      var isInlineEnd = Editor.isEnd(editor, at, inlinePath);\n      var middleRef = Editor.pathRef(editor, isBlockEnd ? Path.next(blockPath) : blockPath);\n      var endRef = Editor.pathRef(editor, isInlineEnd ? Path.next(inlinePath) : inlinePath);\n      Transforms.splitNodes(editor, {\n        at,\n        match: n => hasBlocks ? Editor.isBlock(editor, n) : Text.isText(n) || Editor.isInline(editor, n),\n        mode: hasBlocks ? 'lowest' : 'highest',\n        voids\n      });\n      var startRef = Editor.pathRef(editor, !isInlineStart || isInlineStart && isInlineEnd ? Path.next(inlinePath) : inlinePath);\n      Transforms.insertNodes(editor, starts, {\n        at: startRef.current,\n        match: n => Text.isText(n) || Editor.isInline(editor, n),\n        mode: 'highest',\n        voids\n      });\n      Transforms.insertNodes(editor, middles, {\n        at: middleRef.current,\n        match: n => Editor.isBlock(editor, n),\n        mode: 'lowest',\n        voids\n      });\n      Transforms.insertNodes(editor, ends, {\n        at: endRef.current,\n        match: n => Text.isText(n) || Editor.isInline(editor, n),\n        mode: 'highest',\n        voids\n      });\n\n      if (!options.at) {\n        var path;\n\n        if (ends.length > 0) {\n          path = Path.previous(endRef.current);\n        } else if (middles.length > 0) {\n          path = Path.previous(middleRef.current);\n        } else {\n          path = Path.previous(startRef.current);\n        }\n\n        var _end = Editor.end(editor, path);\n\n        Transforms.select(editor, _end);\n      }\n\n      startRef.unref();\n      middleRef.unref();\n      endRef.unref();\n    });\n  },\n\n  /**\r\n   * Insert a string of text in the Editor.\r\n   */\n  insertText(editor, text) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    Editor.withoutNormalizing(editor, () => {\n      var {\n        voids = false\n      } = options;\n      var {\n        at = editor.selection\n      } = options;\n\n      if (!at) {\n        return;\n      }\n\n      if (Path.isPath(at)) {\n        at = Editor.range(editor, at);\n      }\n\n      if (Range.isRange(at)) {\n        if (Range.isCollapsed(at)) {\n          at = at.anchor;\n        } else {\n          var end = Range.end(at);\n\n          if (!voids && Editor.void(editor, {\n            at: end\n          })) {\n            return;\n          }\n\n          var pointRef = Editor.pointRef(editor, end);\n          Transforms.delete(editor, {\n            at,\n            voids\n          });\n          at = pointRef.unref();\n          Transforms.setSelection(editor, {\n            anchor: at,\n            focus: at\n          });\n        }\n      }\n\n      if (!voids && Editor.void(editor, {\n        at\n      })) {\n        return;\n      }\n\n      var {\n        path,\n        offset\n      } = at;\n      editor.apply({\n        type: 'insert_text',\n        path,\n        offset,\n        text\n      });\n    });\n  }\n\n};\n\nfunction ownKeys$8(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread$8(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys$8(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys$8(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\nvar Transforms = _objectSpread$8({}, GeneralTransforms, {}, NodeTransforms, {}, SelectionTransforms, {}, TextTransforms);\n\nfunction ownKeys$9(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread$9(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys$9(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys$9(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n/**\r\n * Create a new Slate `Editor` object.\r\n */\n\nvar createEditor = () => {\n  var editor = {\n    children: [],\n    operations: [],\n    selection: null,\n    marks: null,\n    isInline: () => false,\n    isVoid: () => false,\n    onChange: () => {},\n    apply: op => {\n      for (var ref of Editor.pathRefs(editor)) {\n        PathRef.transform(ref, op);\n      }\n\n      for (var _ref of Editor.pointRefs(editor)) {\n        PointRef.transform(_ref, op);\n      }\n\n      for (var _ref2 of Editor.rangeRefs(editor)) {\n        RangeRef.transform(_ref2, op);\n      }\n\n      var set = new Set();\n      var dirtyPaths = [];\n\n      var add = path => {\n        if (path) {\n          var key = path.join(',');\n\n          if (!set.has(key)) {\n            set.add(key);\n            dirtyPaths.push(path);\n          }\n        }\n      };\n\n      var oldDirtyPaths = DIRTY_PATHS.get(editor) || [];\n      var newDirtyPaths = getDirtyPaths(op);\n\n      for (var path of oldDirtyPaths) {\n        var newPath = Path.transform(path, op);\n        add(newPath);\n      }\n\n      for (var _path of newDirtyPaths) {\n        add(_path);\n      }\n\n      DIRTY_PATHS.set(editor, dirtyPaths);\n      Transforms.transform(editor, op);\n      editor.operations.push(op);\n      Editor.normalize(editor); // Clear any formats applied to the cursor if the selection changes.\n\n      if (op.type === 'set_selection') {\n        editor.marks = null;\n      }\n\n      if (!FLUSHING.get(editor)) {\n        FLUSHING.set(editor, true);\n        Promise.resolve().then(() => {\n          FLUSHING.set(editor, false);\n          editor.onChange();\n          editor.operations = [];\n        });\n      }\n    },\n    addMark: (key, value) => {\n      var {\n        selection\n      } = editor;\n\n      if (selection) {\n        if (Range.isExpanded(selection)) {\n          Transforms.setNodes(editor, {\n            [key]: value\n          }, {\n            match: Text.isText,\n            split: true\n          });\n        } else {\n          var marks = _objectSpread$9({}, Editor.marks(editor) || {}, {\n            [key]: value\n          });\n\n          editor.marks = marks;\n          editor.onChange();\n        }\n      }\n    },\n    deleteBackward: unit => {\n      var {\n        selection\n      } = editor;\n\n      if (selection && Range.isCollapsed(selection)) {\n        Transforms.delete(editor, {\n          unit,\n          reverse: true\n        });\n      }\n    },\n    deleteForward: unit => {\n      var {\n        selection\n      } = editor;\n\n      if (selection && Range.isCollapsed(selection)) {\n        Transforms.delete(editor, {\n          unit\n        });\n      }\n    },\n    deleteFragment: () => {\n      var {\n        selection\n      } = editor;\n\n      if (selection && Range.isExpanded(selection)) {\n        Transforms.delete(editor);\n      }\n    },\n    getFragment: () => {\n      var {\n        selection\n      } = editor;\n\n      if (selection) {\n        return Node.fragment(editor, selection);\n      }\n\n      return [];\n    },\n    insertBreak: () => {\n      Transforms.splitNodes(editor, {\n        always: true\n      });\n    },\n    insertFragment: fragment => {\n      Transforms.insertFragment(editor, fragment);\n    },\n    insertNode: node => {\n      Transforms.insertNodes(editor, node);\n    },\n    insertText: text => {\n      var {\n        selection,\n        marks\n      } = editor;\n\n      if (selection) {\n        // If the cursor is at the end of an inline, move it outside of\n        // the inline before inserting\n        if (Range.isCollapsed(selection)) {\n          var inline = Editor.above(editor, {\n            match: n => Editor.isInline(editor, n),\n            mode: 'highest'\n          });\n\n          if (inline) {\n            var [, inlinePath] = inline;\n\n            if (Editor.isEnd(editor, selection.anchor, inlinePath)) {\n              var point = Editor.after(editor, inlinePath);\n              Transforms.setSelection(editor, {\n                anchor: point,\n                focus: point\n              });\n            }\n          }\n        }\n\n        if (marks) {\n          var node = _objectSpread$9({\n            text\n          }, marks);\n\n          Transforms.insertNodes(editor, node);\n        } else {\n          Transforms.insertText(editor, text);\n        }\n\n        editor.marks = null;\n      }\n    },\n    normalizeNode: entry => {\n      var [node, path] = entry; // There are no core normalizations for text nodes.\n\n      if (Text.isText(node)) {\n        return;\n      } // Ensure that block and inline nodes have at least one text child.\n\n\n      if (Element.isElement(node) && node.children.length === 0) {\n        var child = {\n          text: ''\n        };\n        Transforms.insertNodes(editor, child, {\n          at: path.concat(0),\n          voids: true\n        });\n        return;\n      } // Determine whether the node should have block or inline children.\n\n\n      var shouldHaveInlines = Editor.isEditor(node) ? false : Element.isElement(node) && (editor.isInline(node) || node.children.length === 0 || Text.isText(node.children[0]) || editor.isInline(node.children[0])); // Since we'll be applying operations while iterating, keep track of an\n      // index that accounts for any added/removed nodes.\n\n      var n = 0;\n\n      for (var i = 0; i < node.children.length; i++, n++) {\n        var _child = node.children[i];\n        var prev = node.children[i - 1];\n        var isLast = i === node.children.length - 1;\n        var isInlineOrText = Text.isText(_child) || Element.isElement(_child) && editor.isInline(_child); // Only allow block nodes in the top-level children and parent blocks\n        // that only contain block nodes. Similarly, only allow inline nodes in\n        // other inline nodes, or parent blocks that only contain inlines and\n        // text.\n\n        if (isInlineOrText !== shouldHaveInlines) {\n          Transforms.removeNodes(editor, {\n            at: path.concat(n),\n            voids: true\n          });\n          n--;\n        } else if (Element.isElement(_child)) {\n          // Ensure that inline nodes are surrounded by text nodes.\n          if (editor.isInline(_child)) {\n            if (prev == null || !Text.isText(prev)) {\n              var newChild = {\n                text: ''\n              };\n              Transforms.insertNodes(editor, newChild, {\n                at: path.concat(n),\n                voids: true\n              });\n              n++;\n            } else if (isLast) {\n              var _newChild = {\n                text: ''\n              };\n              Transforms.insertNodes(editor, _newChild, {\n                at: path.concat(n + 1),\n                voids: true\n              });\n              n++;\n            }\n          }\n        } else {\n          // Merge adjacent text nodes that are empty or match.\n          if (prev != null && Text.isText(prev)) {\n            if (Text.equals(_child, prev, {\n              loose: true\n            })) {\n              Transforms.mergeNodes(editor, {\n                at: path.concat(n),\n                voids: true\n              });\n              n--;\n            } else if (prev.text === '') {\n              Transforms.removeNodes(editor, {\n                at: path.concat(n - 1),\n                voids: true\n              });\n              n--;\n            } else if (isLast && _child.text === '') {\n              Transforms.removeNodes(editor, {\n                at: path.concat(n),\n                voids: true\n              });\n              n--;\n            }\n          }\n        }\n      }\n    },\n    removeMark: key => {\n      var {\n        selection\n      } = editor;\n\n      if (selection) {\n        if (Range.isExpanded(selection)) {\n          Transforms.unsetNodes(editor, key, {\n            match: Text.isText,\n            split: true\n          });\n        } else {\n          var marks = _objectSpread$9({}, Editor.marks(editor) || {});\n\n          delete marks[key];\n          editor.marks = marks;\n          editor.onChange();\n        }\n      }\n    }\n  };\n  return editor;\n};\n/**\r\n * Get the \"dirty\" paths generated from an operation.\r\n */\n\nvar getDirtyPaths = op => {\n  switch (op.type) {\n    case 'insert_text':\n    case 'remove_text':\n    case 'set_node':\n      {\n        var {\n          path\n        } = op;\n        return Path.levels(path);\n      }\n\n    case 'insert_node':\n      {\n        var {\n          node,\n          path: _path2\n        } = op;\n        var levels = Path.levels(_path2);\n        var descendants = Text.isText(node) ? [] : Array.from(Node.nodes(node), (_ref3) => {\n          var [, p] = _ref3;\n          return _path2.concat(p);\n        });\n        return [...levels, ...descendants];\n      }\n\n    case 'merge_node':\n      {\n        var {\n          path: _path3\n        } = op;\n        var ancestors = Path.ancestors(_path3);\n        var previousPath = Path.previous(_path3);\n        return [...ancestors, previousPath];\n      }\n\n    case 'move_node':\n      {\n        var {\n          path: _path4,\n          newPath\n        } = op;\n\n        if (Path.equals(_path4, newPath)) {\n          return [];\n        }\n\n        var oldAncestors = [];\n        var newAncestors = [];\n\n        for (var ancestor of Path.ancestors(_path4)) {\n          var p = Path.transform(ancestor, op);\n          oldAncestors.push(p);\n        }\n\n        for (var _ancestor of Path.ancestors(newPath)) {\n          var _p = Path.transform(_ancestor, op);\n\n          newAncestors.push(_p);\n        }\n\n        return [...oldAncestors, ...newAncestors];\n      }\n\n    case 'remove_node':\n      {\n        var {\n          path: _path5\n        } = op;\n\n        var _ancestors = Path.ancestors(_path5);\n\n        return [..._ancestors];\n      }\n\n    case 'split_node':\n      {\n        var {\n          path: _path6\n        } = op;\n\n        var _levels = Path.levels(_path6);\n\n        var nextPath = Path.next(_path6);\n        return [..._levels, nextPath];\n      }\n\n    default:\n      {\n        return [];\n      }\n  }\n};\n\nexport { Editor, Element, Location, Node, Operation, Path, PathRef, Point, PointRef, Range, RangeRef, Span, Text, Transforms, createEditor };\n//# sourceMappingURL=index.es.js.map\n","/*!\n * isobject <https://github.com/jonschlinkert/isobject>\n *\n * Copyright (c) 2014-2017, Jon Schlinkert.\n * Released under the MIT License.\n */\n\nfunction isObject(val) {\n  return val != null && typeof val === 'object' && Array.isArray(val) === false;\n}\n\n/*!\n * is-plain-object <https://github.com/jonschlinkert/is-plain-object>\n *\n * Copyright (c) 2014-2017, Jon Schlinkert.\n * Released under the MIT License.\n */\n\nfunction isObjectObject(o) {\n  return isObject(o) === true\n    && Object.prototype.toString.call(o) === '[object Object]';\n}\n\nfunction isPlainObject(o) {\n  var ctor,prot;\n\n  if (isObjectObject(o) === false) return false;\n\n  // If has modified constructor\n  ctor = o.constructor;\n  if (typeof ctor !== 'function') return false;\n\n  // If has modified prototype\n  prot = ctor.prototype;\n  if (isObjectObject(prot) === false) return false;\n\n  // If constructor does not have an Object-specific method\n  if (prot.hasOwnProperty('isPrototypeOf') === false) {\n    return false;\n  }\n\n  // Most likely a plain Object\n  return true;\n}\n\nexport default isPlainObject;\n","import isPlainObject from 'is-plain-object';\nimport { Operation, Editor, Path } from 'slate';\n\nvar History = {\n  /**\r\n   * Check if a value is a `History` object.\r\n   */\n  isHistory(value) {\n    return isPlainObject(value) && Array.isArray(value.redos) && Array.isArray(value.undos) && (value.redos.length === 0 || Operation.isOperationList(value.redos[0])) && (value.undos.length === 0 || Operation.isOperationList(value.undos[0]));\n  }\n\n};\n\n/**\r\n * Weakmaps for attaching state to the editor.\r\n */\n\nvar HISTORY = new WeakMap();\nvar SAVING = new WeakMap();\nvar MERGING = new WeakMap();\nvar HistoryEditor = {\n  /**\r\n   * Check if a value is a `HistoryEditor` object.\r\n   */\n  isHistoryEditor(value) {\n    return Editor.isEditor(value) && History.isHistory(value.history);\n  },\n\n  /**\r\n   * Get the merge flag's current value.\r\n   */\n  isMerging(editor) {\n    return MERGING.get(editor);\n  },\n\n  /**\r\n   * Get the saving flag's current value.\r\n   */\n  isSaving(editor) {\n    return SAVING.get(editor);\n  },\n\n  /**\r\n   * Redo to the previous saved state.\r\n   */\n  redo(editor) {\n    editor.redo();\n  },\n\n  /**\r\n   * Undo to the previous saved state.\r\n   */\n  undo(editor) {\n    editor.undo();\n  },\n\n  /**\r\n   * Apply a series of changes inside a synchronous `fn`, without merging any of\r\n   * the new operations into previous save point in the history.\r\n   */\n  withoutMerging(editor, fn) {\n    var prev = HistoryEditor.isMerging(editor);\n    MERGING.set(editor, false);\n    fn();\n    MERGING.set(editor, prev);\n  },\n\n  /**\r\n   * Apply a series of changes inside a synchronous `fn`, without saving any of\r\n   * their operations into the history.\r\n   */\n  withoutSaving(editor, fn) {\n    var prev = HistoryEditor.isSaving(editor);\n    SAVING.set(editor, false);\n    fn();\n    SAVING.set(editor, prev);\n  }\n\n};\n\n/**\r\n * The `withHistory` plugin keeps track of the operation history of a Slate\r\n * editor as operations are applied to it, using undo and redo stacks.\r\n */\n\nvar withHistory = editor => {\n  var e = editor;\n  var {\n    apply\n  } = e;\n  e.history = {\n    undos: [],\n    redos: []\n  };\n\n  e.redo = () => {\n    var {\n      history\n    } = e;\n    var {\n      redos\n    } = history;\n\n    if (redos.length > 0) {\n      var batch = redos[redos.length - 1];\n      HistoryEditor.withoutSaving(e, () => {\n        Editor.withoutNormalizing(e, () => {\n          for (var op of batch) {\n            e.apply(op);\n          }\n        });\n      });\n      history.redos.pop();\n      history.undos.push(batch);\n    }\n  };\n\n  e.undo = () => {\n    var {\n      history\n    } = e;\n    var {\n      undos\n    } = history;\n\n    if (undos.length > 0) {\n      var batch = undos[undos.length - 1];\n      HistoryEditor.withoutSaving(e, () => {\n        Editor.withoutNormalizing(e, () => {\n          var inverseOps = batch.map(Operation.inverse).reverse();\n\n          for (var op of inverseOps) {\n            // If the final operation is deselecting the editor, skip it. This is\n            if (op === inverseOps[inverseOps.length - 1] && op.type === 'set_selection' && op.newProperties == null) {\n              continue;\n            } else {\n              e.apply(op);\n            }\n          }\n        });\n      });\n      history.redos.push(batch);\n      history.undos.pop();\n    }\n  };\n\n  e.apply = op => {\n    var {\n      operations,\n      history\n    } = e;\n    var {\n      undos\n    } = history;\n    var lastBatch = undos[undos.length - 1];\n    var lastOp = lastBatch && lastBatch[lastBatch.length - 1];\n    var overwrite = shouldOverwrite(op, lastOp);\n    var save = HistoryEditor.isSaving(e);\n    var merge = HistoryEditor.isMerging(e);\n\n    if (save == null) {\n      save = shouldSave(op);\n    }\n\n    if (save) {\n      if (merge == null) {\n        if (lastBatch == null) {\n          merge = false;\n        } else if (operations.length !== 0) {\n          merge = true;\n        } else {\n          merge = shouldMerge(op, lastOp) || overwrite;\n        }\n      }\n\n      if (lastBatch && merge) {\n        if (overwrite) {\n          lastBatch.pop();\n        }\n\n        lastBatch.push(op);\n      } else {\n        var batch = [op];\n        undos.push(batch);\n      }\n\n      while (undos.length > 100) {\n        undos.shift();\n      }\n\n      if (shouldClear(op)) {\n        history.redos = [];\n      }\n    }\n\n    apply(op);\n  };\n\n  return e;\n};\n/**\r\n * Check whether to merge an operation into the previous operation.\r\n */\n\nvar shouldMerge = (op, prev) => {\n  if (op.type === 'set_selection') {\n    return true;\n  }\n\n  if (prev && op.type === 'insert_text' && prev.type === 'insert_text' && op.offset === prev.offset + prev.text.length && Path.equals(op.path, prev.path)) {\n    return true;\n  }\n\n  if (prev && op.type === 'remove_text' && prev.type === 'remove_text' && op.offset + op.text.length === prev.offset && Path.equals(op.path, prev.path)) {\n    return true;\n  }\n\n  return false;\n};\n/**\r\n * Check whether an operation needs to be saved to the history.\r\n */\n\n\nvar shouldSave = (op, prev) => {\n  if (op.type === 'set_selection' && op.newProperties == null) {\n    return false;\n  }\n\n  return true;\n};\n/**\r\n * Check whether an operation should overwrite the previous one.\r\n */\n\n\nvar shouldOverwrite = (op, prev) => {\n  if (prev && op.type === 'set_selection' && prev.type === 'set_selection') {\n    return true;\n  }\n\n  return false;\n};\n/**\r\n * Check whether an operation should clear the redos stack.\r\n */\n\n\nvar shouldClear = op => {\n  if (op.type === 'set_selection') {\n    return false;\n  }\n\n  return true;\n};\n\nexport { HISTORY, History, HistoryEditor, MERGING, SAVING, withHistory };\n//# sourceMappingURL=index.es.js.map\n","function t(t){return\"object\"==typeof t&&null!=t&&1===t.nodeType}function e(t,e){return(!e||\"hidden\"!==t)&&\"visible\"!==t&&\"clip\"!==t}function n(t,n){if(t.clientHeight<t.scrollHeight||t.clientWidth<t.scrollWidth){var r=getComputedStyle(t,null);return e(r.overflowY,n)||e(r.overflowX,n)||function(t){var e=function(t){if(!t.ownerDocument||!t.ownerDocument.defaultView)return null;try{return t.ownerDocument.defaultView.frameElement}catch(t){return null}}(t);return!!e&&(e.clientHeight<t.scrollHeight||e.clientWidth<t.scrollWidth)}(t)}return!1}function r(t,e,n,r,i,o,l,d){return o<t&&l>e||o>t&&l<e?0:o<=t&&d<=n||l>=e&&d>=n?o-t-r:l>e&&d<n||o<t&&d>n?l-e+i:0}export default function(e,i){var o=window,l=i.scrollMode,d=i.block,u=i.inline,h=i.boundary,a=i.skipOverflowHiddenElements,c=\"function\"==typeof h?h:function(t){return t!==h};if(!t(e))throw new TypeError(\"Invalid target\");for(var f=document.scrollingElement||document.documentElement,s=[],p=e;t(p)&&c(p);){if((p=p.parentElement)===f){s.push(p);break}null!=p&&p===document.body&&n(p)&&!n(document.documentElement)||null!=p&&n(p,a)&&s.push(p)}for(var m=o.visualViewport?o.visualViewport.width:innerWidth,g=o.visualViewport?o.visualViewport.height:innerHeight,w=window.scrollX||pageXOffset,v=window.scrollY||pageYOffset,W=e.getBoundingClientRect(),b=W.height,H=W.width,y=W.top,E=W.right,M=W.bottom,V=W.left,x=\"start\"===d||\"nearest\"===d?y:\"end\"===d?M:y+b/2,I=\"center\"===u?V+H/2:\"end\"===u?E:V,C=[],T=0;T<s.length;T++){var k=s[T],B=k.getBoundingClientRect(),D=B.height,O=B.width,R=B.top,X=B.right,Y=B.bottom,L=B.left;if(\"if-needed\"===l&&y>=0&&V>=0&&M<=g&&E<=m&&y>=R&&M<=Y&&V>=L&&E<=X)return C;var S=getComputedStyle(k),j=parseInt(S.borderLeftWidth,10),q=parseInt(S.borderTopWidth,10),z=parseInt(S.borderRightWidth,10),A=parseInt(S.borderBottomWidth,10),F=0,G=0,J=\"offsetWidth\"in k?k.offsetWidth-k.clientWidth-j-z:0,K=\"offsetHeight\"in k?k.offsetHeight-k.clientHeight-q-A:0;if(f===k)F=\"start\"===d?x:\"end\"===d?x-g:\"nearest\"===d?r(v,v+g,g,q,A,v+x,v+x+b,b):x-g/2,G=\"start\"===u?I:\"center\"===u?I-m/2:\"end\"===u?I-m:r(w,w+m,m,j,z,w+I,w+I+H,H),F=Math.max(0,F+v),G=Math.max(0,G+w);else{F=\"start\"===d?x-R-q:\"end\"===d?x-Y+A+K:\"nearest\"===d?r(R,Y,D,q,A+K,x,x+b,b):x-(R+D/2)+K/2,G=\"start\"===u?I-L-j:\"center\"===u?I-(L+O/2)+J/2:\"end\"===u?I-X+z+J:r(L,X,O,j,z+J,I,I+H,H);var N=k.scrollLeft,P=k.scrollTop;x+=P-(F=Math.max(0,Math.min(P+F,k.scrollHeight-D+K))),I+=N-(G=Math.max(0,Math.min(N+G,k.scrollWidth-O+J)))}C.push({el:k,top:F,left:G})}return C}\n//# sourceMappingURL=index.module.js.map\n","import compute from 'compute-scroll-into-view';\n\nfunction isOptionsObject(options) {\n  return options === Object(options) && Object.keys(options).length !== 0;\n}\n\nfunction defaultBehavior(actions, behavior) {\n  if (behavior === void 0) {\n    behavior = 'auto';\n  }\n\n  var canSmoothScroll = ('scrollBehavior' in document.body.style);\n  actions.forEach(function (_ref) {\n    var el = _ref.el,\n        top = _ref.top,\n        left = _ref.left;\n\n    if (el.scroll && canSmoothScroll) {\n      el.scroll({\n        top: top,\n        left: left,\n        behavior: behavior\n      });\n    } else {\n      el.scrollTop = top;\n      el.scrollLeft = left;\n    }\n  });\n}\n\nfunction getOptions(options) {\n  if (options === false) {\n    return {\n      block: 'end',\n      inline: 'nearest'\n    };\n  }\n\n  if (isOptionsObject(options)) {\n    return options;\n  }\n\n  return {\n    block: 'start',\n    inline: 'nearest'\n  };\n}\n\nfunction scrollIntoView(target, options) {\n  var targetIsDetached = !target.ownerDocument.documentElement.contains(target);\n\n  if (isOptionsObject(options) && typeof options.behavior === 'function') {\n    return options.behavior(targetIsDetached ? [] : compute(target, options));\n  }\n\n  if (targetIsDetached) {\n    return;\n  }\n\n  var computeOptions = getOptions(options);\n  return defaultBehavior(compute(target, computeOptions), computeOptions.behavior);\n}\n\nexport default scrollIntoView;","import React, { createContext, useContext, useState, useMemo, useCallback, useEffect, useLayoutEffect, useRef } from 'react';\nimport { Editor, Transforms, Range, Path, Node as Node$1, Text as Text$1, Element as Element$1 } from 'slate';\nimport throttle from 'lodash/throttle';\nimport scrollIntoView from 'scroll-into-view-if-needed';\nimport getDirection from 'direction';\nimport ReactDOM from 'react-dom';\nimport { isKeyHotkey } from 'is-hotkey';\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}\n\nfunction _objectWithoutProperties(source, excluded) {\n  if (source == null) return {};\n  var target = _objectWithoutPropertiesLoose(source, excluded);\n  var key, i;\n\n  if (Object.getOwnPropertySymbols) {\n    var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n\n    for (i = 0; i < sourceSymbolKeys.length; i++) {\n      key = sourceSymbolKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n      target[key] = source[key];\n    }\n  }\n\n  return target;\n}\n\n/**\r\n * An auto-incrementing identifier for keys.\r\n */\nvar n = 0;\n/**\r\n * A class that keeps track of a key string. We use a full class here because we\r\n * want to be able to use them as keys in `WeakMap` objects.\r\n */\n\nclass Key {\n  constructor() {\n    this.id = \"\".concat(n++);\n  }\n\n}\n\n/**\r\n * Two weak maps that allow us rebuild a path given a node. They are populated\r\n * at render time such that after a render occurs we can always backtrack.\r\n */\nvar NODE_TO_INDEX = new WeakMap();\nvar NODE_TO_PARENT = new WeakMap();\n/**\r\n * Weak maps that allow us to go between Slate nodes and DOM nodes. These\r\n * are used to resolve DOM event-related logic into Slate actions.\r\n */\n\nvar EDITOR_TO_ELEMENT = new WeakMap();\nvar ELEMENT_TO_NODE = new WeakMap();\nvar KEY_TO_ELEMENT = new WeakMap();\nvar NODE_TO_ELEMENT = new WeakMap();\nvar NODE_TO_KEY = new WeakMap();\n/**\r\n * Weak maps for storing editor-related state.\r\n */\n\nvar IS_READ_ONLY = new WeakMap();\nvar IS_FOCUSED = new WeakMap();\n/**\r\n * Weak map for associating the context `onChange` context with the plugin.\r\n */\n\nvar EDITOR_TO_ON_CHANGE = new WeakMap();\n/**\r\n * Symbols.\r\n */\n\nvar PLACEHOLDER_SYMBOL = Symbol('placeholder');\n\n/**\r\n * Types.\r\n */\n/**\r\n * Check if a DOM node is a comment node.\r\n */\n\nvar isDOMComment = value => {\n  return isDOMNode(value) && value.nodeType === 8;\n};\n/**\r\n * Check if a DOM node is an element node.\r\n */\n\nvar isDOMElement = value => {\n  return isDOMNode(value) && value.nodeType === 1;\n};\n/**\r\n * Check if a value is a DOM node.\r\n */\n\nvar isDOMNode = value => {\n  return value instanceof Node;\n};\n/**\r\n * Check if a DOM node is an element node.\r\n */\n\nvar isDOMText = value => {\n  return isDOMNode(value) && value.nodeType === 3;\n};\n/**\r\n * Checks whether a paste event is a plaintext-only event.\r\n */\n\nvar isPlainTextOnlyPaste = event => {\n  return event.clipboardData && event.clipboardData.getData('text/plain') !== '' && event.clipboardData.types.length === 1;\n};\n/**\r\n * Normalize a DOM point so that it always refers to a text node.\r\n */\n\nvar normalizeDOMPoint = domPoint => {\n  var [node, offset] = domPoint; // If it's an element node, its offset refers to the index of its children\n  // including comment nodes, so try to find the right text child node.\n\n  if (isDOMElement(node) && node.childNodes.length) {\n    var isLast = offset === node.childNodes.length;\n    var direction = isLast ? 'backward' : 'forward';\n    var index = isLast ? offset - 1 : offset;\n    node = getEditableChild(node, index, direction); // If the node has children, traverse until we have a leaf node. Leaf nodes\n    // can be either text nodes, or other void DOM nodes.\n\n    while (isDOMElement(node) && node.childNodes.length) {\n      var i = isLast ? node.childNodes.length - 1 : 0;\n      node = getEditableChild(node, i, direction);\n    } // Determine the new offset inside the text node.\n\n\n    offset = isLast && node.textContent != null ? node.textContent.length : 0;\n  } // Return the node and offset.\n\n\n  return [node, offset];\n};\n/**\r\n * Get the nearest editable child at `index` in a `parent`, preferring\r\n * `direction`.\r\n */\n\nvar getEditableChild = (parent, index, direction) => {\n  var {\n    childNodes\n  } = parent;\n  var child = childNodes[index];\n  var i = index;\n  var triedForward = false;\n  var triedBackward = false; // While the child is a comment node, or an element node with no children,\n  // keep iterating to find a sibling non-void, non-comment node.\n\n  while (isDOMComment(child) || isDOMElement(child) && child.childNodes.length === 0 || isDOMElement(child) && child.getAttribute('contenteditable') === 'false') {\n    if (triedForward && triedBackward) {\n      break;\n    }\n\n    if (i >= childNodes.length) {\n      triedForward = true;\n      i = index - 1;\n      direction = 'backward';\n      continue;\n    }\n\n    if (i < 0) {\n      triedBackward = true;\n      i = index + 1;\n      direction = 'forward';\n      continue;\n    }\n\n    child = childNodes[i];\n    i += direction === 'forward' ? 1 : -1;\n  }\n\n  return child;\n};\n/**\r\n * Get a plaintext representation of the content of a node, accounting for block\r\n * elements which get a newline appended.\r\n *\r\n * The domNode must be attached to the DOM.\r\n */\n\nvar getPlainText = domNode => {\n  var text = '';\n\n  if (isDOMText(domNode) && domNode.nodeValue) {\n    return domNode.nodeValue;\n  }\n\n  if (isDOMElement(domNode)) {\n    for (var childNode of Array.from(domNode.childNodes)) {\n      text += getPlainText(childNode);\n    }\n\n    var display = getComputedStyle(domNode).getPropertyValue('display');\n\n    if (display === 'block' || display === 'list' || domNode.tagName === 'BR') {\n      text += '\\n';\n    }\n  }\n\n  return text;\n};\n\nvar ReactEditor = {\n  /**\r\n   * Find a key for a Slate node.\r\n   */\n  findKey(editor, node) {\n    var key = NODE_TO_KEY.get(node);\n\n    if (!key) {\n      key = new Key();\n      NODE_TO_KEY.set(node, key);\n    }\n\n    return key;\n  },\n\n  /**\r\n   * Find the path of Slate node.\r\n   */\n  findPath(editor, node) {\n    var path = [];\n    var child = node;\n\n    while (true) {\n      var parent = NODE_TO_PARENT.get(child);\n\n      if (parent == null) {\n        if (Editor.isEditor(child)) {\n          return path;\n        } else {\n          break;\n        }\n      }\n\n      var i = NODE_TO_INDEX.get(child);\n\n      if (i == null) {\n        break;\n      }\n\n      path.unshift(i);\n      child = parent;\n    }\n\n    throw new Error(\"Unable to find the path for Slate node: \".concat(JSON.stringify(node)));\n  },\n\n  /**\r\n   * Check if the editor is focused.\r\n   */\n  isFocused(editor) {\n    return !!IS_FOCUSED.get(editor);\n  },\n\n  /**\r\n   * Check if the editor is in read-only mode.\r\n   */\n  isReadOnly(editor) {\n    return !!IS_READ_ONLY.get(editor);\n  },\n\n  /**\r\n   * Blur the editor.\r\n   */\n  blur(editor) {\n    var el = ReactEditor.toDOMNode(editor, editor);\n    IS_FOCUSED.set(editor, false);\n\n    if (window.document.activeElement === el) {\n      el.blur();\n    }\n  },\n\n  /**\r\n   * Focus the editor.\r\n   */\n  focus(editor) {\n    var el = ReactEditor.toDOMNode(editor, editor);\n    IS_FOCUSED.set(editor, true);\n\n    if (window.document.activeElement !== el) {\n      el.focus({\n        preventScroll: true\n      });\n    }\n  },\n\n  /**\r\n   * Deselect the editor.\r\n   */\n  deselect(editor) {\n    var {\n      selection\n    } = editor;\n    var domSelection = window.getSelection();\n\n    if (domSelection && domSelection.rangeCount > 0) {\n      domSelection.removeAllRanges();\n    }\n\n    if (selection) {\n      Transforms.deselect(editor);\n    }\n  },\n\n  /**\r\n   * Check if a DOM node is within the editor.\r\n   */\n  hasDOMNode(editor, target) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    var {\n      editable = false\n    } = options;\n    var editorEl = ReactEditor.toDOMNode(editor, editor);\n    var targetEl; // COMPAT: In Firefox, reading `target.nodeType` will throw an error if\n    // target is originating from an internal \"restricted\" element (e.g. a\n    // stepper arrow on a number input). (2018/05/04)\n    // https://github.com/ianstormtaylor/slate/issues/1819\n\n    try {\n      targetEl = isDOMElement(target) ? target : target.parentElement;\n    } catch (err) {\n      if (!err.message.includes('Permission denied to access property \"nodeType\"')) {\n        throw err;\n      }\n    }\n\n    if (!targetEl) {\n      return false;\n    }\n\n    return targetEl.closest(\"[data-slate-editor]\") === editorEl && (!editable || targetEl.isContentEditable || !!targetEl.getAttribute('data-slate-zero-width'));\n  },\n\n  /**\r\n   * Insert data from a `DataTransfer` into the editor.\r\n   */\n  insertData(editor, data) {\n    editor.insertData(data);\n  },\n\n  /**\r\n   * Sets data from the currently selected fragment on a `DataTransfer`.\r\n   */\n  setFragmentData(editor, data) {\n    editor.setFragmentData(data);\n  },\n\n  /**\r\n   * Find the native DOM element from a Slate node.\r\n   */\n  toDOMNode(editor, node) {\n    var domNode = Editor.isEditor(node) ? EDITOR_TO_ELEMENT.get(editor) : KEY_TO_ELEMENT.get(ReactEditor.findKey(editor, node));\n\n    if (!domNode) {\n      throw new Error(\"Cannot resolve a DOM node from Slate node: \".concat(JSON.stringify(node)));\n    }\n\n    return domNode;\n  },\n\n  /**\r\n   * Find a native DOM selection point from a Slate point.\r\n   */\n  toDOMPoint(editor, point) {\n    var [node] = Editor.node(editor, point.path);\n    var el = ReactEditor.toDOMNode(editor, node);\n    var domPoint; // If we're inside a void node, force the offset to 0, otherwise the zero\n    // width spacing character will result in an incorrect offset of 1\n\n    if (Editor.void(editor, {\n      at: point\n    })) {\n      point = {\n        path: point.path,\n        offset: 0\n      };\n    } // For each leaf, we need to isolate its content, which means filtering\n    // to its direct text and zero-width spans. (We have to filter out any\n    // other siblings that may have been rendered alongside them.)\n\n\n    var selector = \"[data-slate-string], [data-slate-zero-width]\";\n    var texts = Array.from(el.querySelectorAll(selector));\n    var start = 0;\n\n    for (var text of texts) {\n      var domNode = text.childNodes[0];\n\n      if (domNode == null || domNode.textContent == null) {\n        continue;\n      }\n\n      var {\n        length\n      } = domNode.textContent;\n      var attr = text.getAttribute('data-slate-length');\n      var trueLength = attr == null ? length : parseInt(attr, 10);\n      var end = start + trueLength;\n\n      if (point.offset <= end) {\n        var offset = Math.min(length, Math.max(0, point.offset - start));\n        domPoint = [domNode, offset];\n        break;\n      }\n\n      start = end;\n    }\n\n    if (!domPoint) {\n      throw new Error(\"Cannot resolve a DOM point from Slate point: \".concat(JSON.stringify(point)));\n    }\n\n    return domPoint;\n  },\n\n  /**\r\n   * Find a native DOM range from a Slate `range`.\r\n   *\r\n   * Notice: the returned range will always be ordinal regardless of the direction of Slate `range` due to DOM API limit.\r\n   *\r\n   * there is no way to create a reverse DOM Range using Range.setStart/setEnd\r\n   * according to https://dom.spec.whatwg.org/#concept-range-bp-set.\r\n   */\n  toDOMRange(editor, range) {\n    var {\n      anchor,\n      focus\n    } = range;\n    var isBackward = Range.isBackward(range);\n    var domAnchor = ReactEditor.toDOMPoint(editor, anchor);\n    var domFocus = Range.isCollapsed(range) ? domAnchor : ReactEditor.toDOMPoint(editor, focus);\n    var domRange = window.document.createRange();\n    var [startNode, startOffset] = isBackward ? domFocus : domAnchor;\n    var [endNode, endOffset] = isBackward ? domAnchor : domFocus; // A slate Point at zero-width Leaf always has an offset of 0 but a native DOM selection at\n    // zero-width node has an offset of 1 so we have to check if we are in a zero-width node and\n    // adjust the offset accordingly.\n\n    var startEl = isDOMElement(startNode) ? startNode : startNode.parentElement;\n    var isStartAtZeroWidth = !!startEl.getAttribute('data-slate-zero-width');\n    var endEl = isDOMElement(endNode) ? endNode : endNode.parentElement;\n    var isEndAtZeroWidth = !!endEl.getAttribute('data-slate-zero-width');\n    domRange.setStart(startNode, isStartAtZeroWidth ? 1 : startOffset);\n    domRange.setEnd(endNode, isEndAtZeroWidth ? 1 : endOffset);\n    return domRange;\n  },\n\n  /**\r\n   * Find a Slate node from a native DOM `element`.\r\n   */\n  toSlateNode(editor, domNode) {\n    var domEl = isDOMElement(domNode) ? domNode : domNode.parentElement;\n\n    if (domEl && !domEl.hasAttribute('data-slate-node')) {\n      domEl = domEl.closest(\"[data-slate-node]\");\n    }\n\n    var node = domEl ? ELEMENT_TO_NODE.get(domEl) : null;\n\n    if (!node) {\n      throw new Error(\"Cannot resolve a Slate node from DOM node: \".concat(domEl));\n    }\n\n    return node;\n  },\n\n  /**\r\n   * Get the target range from a DOM `event`.\r\n   */\n  findEventRange(editor, event) {\n    if ('nativeEvent' in event) {\n      event = event.nativeEvent;\n    }\n\n    var {\n      clientX: x,\n      clientY: y,\n      target\n    } = event;\n\n    if (x == null || y == null) {\n      throw new Error(\"Cannot resolve a Slate range from a DOM event: \".concat(event));\n    }\n\n    var node = ReactEditor.toSlateNode(editor, event.target);\n    var path = ReactEditor.findPath(editor, node); // If the drop target is inside a void node, move it into either the\n    // next or previous node, depending on which side the `x` and `y`\n    // coordinates are closest to.\n\n    if (Editor.isVoid(editor, node)) {\n      var rect = target.getBoundingClientRect();\n      var isPrev = editor.isInline(node) ? x - rect.left < rect.left + rect.width - x : y - rect.top < rect.top + rect.height - y;\n      var edge = Editor.point(editor, path, {\n        edge: isPrev ? 'start' : 'end'\n      });\n      var point = isPrev ? Editor.before(editor, edge) : Editor.after(editor, edge);\n\n      if (point) {\n        var _range = Editor.range(editor, point);\n\n        return _range;\n      }\n    } // Else resolve a range from the caret position where the drop occured.\n\n\n    var domRange;\n    var {\n      document\n    } = window; // COMPAT: In Firefox, `caretRangeFromPoint` doesn't exist. (2016/07/25)\n\n    if (document.caretRangeFromPoint) {\n      domRange = document.caretRangeFromPoint(x, y);\n    } else {\n      var position = document.caretPositionFromPoint(x, y);\n\n      if (position) {\n        domRange = document.createRange();\n        domRange.setStart(position.offsetNode, position.offset);\n        domRange.setEnd(position.offsetNode, position.offset);\n      }\n    }\n\n    if (!domRange) {\n      throw new Error(\"Cannot resolve a Slate range from a DOM event: \".concat(event));\n    } // Resolve a Slate range from the DOM range.\n\n\n    var range = ReactEditor.toSlateRange(editor, domRange);\n    return range;\n  },\n\n  /**\r\n   * Find a Slate point from a DOM selection's `domNode` and `domOffset`.\r\n   */\n  toSlatePoint(editor, domPoint) {\n    var [nearestNode, nearestOffset] = normalizeDOMPoint(domPoint);\n    var parentNode = nearestNode.parentNode;\n    var textNode = null;\n    var offset = 0;\n\n    if (parentNode) {\n      var voidNode = parentNode.closest('[data-slate-void=\"true\"]');\n      var leafNode = parentNode.closest('[data-slate-leaf]');\n      var domNode = null; // Calculate how far into the text node the `nearestNode` is, so that we\n      // can determine what the offset relative to the text node is.\n\n      if (leafNode) {\n        textNode = leafNode.closest('[data-slate-node=\"text\"]');\n        var range = window.document.createRange();\n        range.setStart(textNode, 0);\n        range.setEnd(nearestNode, nearestOffset);\n        var contents = range.cloneContents();\n        var removals = [...contents.querySelectorAll('[data-slate-zero-width]'), ...contents.querySelectorAll('[contenteditable=false]')];\n        removals.forEach(el => {\n          el.parentNode.removeChild(el);\n        }); // COMPAT: Edge has a bug where Range.prototype.toString() will\n        // convert \\n into \\r\\n. The bug causes a loop when slate-react\n        // attempts to reposition its cursor to match the native position. Use\n        // textContent.length instead.\n        // https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/10291116/\n\n        offset = contents.textContent.length;\n        domNode = textNode;\n      } else if (voidNode) {\n        // For void nodes, the element with the offset key will be a cousin, not an\n        // ancestor, so find it by going down from the nearest void parent.\n        leafNode = voidNode.querySelector('[data-slate-leaf]');\n        textNode = leafNode.closest('[data-slate-node=\"text\"]');\n        domNode = leafNode;\n        offset = domNode.textContent.length;\n      } // COMPAT: If the parent node is a Slate zero-width space, editor is\n      // because the text node should have no characters. However, during IME\n      // composition the ASCII characters will be prepended to the zero-width\n      // space, so subtract 1 from the offset to account for the zero-width\n      // space character.\n\n\n      if (domNode && offset === domNode.textContent.length && parentNode.hasAttribute('data-slate-zero-width')) {\n        offset--;\n      }\n    }\n\n    if (!textNode) {\n      throw new Error(\"Cannot resolve a Slate point from DOM point: \".concat(domPoint));\n    } // COMPAT: If someone is clicking from one Slate editor into another,\n    // the select event fires twice, once for the old editor's `element`\n    // first, and then afterwards for the correct `element`. (2017/03/03)\n\n\n    var slateNode = ReactEditor.toSlateNode(editor, textNode);\n    var path = ReactEditor.findPath(editor, slateNode);\n    return {\n      path,\n      offset\n    };\n  },\n\n  /**\r\n   * Find a Slate range from a DOM range or selection.\r\n   */\n  toSlateRange(editor, domRange) {\n    var el = domRange instanceof Selection ? domRange.anchorNode : domRange.startContainer;\n    var anchorNode;\n    var anchorOffset;\n    var focusNode;\n    var focusOffset;\n    var isCollapsed;\n\n    if (el) {\n      if (domRange instanceof Selection) {\n        anchorNode = domRange.anchorNode;\n        anchorOffset = domRange.anchorOffset;\n        focusNode = domRange.focusNode;\n        focusOffset = domRange.focusOffset;\n        isCollapsed = domRange.isCollapsed;\n      } else {\n        anchorNode = domRange.startContainer;\n        anchorOffset = domRange.startOffset;\n        focusNode = domRange.endContainer;\n        focusOffset = domRange.endOffset;\n        isCollapsed = domRange.collapsed;\n      }\n    }\n\n    if (anchorNode == null || focusNode == null || anchorOffset == null || focusOffset == null) {\n      throw new Error(\"Cannot resolve a Slate range from DOM range: \".concat(domRange));\n    }\n\n    var anchor = ReactEditor.toSlatePoint(editor, [anchorNode, anchorOffset]);\n    var focus = isCollapsed ? anchor : ReactEditor.toSlatePoint(editor, [focusNode, focusOffset]);\n    return {\n      anchor,\n      focus\n    };\n  }\n\n};\n\n/**\r\n * A React context for sharing the `focused` state of the editor.\r\n */\n\nvar FocusedContext = createContext(false);\n/**\r\n * Get the current `focused` state of the editor.\r\n */\n\nvar useFocused = () => {\n  return useContext(FocusedContext);\n};\n\n/**\r\n * A React context for sharing the editor object.\r\n */\n\nvar EditorContext = createContext(null);\n/**\r\n * Get the current editor object from the React context.\r\n */\n\nvar useEditor = () => {\n  var editor = useContext(EditorContext);\n\n  if (!editor) {\n    throw new Error(\"The `useEditor` hook must be used inside the <Slate> component's context.\");\n  }\n\n  return editor;\n};\n\n/**\r\n * A React context for sharing the editor object, in a way that re-renders the\r\n * context whenever changes occur.\r\n */\n\nvar SlateContext = createContext(null);\n/**\r\n * Get the current editor object from the React context.\r\n */\n\nvar useSlate = () => {\n  var context = useContext(SlateContext);\n\n  if (!context) {\n    throw new Error(\"The `useSlate` hook must be used inside the <SlateProvider> component's context.\");\n  }\n\n  var [editor] = context;\n  return editor;\n};\n\n/**\r\n * A wrapper around the provider to handle `onChange` events, because the editor\r\n * is a mutable singleton so it won't ever register as \"changed\" otherwise.\r\n */\n\nvar Slate = props => {\n  var {\n    editor,\n    children,\n    onChange,\n    value\n  } = props,\n      rest = _objectWithoutProperties(props, [\"editor\", \"children\", \"onChange\", \"value\"]);\n\n  var [key, setKey] = useState(0);\n  var context = useMemo(() => {\n    editor.children = value;\n    Object.assign(editor, rest);\n    return [editor];\n  }, [key, value, ...Object.values(rest)]);\n  var onContextChange = useCallback(() => {\n    onChange(editor.children);\n    setKey(key + 1);\n  }, [key, onChange]);\n  EDITOR_TO_ON_CHANGE.set(editor, onContextChange);\n  useEffect(() => {\n    return () => {\n      EDITOR_TO_ON_CHANGE.set(editor, () => {});\n    };\n  }, []);\n  return React.createElement(SlateContext.Provider, {\n    value: context\n  }, React.createElement(EditorContext.Provider, {\n    value: editor\n  }, React.createElement(FocusedContext.Provider, {\n    value: ReactEditor.isFocused(editor)\n  }, children)));\n};\n\n/**\r\n * A React context for sharing the `readOnly` state of the editor.\r\n */\n\nvar ReadOnlyContext = createContext(false);\n/**\r\n * Get the current `readOnly` state of the editor.\r\n */\n\nvar useReadOnly = () => {\n  return useContext(ReadOnlyContext);\n};\n\n/**\r\n * A React context for sharing the `selected` state of an element.\r\n */\n\nvar SelectedContext = createContext(false);\n/**\r\n * Get the current `selected` state of an element.\r\n */\n\nvar useSelected = () => {\n  return useContext(SelectedContext);\n};\n\n/**\r\n * `withReact` adds React and DOM specific behaviors to the editor.\r\n */\n\nvar withReact = editor => {\n  var e = editor;\n  var {\n    apply,\n    onChange\n  } = e;\n\n  e.apply = op => {\n    var matches = [];\n\n    switch (op.type) {\n      case 'insert_text':\n      case 'remove_text':\n      case 'set_node':\n        {\n          for (var [node, path] of Editor.levels(e, {\n            at: op.path\n          })) {\n            var key = ReactEditor.findKey(e, node);\n            matches.push([path, key]);\n          }\n\n          break;\n        }\n\n      case 'insert_node':\n      case 'remove_node':\n      case 'merge_node':\n      case 'split_node':\n        {\n          for (var [_node, _path] of Editor.levels(e, {\n            at: Path.parent(op.path)\n          })) {\n            var _key = ReactEditor.findKey(e, _node);\n\n            matches.push([_path, _key]);\n          }\n\n          break;\n        }\n    }\n\n    apply(op);\n\n    for (var [_path2, _key2] of matches) {\n      var [_node2] = Editor.node(e, _path2);\n      NODE_TO_KEY.set(_node2, _key2);\n    }\n  };\n\n  e.setFragmentData = data => {\n    var {\n      selection\n    } = e;\n\n    if (!selection) {\n      return;\n    }\n\n    var [start, end] = Range.edges(selection);\n    var startVoid = Editor.void(e, {\n      at: start.path\n    });\n    var endVoid = Editor.void(e, {\n      at: end.path\n    });\n\n    if (Range.isCollapsed(selection) && !startVoid) {\n      return;\n    } // Create a fake selection so that we can add a Base64-encoded copy of the\n    // fragment to the HTML, to decode on future pastes.\n\n\n    var domRange = ReactEditor.toDOMRange(e, selection);\n    var contents = domRange.cloneContents();\n    var attach = contents.childNodes[0]; // Make sure attach is non-empty, since empty nodes will not get copied.\n\n    contents.childNodes.forEach(node => {\n      if (node.textContent && node.textContent.trim() !== '') {\n        attach = node;\n      }\n    }); // COMPAT: If the end node is a void node, we need to move the end of the\n    // range from the void node's spacer span, to the end of the void node's\n    // content, since the spacer is before void's content in the DOM.\n\n    if (endVoid) {\n      var [voidNode] = endVoid;\n      var r = domRange.cloneRange();\n      var domNode = ReactEditor.toDOMNode(e, voidNode);\n      r.setEndAfter(domNode);\n      contents = r.cloneContents();\n    } // COMPAT: If the start node is a void node, we need to attach the encoded\n    // fragment to the void node's content node instead of the spacer, because\n    // attaching it to empty `<div>/<span>` nodes will end up having it erased by\n    // most browsers. (2018/04/27)\n\n\n    if (startVoid) {\n      attach = contents.querySelector('[data-slate-spacer]');\n    } // Remove any zero-width space spans from the cloned DOM so that they don't\n    // show up elsewhere when pasted.\n\n\n    Array.from(contents.querySelectorAll('[data-slate-zero-width]')).forEach(zw => {\n      var isNewline = zw.getAttribute('data-slate-zero-width') === 'n';\n      zw.textContent = isNewline ? '\\n' : '';\n    }); // Set a `data-slate-fragment` attribute on a non-empty node, so it shows up\n    // in the HTML, and can be used for intra-Slate pasting. If it's a text\n    // node, wrap it in a `<span>` so we have something to set an attribute on.\n\n    if (isDOMText(attach)) {\n      var span = document.createElement('span'); // COMPAT: In Chrome and Safari, if we don't add the `white-space` style\n      // then leading and trailing spaces will be ignored. (2017/09/21)\n\n      span.style.whiteSpace = 'pre';\n      span.appendChild(attach);\n      contents.appendChild(span);\n      attach = span;\n    }\n\n    var fragment = e.getFragment();\n    var string = JSON.stringify(fragment);\n    var encoded = window.btoa(encodeURIComponent(string));\n    attach.setAttribute('data-slate-fragment', encoded);\n    data.setData('application/x-slate-fragment', encoded); // Add the content to a <div> so that we can get its inner HTML.\n\n    var div = document.createElement('div');\n    div.appendChild(contents);\n    div.setAttribute('hidden', 'true');\n    document.body.appendChild(div);\n    data.setData('text/html', div.innerHTML);\n    data.setData('text/plain', getPlainText(div));\n    document.body.removeChild(div);\n  };\n\n  e.insertData = data => {\n    var fragment = data.getData('application/x-slate-fragment');\n\n    if (fragment) {\n      var decoded = decodeURIComponent(window.atob(fragment));\n      var parsed = JSON.parse(decoded);\n      e.insertFragment(parsed);\n      return;\n    }\n\n    var text = data.getData('text/plain');\n\n    if (text) {\n      var lines = text.split(/\\r\\n|\\r|\\n/);\n      var split = false;\n\n      for (var line of lines) {\n        if (split) {\n          Transforms.splitNodes(e, {\n            always: true\n          });\n        }\n\n        e.insertText(line);\n        split = true;\n      }\n    }\n  };\n\n  e.onChange = () => {\n    // COMPAT: React doesn't batch `setState` hook calls, which means that the\n    // children and selection can get out of sync for one render pass. So we\n    // have to use this unstable API to ensure it batches them. (2019/12/03)\n    // https://github.com/facebook/react/issues/14259#issuecomment-439702367\n    ReactDOM.unstable_batchedUpdates(() => {\n      var onContextChange = EDITOR_TO_ON_CHANGE.get(e);\n\n      if (onContextChange) {\n        onContextChange();\n      }\n\n      onChange();\n    });\n  };\n\n  return e;\n};\n\n/**\r\n * Leaf content strings.\r\n */\n\nvar String = props => {\n  var {\n    isLast,\n    leaf,\n    parent,\n    text\n  } = props;\n  var editor = useEditor();\n  var path = ReactEditor.findPath(editor, text);\n  var parentPath = Path.parent(path); // COMPAT: Render text inside void nodes with a zero-width space.\n  // So the node can contain selection but the text is not visible.\n\n  if (editor.isVoid(parent)) {\n    return React.createElement(ZeroWidthString, {\n      length: Node$1.string(parent).length\n    });\n  } // COMPAT: If this is the last text node in an empty block, render a zero-\n  // width space that will convert into a line break when copying and pasting\n  // to support expected plain text.\n\n\n  if (leaf.text === '' && parent.children[parent.children.length - 1] === text && !editor.isInline(parent) && Editor.string(editor, parentPath) === '') {\n    return React.createElement(ZeroWidthString, {\n      isLineBreak: true\n    });\n  } // COMPAT: If the text is empty, it's because it's on the edge of an inline\n  // node, so we render a zero-width space so that the selection can be\n  // inserted next to it still.\n\n\n  if (leaf.text === '') {\n    return React.createElement(ZeroWidthString, null);\n  } // COMPAT: Browsers will collapse trailing new lines at the end of blocks,\n  // so we need to add an extra trailing new lines to prevent that.\n\n\n  if (isLast && leaf.text.slice(-1) === '\\n') {\n    return React.createElement(TextString, {\n      isTrailing: true,\n      text: leaf.text\n    });\n  }\n\n  return React.createElement(TextString, {\n    text: leaf.text\n  });\n};\n/**\r\n * Leaf strings with text in them.\r\n */\n\n\nvar TextString = props => {\n  var {\n    text,\n    isTrailing = false\n  } = props;\n  return React.createElement(\"span\", {\n    \"data-slate-string\": true\n  }, text, isTrailing ? '\\n' : null);\n};\n/**\r\n * Leaf strings without text, render as zero-width strings.\r\n */\n\n\nvar ZeroWidthString = props => {\n  var {\n    length = 0,\n    isLineBreak = false\n  } = props;\n  return React.createElement(\"span\", {\n    \"data-slate-zero-width\": isLineBreak ? 'n' : 'z',\n    \"data-slate-length\": length\n  }, '\\uFEFF', isLineBreak ? React.createElement(\"br\", null) : null);\n};\n\n/**\r\n * Individual leaves in a text node with unique formatting.\r\n */\n\nvar Leaf = props => {\n  var {\n    leaf,\n    isLast,\n    text,\n    parent,\n    renderLeaf = props => React.createElement(DefaultLeaf, Object.assign({}, props))\n  } = props;\n  var children = React.createElement(String, {\n    isLast: isLast,\n    leaf: leaf,\n    parent: parent,\n    text: text\n  });\n\n  if (leaf[PLACEHOLDER_SYMBOL]) {\n    children = React.createElement(React.Fragment, null, React.createElement(\"span\", {\n      contentEditable: false,\n      style: {\n        pointerEvents: 'none',\n        display: 'inline-block',\n        width: '0',\n        maxWidth: '100%',\n        whiteSpace: 'nowrap',\n        opacity: '0.333',\n        userSelect: 'none',\n        fontStyle: 'normal',\n        fontWeight: 'normal',\n        textDecoration: 'none'\n      }\n    }, leaf.placeholder), children);\n  } // COMPAT: Having the `data-` attributes on these leaf elements ensures that\n  // in certain misbehaving browsers they aren't weirdly cloned/destroyed by\n  // contenteditable behaviors. (2019/05/08)\n\n\n  var attributes = {\n    'data-slate-leaf': true\n  };\n  return renderLeaf({\n    attributes,\n    children,\n    leaf,\n    text\n  });\n};\n\nvar MemoizedLeaf = React.memo(Leaf, (prev, next) => {\n  return next.parent === prev.parent && next.isLast === prev.isLast && next.renderLeaf === prev.renderLeaf && next.text === prev.text && Text$1.matches(next.leaf, prev.leaf);\n});\n/**\r\n * The default custom leaf renderer.\r\n */\n\nvar DefaultLeaf = props => {\n  var {\n    attributes,\n    children\n  } = props;\n  return React.createElement(\"span\", Object.assign({}, attributes), children);\n};\n\n/**\r\n * Prevent warning on SSR by falling back to useEffect when window is not defined\r\n */\n\nvar useIsomorphicLayoutEffect = typeof window !== 'undefined' ? useLayoutEffect : useEffect;\n\n/**\r\n * Text.\r\n */\n\nvar Text = props => {\n  var {\n    decorations,\n    isLast,\n    parent,\n    renderLeaf,\n    text\n  } = props;\n  var editor = useEditor();\n  var ref = useRef(null);\n  var leaves = Text$1.decorations(text, decorations);\n  var key = ReactEditor.findKey(editor, text);\n  var children = [];\n\n  for (var i = 0; i < leaves.length; i++) {\n    var leaf = leaves[i];\n    children.push(React.createElement(MemoizedLeaf, {\n      isLast: isLast && i === leaves.length - 1,\n      key: \"\".concat(key.id, \"-\").concat(i),\n      leaf: leaf,\n      text: text,\n      parent: parent,\n      renderLeaf: renderLeaf\n    }));\n  } // Update element-related weak maps with the DOM element ref.\n\n\n  useIsomorphicLayoutEffect(() => {\n    if (ref.current) {\n      KEY_TO_ELEMENT.set(key, ref.current);\n      NODE_TO_ELEMENT.set(text, ref.current);\n      ELEMENT_TO_NODE.set(ref.current, text);\n    } else {\n      KEY_TO_ELEMENT.delete(key);\n      NODE_TO_ELEMENT.delete(text);\n    }\n  });\n  return React.createElement(\"span\", {\n    \"data-slate-node\": \"text\",\n    ref: ref\n  }, children);\n};\n\nvar MemoizedText = React.memo(Text, (prev, next) => {\n  return next.parent === prev.parent && next.isLast === prev.isLast && next.renderLeaf === prev.renderLeaf && next.text === prev.text;\n});\n\n/**\r\n * Element.\r\n */\n\nvar Element = props => {\n  var {\n    decorate,\n    decorations,\n    element,\n    renderElement = p => React.createElement(DefaultElement, Object.assign({}, p)),\n    renderLeaf,\n    selection\n  } = props;\n  var ref = useRef(null);\n  var editor = useEditor();\n  var readOnly = useReadOnly();\n  var isInline = editor.isInline(element);\n  var key = ReactEditor.findKey(editor, element);\n  var children = React.createElement(Children, {\n    decorate: decorate,\n    decorations: decorations,\n    node: element,\n    renderElement: renderElement,\n    renderLeaf: renderLeaf,\n    selection: selection\n  }); // Attributes that the developer must mix into the element in their\n  // custom node renderer component.\n\n  var attributes = {\n    'data-slate-node': 'element',\n    ref\n  };\n\n  if (isInline) {\n    attributes['data-slate-inline'] = true;\n  } // If it's a block node with inline children, add the proper `dir` attribute\n  // for text direction.\n\n\n  if (!isInline && Editor.hasInlines(editor, element)) {\n    var text = Node$1.string(element);\n    var dir = getDirection(text);\n\n    if (dir === 'rtl') {\n      attributes.dir = dir;\n    }\n  } // If it's a void node, wrap the children in extra void-specific elements.\n\n\n  if (Editor.isVoid(editor, element)) {\n    attributes['data-slate-void'] = true;\n\n    if (!readOnly && isInline) {\n      attributes.contentEditable = false;\n    }\n\n    var Tag = isInline ? 'span' : 'div';\n    var [[_text]] = Node$1.texts(element);\n    children = readOnly ? null : React.createElement(Tag, {\n      \"data-slate-spacer\": true,\n      style: {\n        height: '0',\n        color: 'transparent',\n        outline: 'none',\n        position: 'absolute'\n      }\n    }, React.createElement(MemoizedText, {\n      decorations: [],\n      isLast: false,\n      parent: element,\n      text: _text\n    }));\n    NODE_TO_INDEX.set(_text, 0);\n    NODE_TO_PARENT.set(_text, element);\n  } // Update element-related weak maps with the DOM element ref.\n\n\n  useIsomorphicLayoutEffect(() => {\n    if (ref.current) {\n      KEY_TO_ELEMENT.set(key, ref.current);\n      NODE_TO_ELEMENT.set(element, ref.current);\n      ELEMENT_TO_NODE.set(ref.current, element);\n    } else {\n      KEY_TO_ELEMENT.delete(key);\n      NODE_TO_ELEMENT.delete(element);\n    }\n  });\n  return React.createElement(SelectedContext.Provider, {\n    value: !!selection\n  }, renderElement({\n    attributes,\n    children,\n    element\n  }));\n};\n\nvar MemoizedElement = React.memo(Element, (prev, next) => {\n  return prev.decorate === next.decorate && prev.element === next.element && prev.renderElement === next.renderElement && prev.renderLeaf === next.renderLeaf && isRangeListEqual(prev.decorations, next.decorations) && (prev.selection === next.selection || !!prev.selection && !!next.selection && Range.equals(prev.selection, next.selection));\n});\n/**\r\n * The default element renderer.\r\n */\n\nvar DefaultElement = props => {\n  var {\n    attributes,\n    children,\n    element\n  } = props;\n  var editor = useEditor();\n  var Tag = editor.isInline(element) ? 'span' : 'div';\n  return React.createElement(Tag, Object.assign({}, attributes, {\n    style: {\n      position: 'relative'\n    }\n  }), children);\n};\n/**\r\n * Check if a list of ranges is equal to another.\r\n *\r\n * PERF: this requires the two lists to also have the ranges inside them in the\r\n * same order, but this is an okay constraint for us since decorations are\r\n * kept in order, and the odd case where they aren't is okay to re-render for.\r\n */\n\nvar isRangeListEqual = (list, another) => {\n  if (list.length !== another.length) {\n    return false;\n  }\n\n  for (var i = 0; i < list.length; i++) {\n    var range = list[i];\n    var other = another[i];\n\n    if (!Range.equals(range, other)) {\n      return false;\n    }\n  }\n\n  return true;\n};\n\n/**\r\n * Children.\r\n */\n\nvar Children = props => {\n  var {\n    decorate,\n    decorations,\n    node,\n    renderElement,\n    renderLeaf,\n    selection\n  } = props;\n  var editor = useEditor();\n  var path = ReactEditor.findPath(editor, node);\n  var children = [];\n  var isLeafBlock = Element$1.isElement(node) && !editor.isInline(node) && Editor.hasInlines(editor, node);\n\n  for (var i = 0; i < node.children.length; i++) {\n    var p = path.concat(i);\n    var n = node.children[i];\n    var key = ReactEditor.findKey(editor, n);\n    var range = Editor.range(editor, p);\n    var sel = selection && Range.intersection(range, selection);\n    var ds = decorate([n, p]);\n\n    for (var dec of decorations) {\n      var d = Range.intersection(dec, range);\n\n      if (d) {\n        ds.push(d);\n      }\n    }\n\n    if (Element$1.isElement(n)) {\n      children.push(React.createElement(MemoizedElement, {\n        decorate: decorate,\n        decorations: ds,\n        element: n,\n        key: key.id,\n        renderElement: renderElement,\n        renderLeaf: renderLeaf,\n        selection: sel\n      }));\n    } else {\n      children.push(React.createElement(MemoizedText, {\n        decorations: ds,\n        key: key.id,\n        isLast: isLeafBlock && i === node.children.length - 1,\n        parent: node,\n        renderLeaf: renderLeaf,\n        text: n\n      }));\n    }\n\n    NODE_TO_INDEX.set(n, i);\n    NODE_TO_PARENT.set(n, node);\n  }\n\n  return React.createElement(React.Fragment, null, children);\n};\n\nvar IS_IOS = typeof navigator !== 'undefined' && typeof window !== 'undefined' && /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;\nvar IS_APPLE = typeof navigator !== 'undefined' && /Mac OS X/.test(navigator.userAgent);\nvar IS_FIREFOX = typeof navigator !== 'undefined' && /^(?!.*Seamonkey)(?=.*Firefox).*/i.test(navigator.userAgent);\nvar IS_SAFARI = typeof navigator !== 'undefined' && /Version\\/[\\d\\.]+.*Safari/.test(navigator.userAgent); // \"modern\" Edge was released at 79.x\n\nvar IS_EDGE_LEGACY = typeof navigator !== 'undefined' && /Edge?\\/(?:[0-6][0-9]|[0-7][0-8])/i.test(navigator.userAgent); // Native beforeInput events don't work well with react on Chrome 75 and older, Chrome 76+ can use beforeInput\n\nvar IS_CHROME_LEGACY = typeof navigator !== 'undefined' && /Chrome?\\/(?:[0-7][0-5]|[0-6][0-9])/i.test(navigator.userAgent);\n\n/**\r\n * Hotkey mappings for each platform.\r\n */\n\nvar HOTKEYS = {\n  bold: 'mod+b',\n  compose: ['down', 'left', 'right', 'up', 'backspace', 'enter'],\n  moveBackward: 'left',\n  moveForward: 'right',\n  moveWordBackward: 'ctrl+left',\n  moveWordForward: 'ctrl+right',\n  deleteBackward: 'shift?+backspace',\n  deleteForward: 'shift?+delete',\n  extendBackward: 'shift+left',\n  extendForward: 'shift+right',\n  italic: 'mod+i',\n  splitBlock: 'shift?+enter',\n  undo: 'mod+z'\n};\nvar APPLE_HOTKEYS = {\n  moveLineBackward: 'opt+up',\n  moveLineForward: 'opt+down',\n  moveWordBackward: 'opt+left',\n  moveWordForward: 'opt+right',\n  deleteBackward: ['ctrl+backspace', 'ctrl+h'],\n  deleteForward: ['ctrl+delete', 'ctrl+d'],\n  deleteLineBackward: 'cmd+shift?+backspace',\n  deleteLineForward: ['cmd+shift?+delete', 'ctrl+k'],\n  deleteWordBackward: 'opt+shift?+backspace',\n  deleteWordForward: 'opt+shift?+delete',\n  extendLineBackward: 'opt+shift+up',\n  extendLineForward: 'opt+shift+down',\n  redo: 'cmd+shift+z',\n  transposeCharacter: 'ctrl+t'\n};\nvar WINDOWS_HOTKEYS = {\n  deleteWordBackward: 'ctrl+shift?+backspace',\n  deleteWordForward: 'ctrl+shift?+delete',\n  redo: ['ctrl+y', 'ctrl+shift+z']\n};\n/**\r\n * Create a platform-aware hotkey checker.\r\n */\n\nvar create = key => {\n  var generic = HOTKEYS[key];\n  var apple = APPLE_HOTKEYS[key];\n  var windows = WINDOWS_HOTKEYS[key];\n  var isGeneric = generic && isKeyHotkey(generic);\n  var isApple = apple && isKeyHotkey(apple);\n  var isWindows = windows && isKeyHotkey(windows);\n  return event => {\n    if (isGeneric && isGeneric(event)) return true;\n    if (IS_APPLE && isApple && isApple(event)) return true;\n    if (!IS_APPLE && isWindows && isWindows(event)) return true;\n    return false;\n  };\n};\n/**\r\n * Hotkeys.\r\n */\n\n\nvar Hotkeys = {\n  isBold: create('bold'),\n  isCompose: create('compose'),\n  isMoveBackward: create('moveBackward'),\n  isMoveForward: create('moveForward'),\n  isDeleteBackward: create('deleteBackward'),\n  isDeleteForward: create('deleteForward'),\n  isDeleteLineBackward: create('deleteLineBackward'),\n  isDeleteLineForward: create('deleteLineForward'),\n  isDeleteWordBackward: create('deleteWordBackward'),\n  isDeleteWordForward: create('deleteWordForward'),\n  isExtendBackward: create('extendBackward'),\n  isExtendForward: create('extendForward'),\n  isExtendLineBackward: create('extendLineBackward'),\n  isExtendLineForward: create('extendLineForward'),\n  isItalic: create('italic'),\n  isMoveLineBackward: create('moveLineBackward'),\n  isMoveLineForward: create('moveLineForward'),\n  isMoveWordBackward: create('moveWordBackward'),\n  isMoveWordForward: create('moveWordForward'),\n  isRedo: create('redo'),\n  isSplitBlock: create('splitBlock'),\n  isTransposeCharacter: create('transposeCharacter'),\n  isUndo: create('undo')\n};\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n// Chrome Legacy doesn't support `beforeinput` correctly\n\nvar HAS_BEFORE_INPUT_SUPPORT = !(IS_FIREFOX || IS_EDGE_LEGACY || IS_CHROME_LEGACY);\n/**\r\n * Editable.\r\n */\n\nvar Editable = props => {\n  var {\n    autoFocus,\n    decorate = defaultDecorate,\n    onDOMBeforeInput: propsOnDOMBeforeInput,\n    placeholder,\n    readOnly = false,\n    renderElement,\n    renderLeaf,\n    style = {},\n    as: Component = 'div'\n  } = props,\n      attributes = _objectWithoutProperties(props, [\"autoFocus\", \"decorate\", \"onDOMBeforeInput\", \"placeholder\", \"readOnly\", \"renderElement\", \"renderLeaf\", \"style\", \"as\"]);\n\n  var editor = useSlate();\n  var ref = useRef(null); // Update internal state on each render.\n\n  IS_READ_ONLY.set(editor, readOnly); // Keep track of some state for the event handler logic.\n\n  var state = useMemo(() => ({\n    isComposing: false,\n    isUpdatingSelection: false,\n    latestElement: null\n  }), []); // Update element-related weak maps with the DOM element ref.\n\n  useIsomorphicLayoutEffect(() => {\n    if (ref.current) {\n      EDITOR_TO_ELEMENT.set(editor, ref.current);\n      NODE_TO_ELEMENT.set(editor, ref.current);\n      ELEMENT_TO_NODE.set(ref.current, editor);\n    } else {\n      NODE_TO_ELEMENT.delete(editor);\n    }\n  }); // Whenever the editor updates, make sure the DOM selection state is in sync.\n\n  useIsomorphicLayoutEffect(() => {\n    var {\n      selection\n    } = editor;\n    var domSelection = window.getSelection();\n\n    if (state.isComposing || !domSelection || !ReactEditor.isFocused(editor)) {\n      return;\n    }\n\n    var hasDomSelection = domSelection.type !== 'None'; // If the DOM selection is properly unset, we're done.\n\n    if (!selection && !hasDomSelection) {\n      return;\n    } // verify that the dom selection is in the editor\n\n\n    var editorElement = EDITOR_TO_ELEMENT.get(editor);\n    var hasDomSelectionInEditor = false;\n\n    if (editorElement.contains(domSelection.anchorNode) && editorElement.contains(domSelection.focusNode)) {\n      hasDomSelectionInEditor = true;\n    } // If the DOM selection is in the editor and the editor selection is already correct, we're done.\n\n\n    if (hasDomSelection && hasDomSelectionInEditor && selection && Range.equals(ReactEditor.toSlateRange(editor, domSelection), selection)) {\n      return;\n    } // Otherwise the DOM selection is out of sync, so update it.\n\n\n    var el = ReactEditor.toDOMNode(editor, editor);\n    state.isUpdatingSelection = true;\n    var newDomRange = selection && ReactEditor.toDOMRange(editor, selection);\n\n    if (newDomRange) {\n      if (Range.isBackward(selection)) {\n        domSelection.setBaseAndExtent(newDomRange.endContainer, newDomRange.endOffset, newDomRange.startContainer, newDomRange.startOffset);\n      } else {\n        domSelection.setBaseAndExtent(newDomRange.startContainer, newDomRange.startOffset, newDomRange.endContainer, newDomRange.endOffset);\n      }\n\n      var leafEl = newDomRange.startContainer.parentElement;\n      scrollIntoView(leafEl, {\n        scrollMode: 'if-needed',\n        boundary: el\n      });\n    } else {\n      domSelection.removeAllRanges();\n    }\n\n    setTimeout(() => {\n      // COMPAT: In Firefox, it's not enough to create a range, you also need\n      // to focus the contenteditable element too. (2016/11/16)\n      if (newDomRange && IS_FIREFOX) {\n        el.focus();\n      }\n\n      state.isUpdatingSelection = false;\n    });\n  }); // The autoFocus TextareaHTMLAttribute doesn't do anything on a div, so it\n  // needs to be manually focused.\n\n  useEffect(() => {\n    if (ref.current && autoFocus) {\n      ref.current.focus();\n    }\n  }, [autoFocus]); // Listen on the native `beforeinput` event to get real \"Level 2\" events. This\n  // is required because React's `beforeinput` is fake and never really attaches\n  // to the real event sadly. (2019/11/01)\n  // https://github.com/facebook/react/issues/11211\n\n  var onDOMBeforeInput = useCallback(event => {\n    if (!readOnly && hasEditableTarget(editor, event.target) && !isDOMEventHandled(event, propsOnDOMBeforeInput)) {\n      var {\n        selection\n      } = editor;\n      var {\n        inputType: type\n      } = event;\n      var data = event.dataTransfer || event.data || undefined; // These two types occur while a user is composing text and can't be\n      // cancelled. Let them through and wait for the composition to end.\n\n      if (type === 'insertCompositionText' || type === 'deleteCompositionText') {\n        return;\n      }\n\n      event.preventDefault(); // COMPAT: For the deleting forward/backward input types we don't want\n      // to change the selection because it is the range that will be deleted,\n      // and those commands determine that for themselves.\n\n      if (!type.startsWith('delete') || type.startsWith('deleteBy')) {\n        var [targetRange] = event.getTargetRanges();\n\n        if (targetRange) {\n          var range = ReactEditor.toSlateRange(editor, targetRange);\n\n          if (!selection || !Range.equals(selection, range)) {\n            Transforms.select(editor, range);\n          }\n        }\n      } // COMPAT: If the selection is expanded, even if the command seems like\n      // a delete forward/backward command it should delete the selection.\n\n\n      if (selection && Range.isExpanded(selection) && type.startsWith('delete')) {\n        Editor.deleteFragment(editor);\n        return;\n      }\n\n      switch (type) {\n        case 'deleteByComposition':\n        case 'deleteByCut':\n        case 'deleteByDrag':\n          {\n            Editor.deleteFragment(editor);\n            break;\n          }\n\n        case 'deleteContent':\n        case 'deleteContentForward':\n          {\n            Editor.deleteForward(editor);\n            break;\n          }\n\n        case 'deleteContentBackward':\n          {\n            Editor.deleteBackward(editor);\n            break;\n          }\n\n        case 'deleteEntireSoftLine':\n          {\n            Editor.deleteBackward(editor, {\n              unit: 'line'\n            });\n            Editor.deleteForward(editor, {\n              unit: 'line'\n            });\n            break;\n          }\n\n        case 'deleteHardLineBackward':\n          {\n            Editor.deleteBackward(editor, {\n              unit: 'block'\n            });\n            break;\n          }\n\n        case 'deleteSoftLineBackward':\n          {\n            Editor.deleteBackward(editor, {\n              unit: 'line'\n            });\n            break;\n          }\n\n        case 'deleteHardLineForward':\n          {\n            Editor.deleteForward(editor, {\n              unit: 'block'\n            });\n            break;\n          }\n\n        case 'deleteSoftLineForward':\n          {\n            Editor.deleteForward(editor, {\n              unit: 'line'\n            });\n            break;\n          }\n\n        case 'deleteWordBackward':\n          {\n            Editor.deleteBackward(editor, {\n              unit: 'word'\n            });\n            break;\n          }\n\n        case 'deleteWordForward':\n          {\n            Editor.deleteForward(editor, {\n              unit: 'word'\n            });\n            break;\n          }\n\n        case 'insertLineBreak':\n        case 'insertParagraph':\n          {\n            Editor.insertBreak(editor);\n            break;\n          }\n\n        case 'insertFromComposition':\n        case 'insertFromDrop':\n        case 'insertFromPaste':\n        case 'insertFromYank':\n        case 'insertReplacementText':\n        case 'insertText':\n          {\n            if (data instanceof DataTransfer) {\n              ReactEditor.insertData(editor, data);\n            } else if (typeof data === 'string') {\n              Editor.insertText(editor, data);\n            }\n\n            break;\n          }\n      }\n    }\n  }, [readOnly, propsOnDOMBeforeInput]); // Attach a native DOM event handler for `beforeinput` events, because React's\n  // built-in `onBeforeInput` is actually a leaky polyfill that doesn't expose\n  // real `beforeinput` events sadly... (2019/11/04)\n  // https://github.com/facebook/react/issues/11211\n\n  useIsomorphicLayoutEffect(() => {\n    if (ref.current && HAS_BEFORE_INPUT_SUPPORT) {\n      // @ts-ignore The `beforeinput` event isn't recognized.\n      ref.current.addEventListener('beforeinput', onDOMBeforeInput);\n    }\n\n    return () => {\n      if (ref.current && HAS_BEFORE_INPUT_SUPPORT) {\n        // @ts-ignore The `beforeinput` event isn't recognized.\n        ref.current.removeEventListener('beforeinput', onDOMBeforeInput);\n      }\n    };\n  }, [onDOMBeforeInput]); // Listen on the native `selectionchange` event to be able to update any time\n  // the selection changes. This is required because React's `onSelect` is leaky\n  // and non-standard so it doesn't fire until after a selection has been\n  // released. This causes issues in situations where another change happens\n  // while a selection is being dragged.\n\n  var onDOMSelectionChange = useCallback(throttle(() => {\n    if (!readOnly && !state.isComposing && !state.isUpdatingSelection) {\n      var {\n        activeElement\n      } = window.document;\n      var el = ReactEditor.toDOMNode(editor, editor);\n      var domSelection = window.getSelection();\n\n      if (activeElement === el) {\n        state.latestElement = activeElement;\n        IS_FOCUSED.set(editor, true);\n      } else {\n        IS_FOCUSED.delete(editor);\n      }\n\n      if (!domSelection) {\n        return Transforms.deselect(editor);\n      }\n\n      var {\n        anchorNode,\n        focusNode\n      } = domSelection;\n      var anchorNodeSelectable = hasEditableTarget(editor, anchorNode) || isTargetInsideVoid(editor, anchorNode);\n      var focusNodeSelectable = hasEditableTarget(editor, focusNode) || isTargetInsideVoid(editor, focusNode);\n\n      if (anchorNodeSelectable && focusNodeSelectable) {\n        var range = ReactEditor.toSlateRange(editor, domSelection);\n        Transforms.select(editor, range);\n      } else {\n        Transforms.deselect(editor);\n      }\n    }\n  }, 100), [readOnly]); // Attach a native DOM event handler for `selectionchange`, because React's\n  // built-in `onSelect` handler doesn't fire for all selection changes. It's a\n  // leaky polyfill that only fires on keypresses or clicks. Instead, we want to\n  // fire for any change to the selection inside the editor. (2019/11/04)\n  // https://github.com/facebook/react/issues/5785\n\n  useIsomorphicLayoutEffect(() => {\n    window.document.addEventListener('selectionchange', onDOMSelectionChange);\n    return () => {\n      window.document.removeEventListener('selectionchange', onDOMSelectionChange);\n    };\n  }, [onDOMSelectionChange]);\n  var decorations = decorate([editor, []]);\n\n  if (placeholder && editor.children.length === 1 && Array.from(Node$1.texts(editor)).length === 1 && Node$1.string(editor) === '') {\n    var start = Editor.start(editor, []);\n    decorations.push({\n      [PLACEHOLDER_SYMBOL]: true,\n      placeholder,\n      anchor: start,\n      focus: start\n    });\n  }\n\n  return React.createElement(ReadOnlyContext.Provider, {\n    value: readOnly\n  }, React.createElement(Component // COMPAT: The Grammarly Chrome extension works by changing the DOM\n  // out from under `contenteditable` elements, which leads to weird\n  // behaviors so we have to disable it like editor. (2017/04/24)\n  , Object.assign({\n    \"data-gramm\": false,\n    role: readOnly ? undefined : 'textbox'\n  }, attributes, {\n    // COMPAT: Certain browsers don't support the `beforeinput` event, so we'd\n    // have to use hacks to make these replacement-based features work.\n    spellCheck: !HAS_BEFORE_INPUT_SUPPORT ? undefined : attributes.spellCheck,\n    autoCorrect: !HAS_BEFORE_INPUT_SUPPORT ? undefined : attributes.autoCorrect,\n    autoCapitalize: !HAS_BEFORE_INPUT_SUPPORT ? undefined : attributes.autoCapitalize,\n    \"data-slate-editor\": true,\n    \"data-slate-node\": \"value\",\n    contentEditable: readOnly ? undefined : true,\n    suppressContentEditableWarning: true,\n    ref: ref,\n    style: _objectSpread({\n      // Prevent the default outline styles.\n      outline: 'none',\n      // Preserve adjacent whitespace and new lines.\n      whiteSpace: 'pre-wrap',\n      // Allow words to break if they are too long.\n      wordWrap: 'break-word'\n    }, style),\n    onBeforeInput: useCallback(event => {\n      // COMPAT: Certain browsers don't support the `beforeinput` event, so we\n      // fall back to React's leaky polyfill instead just for it. It\n      // only works for the `insertText` input type.\n      if (!HAS_BEFORE_INPUT_SUPPORT && !readOnly && !isEventHandled(event, attributes.onBeforeInput) && hasEditableTarget(editor, event.target)) {\n        event.preventDefault();\n        var text = event.data;\n        Editor.insertText(editor, text);\n      }\n    }, [readOnly]),\n    onBlur: useCallback(event => {\n      if (readOnly || state.isUpdatingSelection || !hasEditableTarget(editor, event.target) || isEventHandled(event, attributes.onBlur)) {\n        return;\n      } // COMPAT: If the current `activeElement` is still the previous\n      // one, this is due to the window being blurred when the tab\n      // itself becomes unfocused, so we want to abort early to allow to\n      // editor to stay focused when the tab becomes focused again.\n\n\n      if (state.latestElement === window.document.activeElement) {\n        return;\n      }\n\n      var {\n        relatedTarget\n      } = event;\n      var el = ReactEditor.toDOMNode(editor, editor); // COMPAT: The event should be ignored if the focus is returning\n      // to the editor from an embedded editable element (eg. an <input>\n      // element inside a void node).\n\n      if (relatedTarget === el) {\n        return;\n      } // COMPAT: The event should be ignored if the focus is moving from\n      // the editor to inside a void node's spacer element.\n\n\n      if (isDOMElement(relatedTarget) && relatedTarget.hasAttribute('data-slate-spacer')) {\n        return;\n      } // COMPAT: The event should be ignored if the focus is moving to a\n      // non- editable section of an element that isn't a void node (eg.\n      // a list item of the check list example).\n\n\n      if (relatedTarget != null && isDOMNode(relatedTarget) && ReactEditor.hasDOMNode(editor, relatedTarget)) {\n        var node = ReactEditor.toSlateNode(editor, relatedTarget);\n\n        if (Element$1.isElement(node) && !editor.isVoid(node)) {\n          return;\n        }\n      }\n\n      IS_FOCUSED.delete(editor);\n    }, [readOnly, attributes.onBlur]),\n    onClick: useCallback(event => {\n      if (!readOnly && hasTarget(editor, event.target) && !isEventHandled(event, attributes.onClick) && isDOMNode(event.target)) {\n        var node = ReactEditor.toSlateNode(editor, event.target);\n        var path = ReactEditor.findPath(editor, node);\n\n        var _start = Editor.start(editor, path);\n\n        var end = Editor.end(editor, path);\n        var startVoid = Editor.void(editor, {\n          at: _start\n        });\n        var endVoid = Editor.void(editor, {\n          at: end\n        });\n\n        if (startVoid && endVoid && Path.equals(startVoid[1], endVoid[1])) {\n          var range = Editor.range(editor, _start);\n          Transforms.select(editor, range);\n        }\n      }\n    }, [readOnly, attributes.onClick]),\n    onCompositionEnd: useCallback(event => {\n      if (hasEditableTarget(editor, event.target) && !isEventHandled(event, attributes.onCompositionEnd)) {\n        state.isComposing = false; // COMPAT: In Chrome, `beforeinput` events for compositions\n        // aren't correct and never fire the \"insertFromComposition\"\n        // type that we need. So instead, insert whenever a composition\n        // ends since it will already have been committed to the DOM.\n\n        if (!IS_SAFARI && !IS_FIREFOX && event.data) {\n          Editor.insertText(editor, event.data);\n        }\n      }\n    }, [attributes.onCompositionEnd]),\n    onCompositionStart: useCallback(event => {\n      if (hasEditableTarget(editor, event.target) && !isEventHandled(event, attributes.onCompositionStart)) {\n        state.isComposing = true;\n      }\n    }, [attributes.onCompositionStart]),\n    onCopy: useCallback(event => {\n      if (hasEditableTarget(editor, event.target) && !isEventHandled(event, attributes.onCopy)) {\n        event.preventDefault();\n        ReactEditor.setFragmentData(editor, event.clipboardData);\n      }\n    }, [attributes.onCopy]),\n    onCut: useCallback(event => {\n      if (!readOnly && hasEditableTarget(editor, event.target) && !isEventHandled(event, attributes.onCut)) {\n        event.preventDefault();\n        ReactEditor.setFragmentData(editor, event.clipboardData);\n        var {\n          selection\n        } = editor;\n\n        if (selection && Range.isExpanded(selection)) {\n          Editor.deleteFragment(editor);\n        }\n      }\n    }, [readOnly, attributes.onCut]),\n    onDragOver: useCallback(event => {\n      if (hasTarget(editor, event.target) && !isEventHandled(event, attributes.onDragOver)) {\n        // Only when the target is void, call `preventDefault` to signal\n        // that drops are allowed. Editable content is droppable by\n        // default, and calling `preventDefault` hides the cursor.\n        var node = ReactEditor.toSlateNode(editor, event.target);\n\n        if (Editor.isVoid(editor, node)) {\n          event.preventDefault();\n        }\n      }\n    }, [attributes.onDragOver]),\n    onDragStart: useCallback(event => {\n      if (hasTarget(editor, event.target) && !isEventHandled(event, attributes.onDragStart)) {\n        var node = ReactEditor.toSlateNode(editor, event.target);\n        var path = ReactEditor.findPath(editor, node);\n        var voidMatch = Editor.void(editor, {\n          at: path\n        }); // If starting a drag on a void node, make sure it is selected\n        // so that it shows up in the selection's fragment.\n\n        if (voidMatch) {\n          var range = Editor.range(editor, path);\n          Transforms.select(editor, range);\n        }\n\n        ReactEditor.setFragmentData(editor, event.dataTransfer);\n      }\n    }, [attributes.onDragStart]),\n    onDrop: useCallback(event => {\n      if (hasTarget(editor, event.target) && !readOnly && !isEventHandled(event, attributes.onDrop)) {\n        // COMPAT: Certain browsers don't fire `beforeinput` events at all, and\n        // Chromium browsers don't properly fire them for files being\n        // dropped into a `contenteditable`. (2019/11/26)\n        // https://bugs.chromium.org/p/chromium/issues/detail?id=1028668\n        if (!HAS_BEFORE_INPUT_SUPPORT || !IS_SAFARI && event.dataTransfer.files.length > 0) {\n          event.preventDefault();\n          var range = ReactEditor.findEventRange(editor, event);\n          var data = event.dataTransfer;\n          Transforms.select(editor, range);\n          ReactEditor.insertData(editor, data);\n        }\n      }\n    }, [readOnly, attributes.onDrop]),\n    onFocus: useCallback(event => {\n      if (!readOnly && !state.isUpdatingSelection && hasEditableTarget(editor, event.target) && !isEventHandled(event, attributes.onFocus)) {\n        var el = ReactEditor.toDOMNode(editor, editor);\n        state.latestElement = window.document.activeElement; // COMPAT: If the editor has nested editable elements, the focus\n        // can go to them. In Firefox, this must be prevented because it\n        // results in issues with keyboard navigation. (2017/03/30)\n\n        if (IS_FIREFOX && event.target !== el) {\n          el.focus();\n          return;\n        }\n\n        IS_FOCUSED.set(editor, true);\n      }\n    }, [readOnly, attributes.onFocus]),\n    onKeyDown: useCallback(event => {\n      if (!readOnly && hasEditableTarget(editor, event.target) && !isEventHandled(event, attributes.onKeyDown)) {\n        var {\n          nativeEvent\n        } = event;\n        var {\n          selection\n        } = editor; // COMPAT: Since we prevent the default behavior on\n        // `beforeinput` events, the browser doesn't think there's ever\n        // any history stack to undo or redo, so we have to manage these\n        // hotkeys ourselves. (2019/11/06)\n\n        if (Hotkeys.isRedo(nativeEvent)) {\n          event.preventDefault();\n\n          if (typeof editor.redo === 'function') {\n            editor.redo();\n          }\n\n          return;\n        }\n\n        if (Hotkeys.isUndo(nativeEvent)) {\n          event.preventDefault();\n\n          if (typeof editor.undo === 'function') {\n            editor.undo();\n          }\n\n          return;\n        } // COMPAT: Certain browsers don't handle the selection updates\n        // properly. In Chrome, the selection isn't properly extended.\n        // And in Firefox, the selection isn't properly collapsed.\n        // (2017/10/17)\n\n\n        if (Hotkeys.isMoveLineBackward(nativeEvent)) {\n          event.preventDefault();\n          Transforms.move(editor, {\n            unit: 'line',\n            reverse: true\n          });\n          return;\n        }\n\n        if (Hotkeys.isMoveLineForward(nativeEvent)) {\n          event.preventDefault();\n          Transforms.move(editor, {\n            unit: 'line'\n          });\n          return;\n        }\n\n        if (Hotkeys.isExtendLineBackward(nativeEvent)) {\n          event.preventDefault();\n          Transforms.move(editor, {\n            unit: 'line',\n            edge: 'focus',\n            reverse: true\n          });\n          return;\n        }\n\n        if (Hotkeys.isExtendLineForward(nativeEvent)) {\n          event.preventDefault();\n          Transforms.move(editor, {\n            unit: 'line',\n            edge: 'focus'\n          });\n          return;\n        } // COMPAT: If a void node is selected, or a zero-width text node\n        // adjacent to an inline is selected, we need to handle these\n        // hotkeys manually because browsers won't be able to skip over\n        // the void node with the zero-width space not being an empty\n        // string.\n\n\n        if (Hotkeys.isMoveBackward(nativeEvent)) {\n          event.preventDefault();\n\n          if (selection && Range.isCollapsed(selection)) {\n            Transforms.move(editor, {\n              reverse: true\n            });\n          } else {\n            Transforms.collapse(editor, {\n              edge: 'start'\n            });\n          }\n\n          return;\n        }\n\n        if (Hotkeys.isMoveForward(nativeEvent)) {\n          event.preventDefault();\n\n          if (selection && Range.isCollapsed(selection)) {\n            Transforms.move(editor);\n          } else {\n            Transforms.collapse(editor, {\n              edge: 'end'\n            });\n          }\n\n          return;\n        }\n\n        if (Hotkeys.isMoveWordBackward(nativeEvent)) {\n          event.preventDefault();\n          Transforms.move(editor, {\n            unit: 'word',\n            reverse: true\n          });\n          return;\n        }\n\n        if (Hotkeys.isMoveWordForward(nativeEvent)) {\n          event.preventDefault();\n          Transforms.move(editor, {\n            unit: 'word'\n          });\n          return;\n        } // COMPAT: Certain browsers don't support the `beforeinput` event, so we\n        // fall back to guessing at the input intention for hotkeys.\n        // COMPAT: In iOS, some of these hotkeys are handled in the\n\n\n        if (!HAS_BEFORE_INPUT_SUPPORT) {\n          // We don't have a core behavior for these, but they change the\n          // DOM if we don't prevent them, so we have to.\n          if (Hotkeys.isBold(nativeEvent) || Hotkeys.isItalic(nativeEvent) || Hotkeys.isTransposeCharacter(nativeEvent)) {\n            event.preventDefault();\n            return;\n          }\n\n          if (Hotkeys.isSplitBlock(nativeEvent)) {\n            event.preventDefault();\n            Editor.insertBreak(editor);\n            return;\n          }\n\n          if (Hotkeys.isDeleteBackward(nativeEvent)) {\n            event.preventDefault();\n\n            if (selection && Range.isExpanded(selection)) {\n              Editor.deleteFragment(editor);\n            } else {\n              Editor.deleteBackward(editor);\n            }\n\n            return;\n          }\n\n          if (Hotkeys.isDeleteForward(nativeEvent)) {\n            event.preventDefault();\n\n            if (selection && Range.isExpanded(selection)) {\n              Editor.deleteFragment(editor);\n            } else {\n              Editor.deleteForward(editor);\n            }\n\n            return;\n          }\n\n          if (Hotkeys.isDeleteLineBackward(nativeEvent)) {\n            event.preventDefault();\n\n            if (selection && Range.isExpanded(selection)) {\n              Editor.deleteFragment(editor);\n            } else {\n              Editor.deleteBackward(editor, {\n                unit: 'line'\n              });\n            }\n\n            return;\n          }\n\n          if (Hotkeys.isDeleteLineForward(nativeEvent)) {\n            event.preventDefault();\n\n            if (selection && Range.isExpanded(selection)) {\n              Editor.deleteFragment(editor);\n            } else {\n              Editor.deleteForward(editor, {\n                unit: 'line'\n              });\n            }\n\n            return;\n          }\n\n          if (Hotkeys.isDeleteWordBackward(nativeEvent)) {\n            event.preventDefault();\n\n            if (selection && Range.isExpanded(selection)) {\n              Editor.deleteFragment(editor);\n            } else {\n              Editor.deleteBackward(editor, {\n                unit: 'word'\n              });\n            }\n\n            return;\n          }\n\n          if (Hotkeys.isDeleteWordForward(nativeEvent)) {\n            event.preventDefault();\n\n            if (selection && Range.isExpanded(selection)) {\n              Editor.deleteFragment(editor);\n            } else {\n              Editor.deleteForward(editor, {\n                unit: 'word'\n              });\n            }\n\n            return;\n          }\n        }\n      }\n    }, [readOnly, attributes.onKeyDown]),\n    onPaste: useCallback(event => {\n      // COMPAT: Certain browsers don't support the `beforeinput` event, so we\n      // fall back to React's `onPaste` here instead.\n      // COMPAT: Firefox, Chrome and Safari are not emitting `beforeinput` events\n      // when \"paste without formatting\" option is used.\n      // This unfortunately needs to be handled with paste events instead.\n      if (hasEditableTarget(editor, event.target) && !isEventHandled(event, attributes.onPaste) && (!HAS_BEFORE_INPUT_SUPPORT || isPlainTextOnlyPaste(event.nativeEvent)) && !readOnly) {\n        event.preventDefault();\n        ReactEditor.insertData(editor, event.clipboardData);\n      }\n    }, [readOnly, attributes.onPaste])\n  }), React.createElement(Children, {\n    decorate: decorate,\n    decorations: decorations,\n    node: editor,\n    renderElement: renderElement,\n    renderLeaf: renderLeaf,\n    selection: editor.selection\n  })));\n};\n/**\r\n * A default memoized decorate function.\r\n */\n\nvar defaultDecorate = () => [];\n/**\r\n * Check if the target is in the editor.\r\n */\n\n\nvar hasTarget = (editor, target) => {\n  return isDOMNode(target) && ReactEditor.hasDOMNode(editor, target);\n};\n/**\r\n * Check if the target is editable and in the editor.\r\n */\n\n\nvar hasEditableTarget = (editor, target) => {\n  return isDOMNode(target) && ReactEditor.hasDOMNode(editor, target, {\n    editable: true\n  });\n};\n/**\r\n * Check if the target is inside void and in the editor.\r\n */\n\n\nvar isTargetInsideVoid = (editor, target) => {\n  var slateNode = hasTarget(editor, target) && ReactEditor.toSlateNode(editor, target);\n  return Editor.isVoid(editor, slateNode);\n};\n/**\r\n * Check if an event is overrided by a handler.\r\n */\n\n\nvar isEventHandled = (event, handler) => {\n  if (!handler) {\n    return false;\n  }\n\n  handler(event);\n  return event.isDefaultPrevented() || event.isPropagationStopped();\n};\n/**\r\n * Check if a DOM event is overrided by a handler.\r\n */\n\n\nvar isDOMEventHandled = (event, handler) => {\n  if (!handler) {\n    return false;\n  }\n\n  handler(event);\n  return event.defaultPrevented;\n};\n\nexport { DefaultElement, DefaultLeaf, Editable, ReactEditor, Slate, useEditor, useFocused, useReadOnly, useSelected, useSlate, withReact };\n//# sourceMappingURL=index.es.js.map\n","import { __values } from \"tslib\";\nimport * as React from \"react\";\nimport { useSubscription } from \"use-subscription\";\nvar mapValue = new WeakMap();\nvar EMPTY_VALUE = Symbol();\nvar JUST_RESOLVED = Promise.resolve();\nexport function useSuspendable() {\n    var e_1, _a;\n    var obs = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        obs[_i] = arguments[_i];\n    }\n    var shouldThrow = [];\n    var _loop_1 = function (ob) {\n        if (!ob) {\n            return \"continue\";\n        }\n        var item = mapValue.get(ob);\n        if (!item) {\n            var syncValue_1 = EMPTY_VALUE;\n            if (!(ob instanceof Promise)) {\n                ob.subscribe(function (v) {\n                    syncValue_1 = v;\n                }).unsubscribe();\n            }\n            if (syncValue_1 !== EMPTY_VALUE) {\n                item = {\n                    thenable: JUST_RESOLVED,\n                    isSync: true,\n                    value: syncValue_1,\n                };\n            }\n            else {\n                item = {\n                    thenable: (ob instanceof Promise\n                        ? ob\n                        : new Promise(function (resolve, reject) {\n                            ob.subscribe(resolve, reject);\n                        })).then(function (v) {\n                        item && (item.value = v);\n                    }),\n                    isSync: false,\n                    value: EMPTY_VALUE,\n                };\n            }\n            mapValue.set(ob, item);\n        }\n        if (item.value === EMPTY_VALUE) {\n            shouldThrow.push(item.thenable);\n        }\n    };\n    try {\n        for (var obs_1 = __values(obs), obs_1_1 = obs_1.next(); !obs_1_1.done; obs_1_1 = obs_1.next()) {\n            var ob = obs_1_1.value;\n            _loop_1(ob);\n        }\n    }\n    catch (e_1_1) { e_1 = { error: e_1_1 }; }\n    finally {\n        try {\n            if (obs_1_1 && !obs_1_1.done && (_a = obs_1.return)) _a.call(obs_1);\n        }\n        finally { if (e_1) throw e_1.error; }\n    }\n    if (shouldThrow.length > 0) {\n        throw Promise.all(shouldThrow);\n    }\n    return useSubscription(React.useMemo(function () { return ({\n        getCurrentValue: function () {\n            return obs.map(function (ob) { var _a; return (!ob ? undefined : (_a = mapValue.get(ob)) === null || _a === void 0 ? void 0 : _a.value); });\n        },\n        subscribe: function (callback) {\n            var subs = [];\n            obs.forEach(function (x, i) {\n                var _a;\n                if (x) {\n                    if (!(x instanceof Promise)) {\n                        if ((_a = mapValue.get(x)) === null || _a === void 0 ? void 0 : _a.isSync) {\n                            var isSyncTriggered_1 = true;\n                            subs.push(x.subscribe(function (v) {\n                                if (isSyncTriggered_1) {\n                                    isSyncTriggered_1 = false;\n                                }\n                                else {\n                                    mapValue.set(x, {\n                                        thenable: JUST_RESOLVED,\n                                        isSync: true,\n                                        value: v,\n                                    });\n                                    callback();\n                                }\n                            }));\n                        }\n                        else {\n                            subs.push(x.subscribe(function (v) {\n                                mapValue.set(x, {\n                                    thenable: JUST_RESOLVED,\n                                    isSync: false,\n                                    value: v,\n                                });\n                                callback();\n                            }));\n                        }\n                    }\n                }\n            });\n            return function () {\n                subs.forEach(function (x) { return x.unsubscribe(); });\n            };\n        },\n    }); }, obs));\n}\n//# sourceMappingURL=use-suspendable.js.map","import { Observable, Subject } from \"rxjs\"\nimport { Editor, Node, Operation } from \"slate\"\nimport { DocumentState } from \"./state\"\n\nexport interface IPeer {\n    id: string\n    sendTo(msg: CollaboEvent): void\n    receiveFrom: Observable<CollaboEvent>\n    dispose(): void\n}\n\nexport interface CollaboApi<P extends IPeer> {\n    docState: DocumentState<P>\n    isPrimary: boolean\n    initializeAsSecondary: Subject<Node[]>\n    initializeAsMaster(): void\n    addPeer(peer: P): void\n    removePeer(peerId: string): void\n    clear(): void\n}\n\nexport interface CollaboOptions {}\n\nenum MessageType {\n    Hello,\n    ReqMerge,\n    AckMerge,\n}\n\nexport type CollaboEvent =\n    | {\n          type: MessageType.Hello\n          version: number\n          nodes: Node[]\n      }\n    | {\n          type: MessageType.ReqMerge\n          ops: Operation[]\n          version: number\n      }\n    | {\n          type: MessageType.AckMerge\n          unmergedOps: Operation[]\n          newVersion: number\n      }\n\nenum PeerState {\n    unknown,\n    primary,\n    secondary,\n}\n\nexport default function withCollabo<P extends IPeer, E extends Editor>(editor: E): E & { collabo: CollaboApi<P> } {\n    const decoratedEditor = editor as E & { collabo: CollaboApi<P> }\n\n    const { apply } = editor\n\n    let peers = {} as Record<IPeer[\"id\"], P>\n\n    let currentState = PeerState.unknown\n\n    let docState = new DocumentState<P>(editor, apply)\n    let uncommitedOps: Operation[] = []\n\n    editor.apply = op => {\n        apply(op)\n        uncommitedOps.push(op)\n        pendingSent && clearTimeout(pendingSent)\n        pendingSent = (setTimeout(() => {\n            if (currentState === PeerState.secondary) {\n                for (const peerId in peers) {\n                    const peer = peers[peerId]\n                    peer.sendTo({\n                        type: MessageType.ReqMerge,\n                        version: docState.version,\n                        ops: uncommitedOps,\n                    })\n                }\n            } else if (currentState === PeerState.primary) {\n                docState.version += uncommitedOps.length\n                for (const peerId in peers) {\n                    const peer = peers[peerId]\n                    peer.sendTo({\n                        type: MessageType.AckMerge,\n                        newVersion: docState.version,\n                        unmergedOps: uncommitedOps,\n                    })\n                }\n            }\n            uncommitedOps = []\n            pendingSent = 0\n        }, 50) as unknown) as number\n    }\n\n    let pendingSent = 0\n\n    let initializeAsSecondary = new Subject<Node[]>()\n\n    decoratedEditor.collabo = {\n        docState,\n        get isPrimary() {\n            return currentState === PeerState.primary\n        },\n        initializeAsSecondary,\n        initializeAsMaster() {\n            console.log(\"is master\")\n            currentState = PeerState.primary\n        },\n        addPeer(peer) {\n            peers[peer.id] = peer\n            peer.receiveFrom.subscribe(function handleMessage(msg: CollaboEvent) {\n                if (currentState === PeerState.unknown) {\n                    switch (msg.type) {\n                        case MessageType.Hello: {\n                            currentState = PeerState.secondary\n                            docState.version = msg.version\n                            initializeAsSecondary.next(msg.nodes)\n                            break\n                        }\n                    }\n                } else if (currentState === PeerState.primary) {\n                    switch (msg.type) {\n                        case MessageType.Hello: {\n                            peer.sendTo({\n                                type: MessageType.Hello,\n                                version: docState.version,\n                                nodes: editor.children,\n                            })\n                            break\n                        }\n                        case MessageType.ReqMerge: {\n                            const mergeResult = docState.mergePatch(msg, peer)\n                            if (!mergeResult) {\n                                throw new Error(\"primary falls behind secondary\")\n                            }\n                            for (const peerId in peers) {\n                                const peer = peers[peerId]\n                                peer.sendTo({\n                                    type: MessageType.AckMerge,\n                                    newVersion: docState.version,\n                                    unmergedOps: uncommitedOps,\n                                })\n                            }\n                        }\n                    }\n                } else if (currentState === PeerState.secondary) {\n                    switch (msg.type) {\n                        case MessageType.AckMerge: {\n                            docState.ackMerge(msg.newVersion, msg.unmergedOps, peer)\n                        }\n                    }\n                }\n            })\n            if (currentState === PeerState.unknown) {\n                peer.sendTo({\n                    type: MessageType.Hello,\n                    version: docState.version,\n                    nodes: editor.children,\n                })\n            }\n        },\n        removePeer(id) {\n            const toBeDeleted = peers[id]\n            if (toBeDeleted) {\n                docState.removeCursor(toBeDeleted)\n                editor.onChange()\n            }\n            peers[id]?.dispose()\n            delete peers[id]\n        },\n        clear() {\n            for (const peer of Object.values(peers)) {\n                peer.dispose()\n            }\n            peers = {}\n            docState = new DocumentState(editor, apply)\n            currentState = PeerState.unknown\n            initializeAsSecondary = new Subject()\n        },\n    }\n\n    return decoratedEditor\n}\n","export enum ErrorCode {\n    NotInARoom = \"NotInARoom\",\n}\n\nexport enum ClientEventType {\n    hello = \"hello\",\n    join = \"join\",\n    quit = \"quit\",\n    listRooms = \"listRooms\",\n    signal = \"signal\",\n}\n\nexport type ClientEvent =\n    | {\n          type: ClientEventType.hello\n          from: UserInfo | null\n      }\n    | {\n          type: ClientEventType.join\n          roomName: string\n      }\n    | { type: ClientEventType.listRooms }\n    | { type: ClientEventType.quit }\n    | { type: ClientEventType.signal; to: UserInfo; signalType: \"offer\" | \"answer\"; signal: string }\n\nexport enum ServerEventType {\n    hello = \"hello\",\n    join = \"join\",\n    quit = \"quit\",\n    error = \"error\",\n    signal = \"signal\",\n    listRooms = \"listRooms\",\n}\n\nexport type UserInfo = {\n    id: string\n    username: string\n    color: string\n}\n\nexport type RoomInfo = {\n    name: string\n    users: UserInfo[]\n}\n\nexport type ServerEvent =\n    | { type: ServerEventType.listRooms; rooms: RoomInfo[] }\n    | { type: ServerEventType.error; errorCode: ErrorCode }\n    | { type: ServerEventType.hello; user: UserInfo; rooms: RoomInfo[] }\n    | { type: ServerEventType.join; room: RoomInfo; userInfo: UserInfo }\n    | { type: ServerEventType.quit; roomName: string; userInfo: UserInfo }\n    | { type: ServerEventType.signal; from: UserInfo; signalType: \"offer\" | \"answer\"; signal: string }\n","import { asapScheduler, BehaviorSubject } from \"rxjs\"\nimport { observeOn } from \"rxjs/operators\"\nimport { Editor, Operation, Path, Point, Range, RangeRef, SelectionOperation } from \"slate\"\nimport { IPeer } from \"./collabo\"\n\ntype Patch = {\n    version: number\n    ops: Operation[]\n}\n\nexport class DocumentState<P extends IPeer> {\n    constructor(private editor: Editor, private apply: Editor[\"apply\"]) {}\n    version = 0\n    private _cursors = new BehaviorSubject(new Map<P, RangeRef>())\n    cursors = this._cursors.pipe(observeOn(asapScheduler))\n    removeCursor(peer: P) {\n        this._cursors.value.delete(peer)\n        this._cursors.next(this._cursors.value)\n    }\n    mergePatch(patch: Patch, from: P) {\n        if (patch.version <= this.version) {\n            let left = this.editor.operations.slice(patch.version)\n            let top = patch.ops as (Operation | null)[]\n            let right: (Operation | null)[] = []\n            let bottom: (Operation | null)[] = []\n            if (!left.length || !top.length) {\n                bottom = top\n                right = left\n            } else {\n                for (let i = 0; i < left.length; i++) {\n                    let leftOp = left[i] as Operation | null\n                    for (let j = 0; j < top.length; j++) {\n                        let topOp = top[j]\n                        const [rightOp, bottomOp] = transform(leftOp, topOp)\n                        leftOp = rightOp\n                        bottom.push(bottomOp)\n                    }\n                    right.push(leftOp)\n                    top = bottom\n                }\n            }\n            Editor.withoutNormalizing(this.editor, () => {\n                bottom.forEach(op => {\n                    if (op) {\n                        this.applyRemoteOp(op, from)\n                    }\n                    this.version++\n                })\n            })\n            this.editor.onChange()\n            return right\n        } else {\n            return false\n        }\n    }\n    private applyRemoteOp(op: Operation, from: P) {\n        if (op.type === \"set_selection\") {\n            if (op.newProperties) {\n                let rangeRef = this._cursors.value.get(from)\n                if (!rangeRef) {\n                    rangeRef = Editor.rangeRef(this.editor, op.newProperties as Range)\n                    this._cursors.value.set(from, rangeRef)\n                }\n                if (rangeRef.current) {\n                    rangeRef.current = {\n                        anchor: op.newProperties.anchor || rangeRef.current?.anchor,\n                        focus: op.newProperties.focus || rangeRef.current?.focus,\n                    }\n                }\n            } else {\n                this._cursors.value.get(from)?.unref()\n            }\n            this._cursors.next(this._cursors.value)\n        } else {\n            this.apply(op)\n        }\n    }\n    ackMerge(newVersion: number, ops: (Operation | null)[], from: P) {\n        Editor.withoutNormalizing(this.editor, () => {\n            ops.forEach(op => {\n                if (op) {\n                    this.applyRemoteOp(op, from)\n                }\n            })\n        })\n        this.version = newVersion\n        this.editor.onChange()\n    }\n}\n\nfunction transform(left: Operation | null, top: Operation | null): [Operation | null, Operation | null] {\n    if (!left || !top) {\n        return [left, top]\n    }\n    switch (left.type) {\n        case \"remove_text\":\n        case \"insert_text\": {\n            switch (top.type) {\n                case \"remove_text\":\n                case \"insert_text\": {\n                    if (Path.equals(top.path, left.path)) {\n                        if (top.offset > left.offset) {\n                            if (left.type === \"insert_text\") {\n                                top.offset += left.text.length\n                            } else {\n                                top.offset -= left.text.length\n                            }\n                        } else {\n                            if (top.type === \"insert_text\") {\n                                left.offset += top.text.length\n                            } else {\n                                left.offset -= top.text.length\n                            }\n                        }\n                    }\n                    break\n                }\n                case \"set_selection\": {\n                    transformSelection(top, left)\n                    break\n                }\n                default: {\n                    const rightPath = Path.transform(left.path, top)\n                    const bottomPath = Path.transform(top.path, left)\n                    if (!rightPath) {\n                        left = null\n                    }\n                    if (!bottomPath) {\n                        top = null\n                    }\n                }\n            }\n            break\n        }\n        case \"set_selection\": {\n            switch (top.type) {\n                case \"set_selection\": {\n                    break\n                }\n                default: {\n                    transformSelection(left, top)\n                }\n            }\n            break\n        }\n        case \"move_node\": {\n            switch (top.type) {\n                case \"set_selection\": {\n                    transformSelection(top, left)\n                    break\n                }\n                case \"move_node\": {\n                    const rightPath = Path.transform(left.path, top)\n                    const rightNewPath = Path.transform(left.newPath, top)\n                    const bottomPath = Path.transform(top.path, left)\n                    const bottomNewPath = Path.transform(top.newPath, left)\n                    if (!rightNewPath || !rightPath) {\n                        left = null\n                    } else {\n                        left.path = rightPath\n                        left.newPath = rightNewPath\n                    }\n                    if (!bottomNewPath || !bottomPath) {\n                        top = null\n                    } else {\n                        top.path = bottomPath\n                        top.newPath = bottomNewPath\n                    }\n                    break\n                }\n                default: {\n                    const rightPath = Path.transform(left.path, top)\n                    const rightNewPath = Path.transform(left.newPath, top)\n                    const bottomPath = Path.transform(top.path, left)\n                    if (!rightPath || !rightNewPath) {\n                        left = null\n                    } else {\n                        left.path = rightPath\n                        left.newPath = rightNewPath\n                    }\n                    if (!bottomPath) {\n                        top = null\n                    } else {\n                        top.path = bottomPath\n                    }\n                }\n            }\n            break\n        }\n        default: {\n            switch (top.type) {\n                case \"set_selection\": {\n                    transformSelection(top, left)\n                    break\n                }\n                default: {\n                    const rightPath = Path.transform(left.path, top)\n                    const bottomPath = Path.transform(top.path, left)\n                    if (!rightPath) {\n                        left = null\n                    } else {\n                        left.path = rightPath\n                    }\n                    if (!bottomPath) {\n                        top = null\n                    } else {\n                        top.path = bottomPath\n                    }\n                }\n            }\n            break\n        }\n    }\n    return [left, top]\n}\n\nfunction transformSelection(a: SelectionOperation, by: Operation) {\n    if (a.properties) {\n        a.properties.anchor = (a.properties.anchor && Point.transform(a.properties.anchor, by)) || undefined\n        a.properties.focus = (a.properties.focus && Point.transform(a.properties.focus, by)) || undefined\n    }\n    if (a.newProperties) {\n        a.newProperties.anchor = (a.newProperties.anchor && Point.transform(a.newProperties.anchor, by)) || undefined\n        a.newProperties.focus = (a.newProperties.focus && Point.transform(a.newProperties.focus, by)) || undefined\n    }\n}\n","import * as React from \"react\"\nimport { Range } from \"slate\"\nimport { UserInfo } from \"../protocol\"\n\nexport interface CursorRange extends Range {\n    userInfo: UserInfo\n    isCaret: boolean\n    isForward: boolean\n}\n\nconst cursorStyleBase = {\n    position: \"absolute\",\n    top: -2,\n    pointerEvents: \"none\",\n    userSelect: \"none\",\n    transform: \"translateY(-100%)\",\n    fontSize: 10,\n    background: \"palevioletred\",\n    whiteSpace: \"nowrap\",\n} as React.CSSProperties\n\nconst caretStyleBase = {\n    position: \"absolute\",\n    pointerEvents: \"none\",\n    userSelect: \"none\",\n    height: \"1.2em\",\n    width: 2,\n    background: \"palevioletred\",\n} as React.CSSProperties\n\nexport function Caret({ userInfo, isForward }: CursorRange) {\n    const cursorStyles = {\n        ...cursorStyleBase,\n        background: userInfo.color,\n        color: \"black\",\n        left: isForward ? \"100%\" : \"0%\",\n    } as React.CSSProperties\n    const caretStyles = {\n        ...caretStyleBase,\n        position: \"relative\",\n        background: userInfo.color,\n        left: isForward ? \"100%\" : \"0%\",\n    } as React.CSSProperties\n\n    caretStyles[isForward ? \"bottom\" : \"top\"] = 0\n\n    return (\n        <span\n            style={{\n                backgroundColor: userInfo.color,\n            }}\n        >\n            <span className=\"caret\" contentEditable={false} style={caretStyles}>\n                <span style={{ position: \"relative\" }}>\n                    <span contentEditable={false} style={cursorStyles}>\n                        {userInfo.username}\n                    </span>\n                    <span\n                        style={{\n                            borderLeft: \"1px solid currentColor\",\n                            borderTop: \"1px solid currentColor\",\n                            borderBottom: \"1px solid currentColor\",\n                            animation: \"cursor 1s steps(2, jump-both) infinite\",\n                        }}\n                    ></span>\n                </span>\n            </span>\n        </span>\n    )\n}\n","import * as React from \"react\"\nimport { Caret, CursorRange } from \"./cursor\"\n\nexport const Leaf = ({ attributes, children, leaf }) => {\n    if (leaf.bold) {\n        children = <strong>{children}</strong>\n    }\n\n    if (leaf.italic) {\n        children = <em>{children}</em>\n    }\n\n    if (leaf.underlined) {\n        children = <u>{children}</u>\n    }\n\n    return (\n        <span\n            {...attributes}\n            style={{\n                background: leaf.isCaret ? (leaf as CursorRange).userInfo.color : undefined,\n                ...attributes.style,\n            }}\n        >\n            {leaf.isCaret ? <Caret {...leaf} /> : null}\n            {children}\n        </span>\n    )\n}\n","import * as React from \"react\"\nimport { Editor, Range, Text, Transforms } from \"slate\"\nimport { ReactEditor, useSlate } from \"slate-react\"\n\nexport const toggleFormat = (editor: Editor, format: string) => {\n    const isActive = isFormatActive(editor, format)\n    Transforms.setNodes(editor, { [format]: isActive ? null : true }, { match: Text.isText, split: true })\n}\n\nconst isFormatActive = (editor, format) => {\n    const [match] = Array.from(\n        Editor.nodes(editor, {\n            match: n => n[format] === true,\n            mode: \"all\",\n        })\n    )\n    return !!match\n}\n\nexport const Toolbar = () => {\n    const ref = React.useRef<HTMLDivElement | null>()\n    const editor = useSlate()\n\n    React.useEffect(() => {\n        const el = ref.current\n        const { selection } = editor\n\n        if (!el) {\n            return\n        }\n\n        if (!selection || !ReactEditor.isFocused(editor) || Range.isCollapsed(selection) || Editor.string(editor, selection) === \"\") {\n            el.removeAttribute(\"style\")\n            return\n        }\n\n        const domSelection = window.getSelection()\n        const domRange = domSelection?.getRangeAt(0)\n        const rect = domRange?.getBoundingClientRect()\n        if (rect) {\n            el.style.opacity = \"1\"\n            el.style.top = `${rect.top + window.pageYOffset - el.offsetHeight}px`\n            el.style.left = `${rect.left + window.pageXOffset - el.offsetWidth / 2 + rect.width / 2}px`\n        }\n    })\n\n    return (\n        <div>\n            <FormatButton format=\"bold\" icon=\"format_bold\" />\n            <FormatButton format=\"italic\" icon=\"format_italic\" />\n            <FormatButton format=\"underlined\" icon=\"format_underlined\" />\n        </div>\n    )\n}\n\nconst Button = ({ active, children, ...rest }: { active: boolean } & React.HTMLAttributes<HTMLButtonElement>) => {\n    return (\n        <button\n            {...rest}\n            style={{\n                color: active ? \"blue\" : \"gray\",\n                ...rest.style,\n            }}\n        >\n            <span>{children}</span>\n        </button>\n    )\n}\n\nconst Icon = ({ children }) => {\n    return <div>{children}</div>\n}\n\nconst FormatButton = ({ format, icon }) => {\n    const editor = useSlate()\n    return (\n        <Button\n            active={isFormatActive(editor, format)}\n            onMouseDown={event => {\n                event.preventDefault()\n                toggleFormat(editor, format)\n            }}\n        >\n            <Icon>{icon}</Icon>\n        </Button>\n    )\n}\n","import { fromEventPattern, Observable, Subject, Subscription } from \"rxjs\"\nimport WebRTCDataChannel from \"webrtc-datachannel\"\nimport { UserInfo } from \"./protocol\"\n\nexport type PeerSignal = {\n    signal: string\n    signalType: \"offer\" | \"answer\"\n}\n\nclass TimeoutError {\n    message = \"timeout\"\n}\n\nexport class Peer<Event> {\n    subs = new Subscription()\n    get id() {\n        return this.userInfo.id\n    }\n    constructor(public userInfo: UserInfo, private receiveSignal: Observable<PeerSignal>, private sendSignal: Subject<PeerSignal>, shouldRequest: boolean) {\n        console.log(\"create peer: \", userInfo.id)\n        if (shouldRequest) {\n            console.log(\"send request to peer: \", userInfo.id)\n            this.rtcChannel.initiateConnect().then(offer => {\n                this.sendSignal.next({\n                    signalType: \"offer\",\n                    signal: offer,\n                })\n            })\n        }\n        this.subs.add(\n            this.receiveSignal.subscribe(({ signal, signalType }) => {\n                if (signalType === \"offer\") {\n                    console.log(\"receive offer from peer: \", this.userInfo.id)\n                    this.rtcChannel.initByRequest(signal).then(answer => {\n                        console.log(\"send answer from peer: \", this.userInfo.id)\n                        this.sendSignal.next({\n                            signalType: \"answer\",\n                            signal: answer,\n                        })\n                    })\n                } else if (signalType === \"answer\") {\n                    console.log(\"receive answer from peer: \", this.userInfo.id)\n                    this.rtcChannel.setAnswer(signal)\n                }\n            })\n        )\n    }\n    private rtcChannel = new WebRTCDataChannel({\n        connection: {\n            iceServers: [\n                { urls: \"stun:stun01.sipphone.com\" },\n                { urls: \"stun:stun.ekiga.net\" },\n                { urls: \"stun:stun.fwdnet.net\" },\n                { urls: \"stun:stun.ideasip.com\" },\n                { urls: \"stun:stun.iptel.org\" },\n                { urls: \"stun:stun.rixtelecom.se\" },\n                { urls: \"stun:stun.schlund.de\" },\n                { urls: \"stun:stun.l.google.com:19302\" },\n                { urls: \"stun:stun1.l.google.com:19302\" },\n                { urls: \"stun:stun2.l.google.com:19302\" },\n                { urls: \"stun:stun3.l.google.com:19302\" },\n                { urls: \"stun:stun4.l.google.com:19302\" },\n                { urls: \"stun:stunserver.org\" },\n                { urls: \"stun:stun.softjoys.com\" },\n                { urls: \"stun:stun.voiparound.com\" },\n                { urls: \"stun:stun.voipbuster.com\" },\n                { urls: \"stun:stun.voipstunt.com\" },\n                { urls: \"stun:stun.voxgratia.org\" },\n                { urls: \"stun:stun.xten.com\" },\n                {\n                    urls: \"turn:numb.viagenie.ca\",\n                    credential: \"muazkh\",\n                    username: \"webrtc@live.com\",\n                },\n                {\n                    urls: \"turn:192.158.29.39:3478?transport=udp\",\n                    credential: \"JZEOEt2V3Qb0y27GRntt2u2PAYA=\",\n                    username: \"28224511:1379330808\",\n                },\n                {\n                    urls: \"turn:192.158.29.39:3478?transport=tcp\",\n                    credential: \"JZEOEt2V3Qb0y27GRntt2u2PAYA=\",\n                    username: \"28224511:1379330808\",\n                },\n            ],\n        },\n    })\n    ready = this.rtcChannel.channelOpened().then(() => {\n        console.log(\"peer opened:\", this.id)\n    })\n    receiveFrom = fromEventPattern<Event>(cb => {\n        return this.rtcChannel.on(\"message\", cb)\n    })\n    sendTo(msg: Event) {\n        this.ready.then(() => {\n            setTimeout(() => {\n                this.rtcChannel.send(msg)\n            }, 0)\n        })\n    }\n    dispose() {\n        //@ts-ignore\n        this.rtcChannel.dataChannel?.close()\n        //@ts-ignore\n        this.rtcChannel.rpc.close()\n        this.subs.unsubscribe()\n    }\n}\n","import * as React from \"react\"\nimport { Subject } from \"rxjs\"\nimport { createEditor, Editor, Node, NodeEntry, Path, Range, RangeRef, Text } from \"slate\"\nimport { withHistory } from \"slate-history\"\nimport { Editable, ReactEditor, Slate, withReact } from \"slate-react\"\nimport { useSuspendable } from \"use-suspendable\"\nimport withCollabo, { CollaboApi, CollaboEvent } from \"./collabo\"\nimport { createClientConnection } from \"./connection\"\nimport { CursorRange } from \"./editor/cursor\"\nimport { Leaf } from \"./editor/leaf\"\nimport { toggleFormat, Toolbar } from \"./editor/toolbar\"\nimport { Peer, PeerSignal } from \"./peer\"\nimport { ClientEventType, RoomInfo, UserInfo } from \"./protocol\"\n\ntype Props = {}\n\n// \"ws://158.247.213.142:9083/signal-server\"\nconst connection = createClientConnection(\"ws://158.247.213.142:9083/signal-server\")\n\n// const connection = createClientConnection(\"ws://localhost:9083/signal-server\")\n\nexport default function App() {\n    return (\n        <React.Suspense fallback=\"...\">\n            <HomePage />\n        </React.Suspense>\n    )\n}\n\nfunction HomePage() {\n    const [myUserInfo] = useSuspendable(connection.thisIsMe)\n\n    if (!myUserInfo) {\n        return <span>...</span>\n    }\n    return (\n        <div\n            style={{\n                width: \"100vw\",\n                height: \"100vh\",\n                background: \"#fff\",\n                display: \"grid\",\n                gridTemplateColumns: \"250px 1fr\",\n            }}\n        >\n            <div>\n                <div>:</div>\n                <div>\n                    <UserAvatar userInfo={myUserInfo} />\n                    {myUserInfo.username}\n                </div>\n            </div>\n            <div>\n                <Main userInfo={myUserInfo} />\n            </div>\n        </div>\n    )\n}\n\nconst editor = withHistory(withReact(withCollabo<Peer<CollaboEvent>, Editor>(createEditor())))\nconnection.events.addPeer.subscribe(({ userInfo, shouldRequest }) => {\n    const sendSignal = new Subject<PeerSignal>()\n    editor.collabo.addPeer(new Peer(userInfo, connection.signal, sendSignal, shouldRequest))\n    sendSignal.subscribe(signal => {\n        connection.send({\n            type: ClientEventType.signal,\n            to: userInfo,\n            ...signal,\n        })\n    })\n})\nconnection.events.removePeer.subscribe(({ userInfo }) => {\n    editor.collabo.removePeer(userInfo.id)\n})\nconnection.events.clearPeers.subscribe(() => {\n    editor.collabo.clear()\n})\n\nfunction Main({ userInfo }: { userInfo: UserInfo }) {\n    const [currentRoom] = useSuspendable(connection.currentRoom)\n\n    React.useEffect(() => {\n        if (currentRoom?.users?.[0].id === userInfo.id) {\n            editor.collabo.initializeAsMaster()\n        }\n    }, [currentRoom?.users?.[0].id])\n\n    if (!currentRoom || !editor) {\n        return <RoomList />\n    } else {\n        return <Room roomInfo={currentRoom} editor={editor} userInfo={userInfo} />\n    }\n}\n\nfunction RoomList() {\n    const [rooms] = useSuspendable(connection.rooms)\n\n    if (!rooms) {\n        return <span>...</span>\n    }\n\n    return (\n        <>\n            <button\n                style={{\n                    background: \"#909\",\n                    color: \"#fff\",\n                    borderRadius: 6,\n                    border: \"3px solid #999\",\n                    padding: \"5px 10px\",\n                    fontSize: 20,\n                }}\n                onClick={() => {\n                    const roomName = prompt(\"?\")\n                    roomName &&\n                        connection.send({\n                            type: ClientEventType.join,\n                            roomName,\n                        })\n                }}\n            >\n                /\n            </button>\n            <div\n                style={{\n                    display: \"flex\",\n                    justifyContent: \"center\",\n                    alignItems: \"center\",\n                    minHeight: \"50vh\",\n                }}\n            >\n                {rooms.map(x => {\n                    return (\n                        <div\n                            key={x.name}\n                            style={{\n                                background: \"#909\",\n                                color: \"#fff\",\n                                borderRadius: 6,\n                                border: \"3px solid #999\",\n                                padding: \"5px 10px\",\n                                fontSize: 20,\n                                minHeight: 200,\n                                minWidth: 400,\n                                cursor: \"pointer\",\n                            }}\n                            onClick={() => {\n                                connection.send({\n                                    type: ClientEventType.join,\n                                    roomName: x.name,\n                                })\n                            }}\n                        >\n                            <h2>{x.name}</h2>\n                            <div>\n                                {x.users.map(x => {\n                                    return <UserAvatar userInfo={x} key={x.id} />\n                                })}\n                            </div>\n                        </div>\n                    )\n                })}\n            </div>\n        </>\n    )\n}\n\nfunction Room({\n    userInfo,\n    editor,\n    roomInfo,\n}: {\n    userInfo: UserInfo\n    editor: Editor &\n        ReactEditor & {\n            collabo: CollaboApi<Peer<CollaboEvent>>\n        }\n    roomInfo: RoomInfo\n}) {\n    const [value, setValue] = React.useState<Node[]>(() => {\n        return [\n            {\n                type: \"paragraph\",\n                children: [{ text: \"A line of text in a paragraph.\" }],\n            },\n        ]\n    })\n\n    React.useEffect(() => {\n        if (!editor.collabo.isPrimary) {\n            const sub = editor.collabo.initializeAsSecondary.subscribe(nodes => {\n                setValue(nodes)\n            })\n            return () => sub.unsubscribe()\n        }\n    }, [editor])\n\n    const [cursors, setCursors] = React.useState([] as [UserInfo, RangeRef][])\n\n    const decorate = React.useCallback(\n        ([node, path]: NodeEntry) => {\n            const ranges: CursorRange[] = []\n\n            if (Text.isText(node)) {\n                for (const [remoteUserInfo, cursor] of cursors) {\n                    const cursorRange = cursor.current\n                    if (cursorRange && Range.includes(cursorRange, path)) {\n                        const { focus, anchor } = cursorRange\n\n                        const isFocusNode = Path.equals(focus.path, path)\n                        const isAnchorNode = Path.equals(anchor.path, path)\n                        const isForward = Range.isForward(cursorRange)\n                        ranges.push({\n                            ...cursor,\n                            userInfo: remoteUserInfo,\n                            isForward,\n                            isCaret: true,\n                            anchor: {\n                                path,\n                                offset: isAnchorNode ? anchor.offset : isForward ? 0 : node.text.length,\n                            },\n                            focus: {\n                                path,\n                                offset: isFocusNode ? focus.offset : isForward ? node.text.length : 0,\n                            },\n                        })\n                    }\n                }\n            }\n\n            return ranges\n        },\n        [cursors]\n    )\n\n    React.useEffect(() => {\n        const sub = editor.collabo.docState.cursors.subscribe(v => {\n            setCursors(Array.from(v.entries()).map(x => [x[0].userInfo, x[1]]))\n        })\n        return () => {\n            sub.unsubscribe()\n        }\n    }, [editor])\n\n    const renderLeaf = React.useCallback((props: any) => <Leaf {...props} />, [decorate])\n\n    return (\n        <>\n            <div>\n                {roomInfo.users.map(x => {\n                    return (\n                        <UserAvatar\n                            key={x.id}\n                            userInfo={x}\n                            style={{\n                                marginRight: 16,\n                            }}\n                        />\n                    )\n                })}\n            </div>\n            <Slate\n                editor={editor}\n                value={value}\n                onChange={newValue => {\n                    setValue(newValue)\n                }}\n                onDOMBeforeInput={(event: InputEvent) => {\n                    event.preventDefault()\n                    switch (event.inputType) {\n                        case \"formatBold\":\n                            return toggleFormat(editor, \"bold\")\n                        case \"formatItalic\":\n                            return toggleFormat(editor, \"italic\")\n                        case \"formatUnderline\":\n                            return toggleFormat(editor, \"underline\")\n                    }\n                }}\n            >\n                <Toolbar />\n                <Editable decorate={decorate} renderLeaf={renderLeaf} style={{ width: 300, height: 200, border: \"1px solid black\" }} />\n            </Slate>\n        </>\n    )\n}\n\nfunction UserAvatar({ userInfo, style }: { userInfo: UserInfo; style?: React.CSSProperties }) {\n    return (\n        <span\n            style={{\n                height: 20,\n                width: 20,\n                lineHeight: \"18px\",\n                background: \"#333\",\n                textAlign: \"center\",\n                borderRadius: \"50%\",\n                border: \"1px solid \" + userInfo.color,\n                color: userInfo.color,\n                display: \"inline-block\",\n                ...style,\n            }}\n        >\n            {userInfo.username.slice(0, 1)}\n        </span>\n    )\n}\n","import { BehaviorSubject, ReplaySubject, Subject } from \"rxjs\"\nimport { ClientEvent, ClientEventType, RoomInfo, ServerEvent, ServerEventType, UserInfo } from \"./protocol\"\n\nexport function createClientConnection(signalServerUrl: string) {\n    const savedUserStr = localStorage.getItem(\"userinfo\")\n\n    const thisIsMe = new BehaviorSubject(savedUserStr ? (JSON.parse(savedUserStr) as UserInfo) : null)\n\n    const ws = new WebSocket(signalServerUrl)\n\n    const send = (ev: ClientEvent) => {\n        ws.send(JSON.stringify(ev))\n    }\n\n    ws.onopen = e => {\n        send({\n            type: ClientEventType.hello,\n            from: thisIsMe.value,\n        })\n    }\n\n    const rooms = new BehaviorSubject<RoomInfo[]>([])\n    const currentRoom = new BehaviorSubject<RoomInfo | null>(null)\n    //@ts-ignore\n    currentRoom.name = \"currentRoom\"\n\n    const signal = new Subject<{\n        from: UserInfo\n        signal: string\n        signalType: \"offer\" | \"answer\"\n    }>()\n\n    const addPeer = new Subject<{\n        userInfo: UserInfo\n        shouldRequest: boolean\n    }>()\n    const removePeer = new Subject<{\n        userInfo: UserInfo\n    }>()\n\n    const clearPeers = new Subject()\n\n    ws.addEventListener(\"message\", e => {\n        const data = JSON.parse(e.data) as ServerEvent\n        console.log(\"connection event \", data.type)\n        const thisIsMeValue = thisIsMe.value\n        if (data.type === ServerEventType.hello) {\n            rooms.next(data.rooms)\n            thisIsMe.next(data.user)\n            console.log(`%c Server says: hello, [${data.user.id}] ${data.user.username}!`, `color: ${data.user.color}`)\n            localStorage.setItem(\"userinfo\", JSON.stringify(data.user))\n            return\n        } else if (thisIsMeValue) {\n            switch (data.type) {\n                case ServerEventType.listRooms: {\n                    rooms.next(data.rooms)\n                    break\n                }\n                case ServerEventType.join: {\n                    const joinedRoom = data.room\n                    const roomIndex = rooms.value.findIndex(x => x.name === joinedRoom.name)\n                    if (roomIndex === -1) {\n                        rooms.next([...rooms.value, joinedRoom])\n                    } else {\n                        rooms.value[roomIndex] = joinedRoom\n                        rooms.next(rooms.value.slice())\n                    }\n                    if (data.userInfo.id === thisIsMeValue.id) {\n                        currentRoom.next(data.room)\n                        setTimeout(() => {\n                            data.room.users.forEach(user => {\n                                if (user.id !== thisIsMeValue.id) {\n                                    addPeer.next({\n                                        userInfo: user,\n                                        shouldRequest: true,\n                                    })\n                                }\n                            })\n                        }, 100)\n                    } else {\n                        if (currentRoom.value?.name === data.room.name) {\n                            currentRoom.next(data.room)\n                        }\n                        if (joinedRoom.name === currentRoom.value?.name) {\n                            addPeer.next({\n                                userInfo: data.userInfo,\n                                shouldRequest: false,\n                            })\n                        }\n                    }\n                    break\n                }\n                case ServerEventType.quit: {\n                    if (data.userInfo.id === thisIsMeValue.id) {\n                        clearPeers.next(data)\n                        currentRoom.next(null)\n                        send({\n                            type: ClientEventType.listRooms,\n                        })\n                    } else {\n                        removePeer.next(data)\n                        currentRoom.next(\n                            currentRoom.value === null\n                                ? null\n                                : {\n                                      ...currentRoom.value,\n                                      users: currentRoom.value.users.filter(x => x.id !== data.userInfo.id),\n                                  }\n                        )\n                    }\n                    break\n                }\n                case ServerEventType.signal: {\n                    signal.next({\n                        from: data.from,\n                        signal: data.signal,\n                        signalType: data.signalType,\n                    })\n                    break\n                }\n                case ServerEventType.error: {\n                    console.error(\"App Error: \", data.errorCode)\n                    break\n                }\n            }\n        }\n    })\n\n    return {\n        rooms,\n        currentRoom,\n        events: {\n            addPeer,\n            removePeer,\n            clearPeers,\n        },\n        thisIsMe,\n        signal,\n        send,\n    }\n}\n","import App from \"./editor\"\nimport React, { useState } from \"react\"\n\nexport default function SlatejsCollabo() {\n\n    const [open, setOpen] = useState(false)\n\n    return <div>\n            {open && <App /> || <>\n            <div>demo, >>>, , .</div>\n            <button onClick={()=>{\n                setOpen(true)\n            }}></button>\n        </>}\n    </div>\n}\n"],"sourceRoot":""}